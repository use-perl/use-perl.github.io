<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org story by KM: Pseudo-hashes:  Threat or Menace?</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Pseudo-hashes:  Threat or Menace?</h1>
<h2><a href="/user/KM/">KM</a> on 2001-07-16T12:06:46</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><A HREF="mailto:schwern@pobox.com">Schwern</A> writes <EM>"Whichever they are, they're gone.  As of 5.7.2, the current pseudo-hash implementation has been deprecated.  The experiment will finally be expunged in 5.10.0 to be replaced with something better.<br/><br/><P>If you don't know what a pseudo-hash is, you're not alone.  This little bastard of a data type was an attempt to merge the speed and compactness of arrays with the convenience of hashes and the fixed keysets of C-style structs.  This was in May, 1997.  Four years later and the bugs haven't been ironed out.  The fundemental problems were presented in the<A HREF="http://dev.perl.org/rfc/241.pod">Perl 6 RFC #241 "Pseudo-hashes must die!"</A> advocating the elimination of this type from Perl 6 in favor of any number of better proposals for fixed-key hashes."</EM></p>
<p><EM><P>But this wasn't soon enough to get rid of the buggers.  The question was asked of perl5-porters, <A HREF="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-05/msg01184.html">"Must pseudo-hashes die?"</A> proposing that the experiment be terminated in Perl 5 as well.  The final nail in the coffin was the discovery that <A HREF="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-05/msg01236.html">Pseudo-hashes drag on performance</A>.  The extra code to support pseudo-hashes slowed down all arrays and hashes by 10 to 15%.  Much more important features have been killed for much less (safe signals were shelved for as little as 5% reduction in speed).
<P>So pseudo-hashes are officially deprecated in 5.7.2 (and thus 5.8.0) and the current implementation will be purged completely from 5.10.0.  Somethings will not be changing.  The fields.pm module interface will remain, so if you have code which creates pseudo-hashes, switch over to fields.pm.  Its not known yet what will replace pseudo-hashes, possibly something involving the new variable attributes, but there will be some way to have high-performance, fixed key hashes in 5.10.0.  In the meantime, Tie::SecureHash is probably your best bet.</EM></p>


<hr/>



<h2>Build option?</h2>
<h3><a href="/user/pudge/">pudge</a> on 2001-07-16T12:31:02</h3>
Maybe there could be a way to disable pseudohashes in perl right now, and check <tt>$Config{has_pseudohashes}</tt> to see if they are available?<nobr> <wbr></nobr>:)



<h2>Can they be disabled now?</h2>
<h3><a href="/user/clintp/">clintp</a> on 2001-07-17T12:23:13</h3>
Can we get that performance increase right now, instead of having to wait for 5.8.x to peter itself out?  Is there a configure option to get rid of it now?
<br>
<br>I don't really care (for myself) about the backward compatability problems that might arise from doing this!



<h2>Re:Can they be disabled now?</h2>
<h3><a href="/user/schwern/">schwern</a> on 2001-07-17T18:43:42</h3>
That's my plan (I have no idea if Jarko would go for it) but it can't be done in time for 5.8.0.<br/><br/><br/><br/>Meantime, you can play around with the <a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-05/msg01237.html" title="mpe.mpg.de">patch</a mpe.mpg.de> I did to tear pseudo-hashes out and benchmark.  WARNING!  I used a heavy, rusty, dull hacksaw to rip them out, this is not a pleasant patch.





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

