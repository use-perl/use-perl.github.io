<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org story by grinder: This Fortnight on perl5-porters - 13-27 April 2008</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>This Fortnight on perl5-porters - 13-27 April 2008</h1>
<h2><a href="/user/grinder/">grinder</a> on 2008-05-03T10:31:00</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><h1> <a name="this_fortnight_on_perl5_porters___13_27_april_2008">This Fortnight on perl5-porters - 13-27 April 2008</a> </h1>
<p>&quot;Perl simply isn't broken enough. Most things work too well, hence
no-one finds that they need to fix their itch, so in turn, they
don't get sucked into core development generally.  Maybe we need
to start adding bugs, somewhat like a protection racket.&quot;</p> <p><blockquote><div>&quot;Your program works very nicely. It would be a shame if something
went wrong with it, wouldn't it? ...&quot;</div></blockquote>
<p>-- Nicholas Clark, on possible future revenue schemes.</p></p>
<p><h1> <a name="topics_of_interest">Topics of Interest</a> </h1>
<p>
<h2> <a name="perl___33536">Perl @ 33536</a> </h2>
<p>Nicholas Clark followed up on the 5.8.9-tobe thread, regarding
binary compatibility, pointing
out that the entire 5.8 line had never needed to rearrange struct
layouts, so clearly it's not much of a limitation.</p>
<p>He thought that forcing a layout reshuffle between each minor release
sounded like quite a bit of work; Jan Dubois noted that all one
needed to do was to roll the first member around to the end, which
is easy, and has the added bonus of guaranteeing that the offset
of every single member changes.</p>
<pre>
  challenge their assumptions
  <a href="http://xrl.us/bj2sx">http://xrl.us/bj2sx</a> </pre>

<p>
<h2> <a name="banishing_free_to_wrong_pool__and_making_win32_faster">Banishing &quot;free to wrong pool&quot;, and making Win32 faster?</a> </h2>
<p>Nicholas then related the details of a discussion he had with Dave
Mitchell concerning the viability of a copy-on-write scheme. The
main stumbling block is the need for threaded perls to track which
interpreter allocated a given block of memory, since only the true
owner should free it.</p>
<p>This would mean that every single SV needs an extra pointer
to link back to the parent interpreter, on top of the
extra counter needed to keep track of the current copy
count.</p>
<p>So Nicholas went exploring to find out if there was another way
to determine to
which parent a block belonged. After studying things for
a while he came to the conclusion that between <em>util.c</em>
and <em>malloc.c</em>, the necessary infrastructure already
exists to acquire large blocks of memory from the system
and then allocate it on an as-needed basis as program
executes.</p>

<p>And then he was struck by the fact that this could be useful
right now, without waiting for a copy-on-write scheme to
be written, since the above could be used to both speed up
Win32's slow <code>malloc</code> performance and speed up (or at
least simplify) thread destruction.</p>
<p>Another brilliant piece of detective work by Nicholas that,
alas, attracted no comments.</p>
<pre>
  <a href="http://xrl.us/bj2sz">http://xrl.us/bj2sz</a> </pre>
<p>
<h2> <a name="taint__pl_tainting__svtainted_on__svtainted_off__svtaint_">Taint (PL_tainting, SvTAINTED_on, SvTAINTED_off, SvTAINT)</a> </h2>
<p>Nicholas also took the time to examine Paul Fenwick's reasons
for dismay with the way tainting can be turned on part way
through a program and offered a number of answers to Paul's
questions.</p>

<p>By using Sam Vilain's git repository back to the dawn of time,
he was able to show that the current behaviour was introduced
during 5.000 alpha 4.</p>
<pre>
  <a href="http://xrl.us/bj2s3">http://xrl.us/bj2s3</a> </pre>
<p>
<h2> <a name="sustaining_perl_5_maintenance">Sustaining Perl 5 maintenance</a> </h2>
<p>Nicholas also related a conversation from Real Life (see, the man
does have a Life) where Leon Brocard asked whether there were enough
people working on Perl 5, and Nicholas's flat answer was... no.</p>
<p>The inescapable fact is that working on a codebase that is over
twenty years old is not fun, it's work. Even taking care of patches
people send in and shepherding them to completion is work. A back
of the envelope calculation gives 8 person-work-days, per week, just
to stand still.</p>
<p>The grant scheme is not working. Expert Perl users know how to skate
around the weird parts of the language (or give them a wide berth).
Companies don't see the need to finance Perl development.</p>
<p>At the very least, a bug-wrangler who could keep track of bugs, tie
related bugs together, filter out not-a-bugs, write TODO tests,
write tests to improve coverage... well, it's a full-time job. And
not fun. At least not always. Hardly ever.</p>

<p>Dave Mitchell pointed out that a seemingly innocuous bug report
about a &quot;premature free&quot; error turns out, after a long
debugging session, to be another case of a design
decision embedded in the code base many years ago, at which
point there's very little to be done about it. This sort of
bug cannot be dealt with by a junior coder, lest they quickly
lose their mind, or at least become quickly discouraged.</p>
<p>Sven Dowideit gave thanks for the Git repository, which made
life much easier compared to the previous Perforce export via rsync
approach. In which case one of the goals for switching over to
git has already been met.</p>
<pre>
  life support
  <a href="http://xrl.us/bj2s5">http://xrl.us/bj2s5</a> </pre>
<p>
<h2> <a name="updated_perl_git__with_the_git_nits_picked">Updated Perl Git, with the Git Nits Picked</a> </h2>
<p>Sam Vilain, on the subject of the Perl Git, announced that he
had cleared up all the problems outstanding with the first
release of the repository and said that the current repository
would likely be the definitive one.</p>

<p>Rafael Garcia-Suarez announced that his company, booking.com,
had offered the bandwidth and hosting for the repository, and
it would live under the perl.org domain. He said that the move to
git will take place once 5.8.9 is out the door and so in the meantime
Sam will have to continue to import the Perforce changes.</p>
<pre>
  git.perl.org
  <a href="http://xrl.us/bj2s7">http://xrl.us/bj2s7</a> </pre>
<p>
<h2> <a name="www_osscensus_org">www.osscensus.org</a> </h2>
<p>Andy Armstrong mindlessly propagated a link to a web site that purports
to perform a census on the adoption of open-source software, and was
keen to find out how Perl fared.</p>
<p>Apparently one has to download a 44Mb Ruby application as part of the
process.</p>
<pre>
  that's the easy part
  <a href="http://xrl.us/bj2s9">http://xrl.us/bj2s9</a> </pre>

<p>
<h2> <a name="t_test_pl_taint_issue_with_vms"> <em>t/test.pl</em> taint issue with VMS</a> </h2>
<p>John E. Malmberg returned to the issue of <code>$ENV{PATH}</code> being tainted
on VMS and there being no way to untaint it in order to allow
<em>test.pl</em> to execute <code>runperl</code>. Part of the problem is that
<code>$ENV{PATH}</code> need not even exist on VMS, and things will work just
fine without it.</p>

<p>He recalled that the issue worked if PATH was defined beforehand
but couldn't track down the original discussion on the matter.</p>
<pre>
  finding your way
  <a href="http://xrl.us/bj2tb">http://xrl.us/bj2tb</a> </pre>
<p>
<h2> <a name="wrong_line_numbers_in_elsif__">Wrong line numbers in <code>elsif()</code> </a> </h2>
<p>This one's been around for a <em>looong</em> time and now, finally, it
may be time to retire advice #11943 from Klortho.</p>

<p>Nicholas Clark took another look at it and decided that it would
make a lovely opener for the Vienna Summer of TODOs project.
Then when he took a closer look, he thought of a trivial solution
that just might work after all.</p>
<p>He wrote up the new TODO, and within 12 hours, Rafael Garcia-Suarez
had written and applied a patch to implement Nicholas's idea.
Unfortunately it skewed another line numbering result. So he
committed a better change (#33710). Nicholas wondered whether
Rafael was going to fix each TODO he attempted to propose as
worthy of a bounty.</p>
<p>Bram wondered if this was related to bug #47632, and asked
whether the fix could be extended to resolve a variation on
the theme (of reporting incorrect line numbers).</p>
<p>Tim Bunce was very pleased, because an unexpected benefit that
came out of this was that all line-based execution profilers
picked up the improvement for free.</p>
<p>Paul Johnson saw that <a href="%23item_devel_cover"> <code>Devel::Cover</code> </a> was flummoxed by the
change, but he noted happily that the test suite was reporting
the error in an appropriate way which should simplify the fix.
He also saw that <code>B::Deparse</code> got a little confused as well
and offered a patch to fix that up.</p>
<pre>

  &quot;Ah yes, and you are the first person to have
  noticed this bug since 1987. Sure.&quot;
  <a href="http://xrl.us/bj2td">http://xrl.us/bj2td</a> </pre>
<p>The above work thus allowed Rafael Garcia-Suarez to announce that
the bug <code>if ... elsif</code> gives wrong line number for warning about
undefined value (#37302) was hereby fixed.</p>
<pre>
  so backport it
  <a href="http://xrl.us/bj2tf">http://xrl.us/bj2tf</a> </pre>
<p>
<h2> <a name="valgrind">valgrind</a> </h2>
<p>H.Merijn Brand took valgrind for a spin on his Text::CSV_XS module
to see what happened. In the process he discovered that
it works better if you have a perl built with <code>-DDEBUGGING</code>, but
a module written by Rafael (<code>Perl::Destruct::Level</code>) partially
obviates the need.</p>
<p>Marvin Humphrey explained what good valgrind figures should look
like and made some suggestions to reduce the numbers H.Merijn
was seeing. Vincent Pit asked whether his brand new <code>Test::Valgrind</code>
would be of any use, and this caught Marvin's attention.</p>
<pre>
  the daily grind
  <a href="http://xrl.us/bj2th">http://xrl.us/bj2th</a> </pre>

<p>
<h2> <a name="extutils__cbuilder_with_mingw_on_win32"> <code>ExtUtils::CBuilder</code> with MinGW on Win32</a> </h2>
<p>Steve Hay asked about the status of <code>ExtUtils::CBuilder</code> (or more
specifically, the differences between the CPAN version, the development
version in its Subversion repository and blead). When all was said and
done, version 0.23 made it out to CPAN and this contains the MinGW
fixes that will clean up Steve's smokes.</p>
<p>On the other hand, the blead version still contains some VMS-specific
fixes that need to be merged back into the development version of the
module to get everyone in synch.</p>
<pre>
  whither 0.24?
  <a href="http://xrl.us/bj2tj">http://xrl.us/bj2tj</a> </pre>

<p>
<h2> <a name="object____overloading_and_not">Object ~~ overloading and not</a> </h2>
<p>Ricardo Signes reminded the porters about the perils of</p>
<pre>
  $anything ~~ $obj_without_overload</pre>
<p>and wrote a test case to try and nail it down. But something went wrong
and he had a core dump on his hands. Rafael took over and cleaned everything
up so that we know have a nicely-behaved TODO test.</p>
<pre>
  <a href="http://xrl.us/bj2tm">http://xrl.us/bj2tm</a> </pre>
<p>In other news, he also wrote a testcase as a followup to the <code>Array ~~ Any</code>

discussion, but this appears to have been overlooked.</p>
<pre>
  <a href="http://xrl.us/bj2to">http://xrl.us/bj2to</a> </pre>
<p>
<h2> <a name="support_mallocs_of_struct_t_containing_struct_s_n_">Support mallocs of struct T containing struct S[N]</a> </h2>
<p>In his continuing explorations of slab allocations, Jim Cromie offered
a patch to allow structs with arbitrarily-sized arrays of structs to
be allocated easily.</p>
<p>This was a follow-up to his Warnocked patch at the beginning of the month
dealing with exposing the ptr-table subsystem, on the grounds that it
offered a speed boost to XS authors. It turned out that freeing ptr-tables
was very slow, and so switching to a slab allocator would simplify the
freeing, since one could just throw the slab away. But for that to work,
one needed to be able to calculate the overall required size needed for
variable length allocations.</p>
<p>Those who were sufficiently well versed in the finer details of the C
standard pointed out that not many current compiler implementations
had implemented this part of the standard, which appears to have
compromised the acceptance of the patch.</p>
<pre>

  unwarranted chumminess with the C implementation
  <a href="http://xrl.us/bj2tq">http://xrl.us/bj2tq</a> </pre>
<p>
<h2> <a name="why_is_ruby_on_rails_so_darn_slow">Why is Ruby on Rails so darn slow?</a> </h2>
<p>A long digression about the relative merits of speed and usefulness
of Perl, Ruby and Java, inspired by a web article written by Tim Bray.</p>
<pre>
  not much porting going on
  <a href="http://xrl.us/bj2ts">http://xrl.us/bj2ts</a> </pre>
<p>

<h2> <a name="perl_5_10_and_the_concept_of_stable">Perl 5.10 and the concept of stable</a> </h2>
<p>Alberto Sim&#245;es learnt that Slackware 12.1 was about to be
released, and it is set to go with 5.8.8 rather than 5.10.0.</p>
<p>When he enquired as to why this was, he was told that according to
the documentation on cpan.org, 5.10.0 is considered a testing
release, and thus not suitable for general deployment (as in being
bundled with a Linux distribution).</p>
<p>Matt S. Trout warned that anyone into Catalyst will run into problems
with attributes on an unpatched 5.10.0. Reini Urban had several
patches for Cygwin that had to make it back in.</p>
<p>The fact that <code>given</code>/<code>when</code> and smartmatch have problems
was brought up again, and a call was made for someone to go
through the archives and track down the exact issues (which
occurred during my summary sabbatical, sorry).</p>
<p>If a concise explanation can be made and a concensus can be
reached as to what the desired behaviour is, Dave Mitchell,
Matt S. Trout and Ricardo Signes offered to put in the work
to get it done.</p>

<pre>
  smartmatching the concept of stable
  <a href="http://xrl.us/bj2tu">http://xrl.us/bj2tu</a> </pre>
<p>Matt S. Trout reiterated the call for information.</p>
<pre>
  <a href="http://xrl.us/bj2tw">http://xrl.us/bj2tw</a> </pre>
<p>
<h2> <a name="any_takers_for_math__complex_math__trig_and_time__hires">Any takers for <code>Math::Complex</code>/<code>Math::Trig</code> and <code>Time::HiRes</code>?</a> </h2>

<p>Jarkko Hietaniemi put the maintenance of these dual-life modules on
offer, citing lack of time to be able to devote the required tuits
to shepherd them along. Zefram offered to take them over, since they
were already of interest to him.</p>
<pre>
  time for some maths
  <a href="http://xrl.us/bj2ty">http://xrl.us/bj2ty</a> </pre>
<p>
<h2> <a name="bug_or_not_constants_warn_only_once">Bug or not? constants warn only once</a> </h2>
<p>Nicholas was surprised that the following code only produces
one warning:</p>
<pre>
  perl -lwe 'sub pie {print 0 + &quot;pie&quot;}; pie; pie;'</pre>

<p>An even simpler variation on theme also didn't produce subsequent
warnings and one could argue that it should. The problem is that
the expression gets marked as valid numerically (or more precisely,
<code>IOK</code> gets set) after the first time through (and issuing a warning)
whereas the second time around the numeric context is used directly,
thereby skipping the chance for the warning to fire.</p>
<p>Jan Dubois therefore observed that this was the equivalent of saying
that <code>IOK</code> should be not be set if the conversion generated a
warning.</p>
<p>Abigail ventured the opinion that one warning was enough, and that
if the problem the warning was signalling was so important as to
merit repeated warnings about the same problem, then the warning
should have been an error in the first place.</p>
<p>In the end, Nicholas suggested a series of tests to codify the
behaviour and asked people to see if any loose ends needed to be
tied up.</p>
<pre>
  have your say
  <a href="http://xrl.us/bj2t2">http://xrl.us/bj2t2</a> </pre>

<p>
<h2> <a name="one_less_file__copy_bug">One less <code>File::Copy</code> bug</a> </h2>
<p>Nicholas fixed up the very silly bug that allowed one to copy
a file using a buffer of 0 bytes, which is only useful if you
want 0 bytes in the copied file.</p>
<p>The conversation then veered into a discussion about the fact
that <code>File::Copy</code> doesn't respect file permissions and
attributes, and other generally unhelpful problems the module
has.</p>
<pre>
  it's ok to ask the OS to do it
  <a href="http://xrl.us/bj2t4">http://xrl.us/bj2t4</a> </pre>

<p>
<h2> <a name="new_perl_packages_fix_denial_of_service__debian_">New perl packages fix denial of service (Debian)</a> </h2>
<p>Spiros Denaxas wanted to know if the porters were aware of a
Debian security issue concerning buffer overflows in regular
expressions containing Unicode characters.</p>
<p>Tony Cook replied that there was an open ticket (#48156) on the
issue in the bug database.</p>
<pre>
  <a href="http://xrl.us/bj2t6">http://xrl.us/bj2t6</a> </pre>
<p>
<h2> <a name="on_the_almost_impossibility_to_write_correct_xs_modules">On the almost impossibility to write correct XS modules</a> </h2>
<p>Marc Lehmann wrote an impassioned plea to see what could be done
about helping XS modules work correctly with Unicode strings.</p>

<p>The first problem is that the raw interface to a string (<code>char *</code>)
is useless, since there is no side channel to tell the XS
code what encoding is in use.</p>
<p>In reaction to this, some XS authors have invented their own
XS typemaps to get around the problem, however this can result
in objects being stringified.</p>
<p>The only way out that Marc could see was to take a mortal copy
of the input argument. Rafael thought that it might be possible
to invent a more efficient mechanism, if only syntactically.</p>
<p>Marc stressed that the problem with the current situation is
that when people encounter the problem on their own, they wind
up learning about the utf-8 flag and begin to play around with
that, and this leads to only more tears. Hence, if Perl wants
to get really serious about Unicode, it needs to be addressed
in a sane manner for XS.</p>
<pre>
  <a href="http://xrl.us/bj2t8">http://xrl.us/bj2t8</a> </pre>
<p>
<h2> <a name="installdirs_and_dual_life_modules">INSTALLDIRS and dual-life modules</a> </h2>

<p>Paul Marquess inquired about the right way to deal with CPAN updates
overwriting core versions of modules correctly. By default, the
CPAN shell will carefully install the new version in an <code>@INC</code>
directory listed after the core version (also known as shadowing).
The trick is to specify an override in the <code>Makefile.PL</code> (or
<code>Build.PL</code>) of the CPAN module.</p>
<p>Rafael wondered if there was a problem with the core installing
files in architecture-dependent directories when in fact they
should be installed in architecture-independent directories,
and whether it was because of some blanket assumption about
the modules living under <em>ext/</em> in the codebase.</p>
<pre>
  <a href="http://xrl.us/bj2ua">http://xrl.us/bj2ua</a> </pre>

<p>
<h2> <a name="closing_tickets_in_rt">Closing tickets in RT</a> </h2>
<p>Bram trawled through RT and found close on a dozen tickets
that he thought could be closed. So Steve Peters closed them.
For another ticket concerning AIX, H.Merijn Brand suggested
a hint that checks that the maths library is available.</p>
<pre>
  <a href="http://xrl.us/bj2uc">http://xrl.us/bj2uc</a> </pre>
<p>
<h2> <a name="linking_with_dynaloader_and_extutils__embed__ldopts_since_5_10">Linking with <code>DynaLoader</code> and <code>ExtUtils::Embed::ldopts</code> since 5.10</a> </h2>

<p>Reini Urban reported that linking against DynaLoader had become quite
difficult since the release of 5.10, due to changes in the way various
linker symbols were exposed where. Rafael pointed to the exact change
to help Reini understand what was going on.</p>
<p>Nicholas Clark thought that a test or two wouldn't go astray.</p>
<pre>
  <a href="http://xrl.us/bj2ue">http://xrl.us/bj2ue</a> </pre>
<p>
<h2> <a name="smoking_bleed__33752_blew_up_my_system">Smoking bleed @33752 blew up my system</a> </h2>
<p>Johan Vromans had the misfortune to smoke change #33752, which was
perfectly bracketed by change #33751, which introduced a bug into
the forked debugger code that was then reverted by change #33753.</p>
<p>Unfortunately the bug caused the smoker log file to fill up the
remaining disk space with an endless loop of debugger output.</p>
<pre>

  you have been warned
  <a href="http://xrl.us/bj2ug">http://xrl.us/bj2ug</a> </pre>
<p>
<hr>
<h1> <a name="todo_of_the_week">TODO of the week</a> </h1>
<p>Hey! We got a bite! James Bence wrote a patch to <strong>make a reproducible
<em>perlmodlib.PL</em> </strong>. Note to budding TODO doers: please use unified diffs
for sending patches (<code>diff -u</code>, or the more melodious <code>diff -dub</code>).</p>

<pre>
  smoke that
  <a href="http://xrl.us/bj2ui">http://xrl.us/bj2ui</a> </pre>
<p>Next up, I think the following two TODOs are dids.</p>
<dl>
<dt> <strong> <a name="improving_threads_shared">Improving <code>threads::shared</code> </a> </strong></dt>

<dd>
<p>Investigate whether <code>threads::shared</code> could share aggregates properly
with only Perl level changes to <code>shared.pm</code>.</p>

</dd>

<dt> <strong> <a name="posix_memory_footprint"> <code>POSIX</code> memory footprint</a> </strong></dt>

<dd>
<p>Ilya observed that <code>use POSIX</code> eats memory like there's no tomorrow, and
at various times worked to cut it down. There is probably still fat to
cut out - for example POSIX passes Exporter some very memory hungry
data structures.</p>
</dd>

</dl>
<p>I believe that the first issue, if anything can be done about it, is
receiving the appropriate amount of care from Jerry D. Hedden. And
the second issue has been resolved with Nicholas Clark's new
implementation for constant subs.</p>

<p>Here, then, is a TODO that requires a little C knowledge:</p>
<p>
<h2> <a name="weed_out_needless_perl_unused_arg">Weed out needless <code>PERL_UNUSED_ARG</code> </a> </h2>
<p>The C code uses the macro <code>PERL_UNUSED_ARG</code> to stop compilers warning about
unused arguments. Often the arguments can't be removed, as there is an
external constraint that determines the prototype of the function, so this
approach is valid. However, there are some cases where <code>PERL_UNUSED_ARG</code>
could be removed. Specifically</p>
<ul>
<li>

<p>The prototypes of (nearly all) static functions can be changed</p>
</li>
<li>
<p>Unused arguments generated by short cut macros are wasteful - the short cut
macro used can be changed.</p>
</li>
</ul>
<p>
<hr>
<h1> <a name="patches_of_interest">Patches of Interest</a> </h1>
<p>
<h2> <a name="perlfunc_pod__atan2_0_0__returns_0__not_undef"> <em>perlfunc.pod</em>: <code>atan2(0,0)</code> returns 0, not <code>undef</code> </a> </h2>

<p>The porters continued to study the holy scriptures (that is, the C
standard) this past fortnight to figure just what was the best thing
for <code>atan2(0,0)</code> to return.  Rafael Garcia-Suarez boldly went where
no pumpking had gone before, and declared with change #33676 that
it should return <code>undef</code>. And almost immediately began to have
second thoughts.</p>
<p>Andy Dougherty opened another can of worms and asked if we should
also be checking for things like &#177;0. But it seems that, buried
in the Configure infrastructure, we already do.</p>
<pre>
  an error shall not occur
  <a href="http://xrl.us/bj2uk">http://xrl.us/bj2uk</a> </pre>
<p>
<h2> <a name="allow______and______instead_of_____and____">Allow <code>-&gt;[]</code> and <code>-&gt;{}</code> instead of <code>@{}</code> and <code>%{}</code> </a> </h2>

<p>Ben Morrow delivered an amazing hack to the parser to allow <code>$x-&gt;[]</code>
(currently a syntax error) to be semantically equivalent to <code>@$x</code>,
and this comes in handy when <code>$x</code> is a complex hash-array-hash-hash-array
dereference.</p>
<p>Rafael Garcia-Suarez commended Ben on the patch, and asked for a)
tests and b) whether <code>qq{$x-&gt;p[]}</code> worked, since the latter
involves working with the scarier parts of the lexer.</p>

<p>One problem that arose with builtins and there prototypes is that
the lexer really, really, <em>really</em> wants arrays to begin with a
<code>@</code> sigil. Nevertheless Ben came back with another iteration of
the patch that solved that problem, by pushing the is-it-an-array
decision from the lexer into the various ops. As a bonus this slims
the <code>PL_parser</code> struct, and shaves off an op here and there.</p>
<p>Other people admitted to being a bit disturbed by the patch, citing
that it added some inconsistencies to the language that were a
little too weird to explain away with mere hand-waving.</p>
<p>Jonathan Rockway pointed out that this doesn't help the matter of
protecting array dereferences from blowing up by guarding it with
an empty list as in</p>
<pre>
  @{ $might-&gt;{be}{undef} || [] }</pre>

<p>This moved Nicholas Clark to say that autovivification would be less
inconsistent if <code>@$x</code>, where <code>$x</code> is undef, returned an empty list.
This garnered a certain amount of agreement, but Graham Barr
pointed out that code that dereferences <code>undef</code> expecting something
good to happen is probably buggy.</p>
<p>Aristotle Pagaltzis thought that <code>autobox::Core</code> already provides
a satisfactory solution to retrofitting a saner syntax onto Perl 5,
and for anything beyond becomes the realm of Perl 6.</p>
<p>People asked again why it was that <code>autobox</code> wasn't in core, and
Nicholas Clark did such a wonderful job of summarising the debate
that it deserves its own entry right here:</p>

<pre>
  <a href="http://xrl.us/bj2un">http://xrl.us/bj2un</a> </pre>
<p>Matt S. Trout wrapped up the thread to say that new, exotic
syntax bending must first of all prove itself as a distinct CPAN
module, and only afterwards should it move into core. And if it
can't be done without patching the core itself, then the core
needs to expose more hooks so that such syntax extensions can
be made. Which is sort of the argument for putting autobox in
the core, but like David Nicol says, the name is strange, or at
least esoteric, and possibly it leads us to the Dark Side Of
Laziness.</p>
<pre>
  try this at home
  <a href="http://xrl.us/bj2up">http://xrl.us/bj2up</a> </pre>
<p>
<h2> <a name="linking_to_better_alternatives_from_core_modules">Linking to Better Alternatives from core modules</a> </h2>
<p>Shlomi Fish suggested adding SEE ALSO references from core modules
to other modules available on CPAN that solve the issue in better
ways.</p>

<p>A number of people took issue with the subjective slant of &quot;better&quot;
and thought that &quot;alternative&quot; would be, well, better.</p>
<p>One of the suggested modules, in relation to <code>File::Spec</code> was
<code>Path::Class</code>, but S&#233;bastien Aperghis-Tramoni mentioned that he
had modified a number of programs at work in this very way, but had
to roll back the changes due to unexpected interactions between
<code>Path::Class</code> and other non-Path::Class-aware modules on CPAN.</p>

<pre>
  <a href="http://xrl.us/bj2ur">http://xrl.us/bj2ur</a> </pre>
<p>
<h2> <a name="perlbugging_non_core_modules">perlbugging non-core modules</a> </h2>
<p>Alexandr Ciornii continued to enhance <code>perlbug</code> to warn the user
if they tried to report a bug in a non-core module. Perhaps part
of the reason that no-one commented was that he leveraged CPAN.pm
to do the heavy lifting, which makes for one more thing to go
wrong.</p>
<pre>
  and Module::Corelist?
  <a href="http://xrl.us/bj2ut">http://xrl.us/bj2ut</a> </pre>

<p>
<h2> <a name="fix_several_problems_in_a2p">Fix several problems in <code>a2p</code> </a> </h2>
<p>Gregg Weber delivered a patch to fix no less than seven problems in <code>a2p</code>,
the awk-to-Perl convertor, as well as the smarts to deal with two
modern awk language extensions. Tels thought that the patch had
been inverted, but other than that the patch attracted no comments.</p>
<pre>
  <a href="http://xrl.us/bj2uv">http://xrl.us/bj2uv</a> </pre>
<p>
<h2> <a name="gcc__foptimize_sibling_calls_cause_trouble_for_perl_s_signal_handler"> <code>gcc -foptimize-sibling-calls</code> cause trouble for perl's signal handler</a> </h2>

<p>Gisle Aas reported that the above switch will cause gcc 3.3 to emit
incorrect code. This can be patched by adding an explicit return
statement at the end of the C function that causes the problem.</p>
<p>Another alternative would be to arrange the build process to not apply
the -foptimize-sibling-calls switch when compiling <em>mg.c</em>.</p>
<pre>
  <a href="http://xrl.us/bj2ux">http://xrl.us/bj2ux</a> </pre>
<p>
<hr>
<h1> <a name="new_and_old_bugs_from_rt">New and old bugs from RT</a> </h1>
<p>

<h2> <a name="clearing_magic__was__length_____0_for_empty____if_utf8_is_in_use____51370_">Clearing magic (was: <code>length($@)&gt;0</code> for empty <code>$@</code> if utf8 is in use) (#51370)</a> </h2>
<p>Animator took a stab at resolving this bug report that details how
magic associated with <code>$@</code> persists long after the need has gone,
and proposed a series of approaches all deficient in one way or
another until finally hitting what looked like the right one.</p>
<p>Rafael thought the result looked correct, but thought that some more
testing would be needed, and also wondered if there was a more
concise way of achieving the same result (rather than 8 lines of
code).</p>
<p>Bram wondered what could be tested, and how to do it. chromatic
couldn't think of anything better than scraping the output of

<code>Devel::Peek</code>.</p>
<pre>
  ye gods, Devel::Peek::XML?
  <a href="http://xrl.us/bj2uz">http://xrl.us/bj2uz</a> </pre>
<p>
<h2> <a name="scalar__util__looks_like_number_versus_optimzation_in_regexp___51568_"> <code>Scalar::Util::looks_like_number</code> <em>versus</em> Optimzation in regexp (#51568)</a> </h2>
<p>Nicholas Clark situated the error within <code>Scalar::Util</code> and prodded Graham
Barr to integrate the change (or something that meets with his favour)
upstream, then it could be merged back into the core afterwards.</p>

<pre>
  c'est utile
  <a href="http://xrl.us/bj2u3">http://xrl.us/bj2u3</a> </pre>
<p>
<h2> <a name="warn_abort_on_attempted_perl_exit___52000_">Warn/abort on attempted perl exit (#52000)</a> </h2>
<p>Animator suggested overriding the core <code>exit</code> built-in function with an
appropriately verbose equivalent. John Gardiner Myers was doubtful as to
whether that would help in his situation, since things were exiting due
to memory allocation failures.</p>
<pre>
  last exit to prompt
  <a href="http://xrl.us/bj2u5">http://xrl.us/bj2u5</a> </pre>

<p>
<h2> <a name="segfault_on_isa_push_after_symbol_table_delete___52074_">Segfault on ISA push after symbol table delete (#52074)</a> </h2>
<p>Rafael fixed up the segfault by ensuring that the deleted stash stays
dead, but wondered what the appropriate behaviour should be when asked
to act upon a stash that is no more.</p>
<p>No clear concensus (between Nicholas, Rafael and Graham Barr) arose,
perhaps because in the end this is just another case where the
experts just say &quot;yeah well things are a little weird around this
part, so don't venture out too far&quot;, and move on to other matters.</p>
<pre>
  doesn't crash == good enough
  <a href="http://xrl.us/bj2u7">http://xrl.us/bj2u7</a> </pre>
<p>

<h2> <a name="perl_5_10_regression_bug_in_match_and_substitution_evaluation_in_list_context___52658_">Perl 5.10 regression bug in match and substitution evaluation in list context (#52658)</a> </h2>
<p>Rafael backed out the optimisation that Yamashino Hio had written (that
sped up <code>s///e</code> substitutions by freeing intermediate temporaries).</p>
<pre>
  choose correctness
  <a href="http://xrl.us/bj2u9">http://xrl.us/bj2u9</a> </pre>
<p>
<h2> <a name="incorrect_variable_name_in_perlintro___52860_">Incorrect variable name in perlintro (#52860)</a> </h2>
<p>Matt Kraai spotted an error in the documentation where the dubious

<code>$a</code> and <code>$b</code> had been replaced by ordinary <code>$x</code> and <code>$y</code>
variables, except not entirely.</p>
<pre>
  <a href="http://xrl.us/bj2vb">http://xrl.us/bj2vb</a> </pre>

<p>
<h2> <a name="invalid_cop_free_of_nullified_cop___52920_">Invalid <code>cop_free</code> of nullified cop (#52920)</a> </h2>
<p>While testing <code>B::C</code>, Reini Urban discovered that nulled opcodes
were being freed. He proposed a straight forward patch that addressed
the symptoms, but wondered if another more subtle patch might be a
better approach. Then he realised it was <code>B::C</code> itself generating
spurious data that could never be produced by the core, thus there
was no cause for alarm.</p>
<pre>
  good cop, bad cop
  <a href="http://xrl.us/bj2vd">http://xrl.us/bj2vd</a> </pre>

<p>In other discussions, Rafael added some code to the core to keep
an eye out for these sorts of shenanigans.</p>
<pre>
  never can be too sure
  <a href="http://xrl.us/bj2vf">http://xrl.us/bj2vf</a> </pre>
<p>
<h2> <a name="map_leaks_memory___53038_">map leaks memory (#53038)</a> </h2>
<p>Robin Redeker reported that <code>while (1) {map 1, 1}</code> leaks memory.
Bram wondered if this was bug #48004 in another guise. Shlomi Fish
confirmed a leak under valgrind. Nicholas Clark used a machine with
real hardware watchpoints to pin-point exactly where the leak was
occurring, but was then not quite sure if it was more an issue of
particularly delayed house-keeping, rather than a leak <em>per se</em>.</p>

<pre>
  <a href="http://xrl.us/bj2vh">http://xrl.us/bj2vh</a> </pre>
<p>
<h2> <a name="utf_8_converted_to_latin1_for_output_with_format_incorrect_output___53054_">UTF-8 converted to Latin1 for output with format incorrect output (#53054)</a> </h2>
<p>Michael Koehn submitted a detailed report where UTF-8 being converted
to Latin1 in a Perl format went wrong. His workaround was to use
an explicit <code>encode</code> on the data.</p>
<p>Alexandr Ciornii confirmed the problem exists with 5.10 on Windows.</p>
<pre>
  <a href="http://xrl.us/bj2vj">http://xrl.us/bj2vj</a> </pre>

<p>
<h2> <a name="modifying____inside_given___53186_">Modifying <code>$_</code> inside <code>given</code> (#53186)</a> </h2>
<p>Ed Avis was bitten by the fact that <code>given</code> takes a copy of its value
that is in turn passed to <code>$_</code> for use in <code>when</code> statements. Paul
Fenwick pointed out that if one used <code>for</code> instead of <code>given</code> then
one could indeed obtain the desired aliasing behaviour.</p>

<pre>
  forgiven
  <a href="http://xrl.us/bj2vm">http://xrl.us/bj2vm</a> </pre>
<p>
<h2> <a name="perl5_8_8_crashed_when_i_build_ikiwiki_on_gentoo_linux___53200_">perl5.8.8 crashed when I build ikiwiki on gentoo linux (#53200)</a> </h2>
<p>A bug report that attracted no comments.</p>
<pre>
  double free or corruption
  <a href="http://xrl.us/bj2vo">http://xrl.us/bj2vo</a> </pre>
<p>
<h2> <a name="stop_t_op_fork_t_relying_on_rand___53238_">Stop <em>t/op/fork.t</em> relying on <code>rand</code> (#53238)</a> </h2>
<p>David Dick noticed that some failures for testing <code>fork</code> involved the
parent and child processes generating a random number. Since the generator
wasn't explicitly seeded, it turns out that every once in a while both
processes would generate the same number and the test would consequently
fail.</p>
<p>David wrote a patch to ensure that the numbers are always different, and
Rafael applied it.</p>
<pre>

  that must have been hard to reproduce
  <a href="http://xrl.us/bj2vq">http://xrl.us/bj2vq</a> </pre>
<p>
<h2> <a name="perl_5_10_0_33733_assertion_with_json__xs_2_2___53244_">perl-5.10.0-33733 assertion with JSON::XS-2.2 (#53244)</a> </h2>
<p>David Favor reported a failure in <code>JSON::XS</code> on the maintenance track
of 5.10. Nicholas Clark suggested a patch to fix <code>JSON::XS</code>. Marc
Lehmann was surprised as it seemed to him that <code>SvCUR</code> could no longer
be used as previously, and thought that many other modules could be
prone to the same sort of failure.</p>

<p>Jan Dubois was surprised as it seemed to him that people shouldn't be
using <code>SvCUR</code> unless <code>SvPOK</code> was known to be true. Marc still thought
it was a regression.</p>
<pre>
  <a href="http://xrl.us/bj2vs">http://xrl.us/bj2vs</a> </pre>
<p>
<h2> <a name="trying_to_build_perl5_8_3_under_maemo_environment___53328_">Trying to build perl5.8.3 under Maemo environment (#53328)</a> </h2>
<p>Devendra Purbiya reported a problem with a <code>getcwd</code> call failing
miserably. S&#233;bastien Aperghis-Tramoni suggested that the first
thing to try would be to use a more modern release, such as 5.8.8
or 5.10.0, which may fix the problem due to fixes made since 5.8.3
was released (over four years ago).</p>

<pre>
  <a href="http://xrl.us/bj2vu">http://xrl.us/bj2vu</a> </pre>
<p>
<h2> <a name="error_on_configure_perl_5_8_6_on_hp_platform__pthread__not_found____53330_">Error on Configure PERL 5.8.6 on HP platform &quot; pthread:  not found.&quot; (#53330)</a> </h2>
<p>Alexandra Bacher also reported having problems building a slightly more
modern perl from source on the HP platform. H.Merijn Brand enquired
as to whether there was a reason she didn't want to a precompiled bundle.</p>
<pre>
  <a href="http://xrl.us/bj2vw">http://xrl.us/bj2vw</a> </pre>

<p>
<h2> <a name="parse_problem_in_switch_pm___53414_">Parse problem in <em>Switch.pm</em> (#53414)</a> </h2>
<p>Another bug report from the module that would not die.</p>
<pre>
  rrrrr, chainsaw, rrrrrrrrr
  <a href="http://xrl.us/bj2vy">http://xrl.us/bj2vy</a> </pre>
<p>
<h2> <a name="perl5_bug_summary">Perl5 Bug Summary</a> </h2>

<p>In the second week we saw a welcome decline of 4 tickets, although sadly
not enough to make up for the difference of 9 new tickets the previous week.</p>
<pre>
  296 + 1524 = 1820 (+11 -2)
  <a href="http://xrl.us/bj2v2">http://xrl.us/bj2v2</a> </pre>
<pre>
  293 + 1523 = 1816 (+6 -10)
  <a href="http://xrl.us/bj2v4">http://xrl.us/bj2v4</a>
  <a href="http://rt.perl.org/rt3/NoAuth/perl5/Overview.html">http://rt.perl.org/rt3/NoAuth/perl5/Overview.html</a> </pre>
<p>

<hr>
<h1> <a name="this_is_the_bbc">This is the BBC</a> </h1>
<dl>
<dt> <strong> <a name="devel_cover">Devel::Cover</a> </strong></dt>

<dd>
<p>Now fixed in 0.64</p>
</dd>
<dd>
<pre>
  <a href="http://xrl.us/bj2v6">http://xrl.us/bj2v6</a> </pre>
</dd>


</dl>
<p>
<hr>
<h1> <a name="new_core_modules">New Core Modules</a> </h1>
<dl>
<dt> <strong> <a name="compress_zlib_io_compress">Compress::Zlib, IO::Compress::*</a> </strong></dt>

<dd>
<p>Paul Marquess synched blead with the latest compression modules available
on CPAN.</p>
</dd>
<dd>
<pre>

  2.009
  <a href="http://xrl.us/bj2v8">http://xrl.us/bj2v8</a> </pre>
</dd>

<dt> <strong> <a name="math_bigint">Math::BigInt</a> </strong></dt>

<dd>
<p>Tels released v1.89, closing out 4 tickets in the process.</p>
</dd>
<dd>
<pre>
  <a href="http://xrl.us/bj2wa">http://xrl.us/bj2wa</a> </pre>

</dd>

<dt> <strong> <a name="win32">Win32</a> </strong></dt>

<dd>
<p>Jan Dubois uploaded 0.36 to CPAN, and Steve Hay synched it with blead.
Not much more than a few tweaks to make it behave nicely when compiled
in 64-bit land.</p>
</dd>
<dd>
<pre>
  <a href="http://xrl.us/bj2wc">http://xrl.us/bj2wc</a> </pre>
</dd>

</dl>

<p>
<hr>
<h1> <a name="in_brief">In Brief</a> </h1>
<p>Reini Urban found the time to figure out Tels's sins with
<strong> <code>Devel::Size</code> and bleadperl</strong>, and wrote a patch to fix it up.</p>
<pre>
  all part of the service
  <a href="http://xrl.us/bj2we">http://xrl.us/bj2we</a> </pre>
<p>Brian Greenfield announced that he had <strong>taken up smoking</strong>.</p>

<pre>
  <a href="http://xrl.us/bj2wg">http://xrl.us/bj2wg</a> </pre>
<p>Reini Urban updated the Perl 5 wiki with a summary of <strong>hints for distributors</strong>
wishing to distribute Perl with their operating system.</p>
<pre>
  comments welcome
  <a href="http://xrl.us/bj2wi">http://xrl.us/bj2wi</a> </pre>
<p>Dave Mitchell wanted to know if it there was anything preventing the inclusion
of <strong> <code>Test::Harness</code> 3.x in maint-5.10.x</strong>. Andy Armstrong thought it would
be fine.</p>

<pre>
  and there was colour!
  <a href="http://xrl.us/bj2wk">http://xrl.us/bj2wk</a> </pre>
<p>Aschwin van der Woude cross-posted a question from an spctools
mailing list regarding a <strong> <em>tpp_gui.pl</em> forking problem</strong>. Tels
wondered if the problem was due to <em>/dev/null</em> missing inside a
<code>chroot</code> jail.</p>

<pre>
  <a href="http://xrl.us/bj2wn">http://xrl.us/bj2wn</a> </pre>
<p>Adriano Ferreira synched blead with <strong>the ongoing developments of <code>Pod::Perldoc</code> </strong>.</p>
<pre>
  <a href="http://xrl.us/bj2wp">http://xrl.us/bj2wp</a> </pre>
<p>Robin Barker had <strong>another go at <code>[[:print:]]</code> <em>versus</em> <code>\p{Print}</code> </strong> that
Rafael liked sufficiently to accept. (Bug #49302).</p>

<pre>
  documents and tests
  <a href="http://xrl.us/bj2wr">http://xrl.us/bj2wr</a> </pre>
<p>Paul Fenwick wanted to know if he could <strong>use <code>%^H</code> in Perl 5.8.x</strong>,
especially the upcoming 5.8.9. Nicholas Clark said no, and that it
was unlikely that the 5.8 track would ever be able to.</p>
<pre>
  time to let go
  <a href="http://xrl.us/bj2wt">http://xrl.us/bj2wt</a> </pre>

<p>Rafael applied a patch for <em>perl5db.pl</em> <strong>to get the forked debugger
to work on Linux/Cygwin</strong> and reverted it after noticing it caused
a failure in <em>perl5db.t</em>.</p>
<pre>
  back to the drawing board
  <a href="http://xrl.us/bj2wv">http://xrl.us/bj2wv</a> </pre>
<p>Bram <strong>documented <code>perlrun -x</code> </strong>.</p>

<pre>
  see bug #46369
  <a href="http://xrl.us/bj2wx">http://xrl.us/bj2wx</a> </pre>
<p>
<h2> <a name="last_week_s_summary">Last week's summary</a> </h2>
<pre>
  6-12 April 2008
  <a href="http://xrl.us/bj2wz">http://xrl.us/bj2wz</a> </pre>
<p>
<h2> <a name="about_this_summary">About this summary</a> </h2>

<p>This summary was written by David Landgren.</p>
<p>Weekly summaries are published on <em> <a href="http://use.perl.org/">http://use.perl.org/</a> </em> and posted
on a mailing list, (subscription: <em> <a href="mailto:perl5-summary-subscribe@perl.org">perl5-summary-subscribe@perl.org</a> </em>).
The archive is at <em> <a href="http://dev.perl.org/perl5/list-summaries/">http://dev.perl.org/perl5/list-summaries/</a> </em>.
Corrections and comments are welcome.</p>
<p>If you found this summary useful, please consider contributing to
the Perl Foundation or attending a YAPC to help support the development
of Perl.</p></p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

