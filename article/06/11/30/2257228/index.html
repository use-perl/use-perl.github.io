<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org story by grinder: This Fortnight on perl5-porters (13-26 November 2006)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>This Fortnight on perl5-porters (13-26 November 2006)</h1>
<h2><a href="/user/grinder/">grinder</a> on 2006-11-30T22:55:00</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p> <i>[we could] not increment the reference count (and hope the SV is
still around when the lvalue subroutine is called)</i> -- Gerard Goossen</p>
<p> <i>Hope and programming don't mix well usually.</i> -- Rafa&#235;l Garcia-Suarez</p></p>
<p>
<h1> <a name="topics_of_interest">Topics of Interest</a> </h1>

<p>
<h2> <a name="installing_perl_still_shouldn_t_feel_like_a_rite_of_passage">Installing Perl still shouldn't feel like a rite of passage</a> </h2>
<p>The thread continued unabated this last fortnight, with a lot of
discussion on how to improve <em>INSTALL</em>. The document attempts to
address a number of conflicting requirements, which means that it
won't be easy to get right.</p>
<pre>
  <a href="http://xrl.us/tkb6">http://xrl.us/tkb6</a> </pre>
<p>
<h2> <a name="failures_while_attempting_to_install_plagger_with_blead">Failures while attempting to install Plagger with <code>blead</code> </a> </h2>

<p>Steve Peters continued to analyse the reasons why Plagger failed
to build on <code>blead</code>. It turns out that some prerequisites also
fail on 5.8.8, so it's not as if it's completely <code>blead</code>'s fault.</p>
<pre>
  Stress testing stress
  <a href="http://xrl.us/tkb7">http://xrl.us/tkb7</a> </pre>
<p>
<h2> <a name="change_24714_broke_term__readline__gnu_todo">Change 24714 broke <code>Term::ReadLine::Gnu</code> TODO</a> </h2>

<p>Andreas K&#246;nig found that <code>Term::ReadLine::Gnu</code> was whacked on
<code>blead</code>, which was due to what Nicholas Clark categorised as
an over-ambitious patch to copy SVs lazily in <code>sv_setsv()</code>.</p>
<pre>
  <a href="http://xrl.us/tar8">http://xrl.us/tar8</a> </pre>
<p>
<h2> <a name="the___prototype_does_not_work_correctly_on_sub_x_____x_">The _ prototype does not work correctly on sub x (_) x;</a> </h2>

<p>&#198;var Arnfj&#246;r&#240; Bjarmason was the first person to notice a problem
with the new _ (underscore) prototype (that indicates that the routine
operates on <code>$_</code> by default).</p>
<p>If one defines a routine, such as:</p>
<pre>
  sub odd (_) {
        return $_ % 2
  }</pre>
<p>... then calling <code>odd</code> (as opposed to <code>odd()</code>) bypasses the pass-the-$_
mechanism. Rafa&#235;l Garcia-Suarez fixed this up straight away.</p>

<pre>
  still in beta
  <a href="http://xrl.us/tkb8">http://xrl.us/tkb8</a> </pre>
<p>
<h2> <a name="memory_leak_with_s____and_hashes">Memory leak with <code>s///</code> and hashes</a> </h2>
<p>Rafa&#235;l was puzzled by a leak with substitutions and hashes and
wondered if the problem was something to do with shared keys. Dave
Mitchell realised that the problem was something else entirely, and
reduced Rafa&#235;l's original problematic code down to a one-liner.</p>
<p>Dave's code showed that the problem was that as soon as one executed
a regular expression with an alternation (that is, <code>/a|b/</code>), a few
SVs were leaked each time. Yves Orton sighed, and admitted that it
was probably all his fault.</p>

<p>Dave pinpointed exactly where in the code they were leaking from.
This was enough to help Yves, and he supplied a fix in short order.
Which worked, and was thus applied.</p>
<pre>
  And they lived happily unallocated ever after
  <a href="http://xrl.us/tkb9">http://xrl.us/tkb9</a> </pre>
<p>
<h2> <a name="how_do_i_check_a_valid_mail_address">How do I check a valid mail address?</a> </h2>
<p>Aaron Sherman took a look at the stock answer to this question (in
<em>perlfaq8</em>) and dusted it down and made a few improvements. The
change was promptly accepted by Rafa&#235;l.</p>
<p>For some strange reason, the thread then devolved into a long
discussion about locales, Unicode and escaping characters that
don't need to be escaped.</p>

<pre>
  <a href="http://xrl.us/tkca">http://xrl.us/tkca</a> </pre>
<p>
<h2> <a name="testing_bleadperl_with_pod__coverage">Testing bleadperl with <code>Pod::Coverage</code> </a> </h2>
<p>Steve Peters noticed that <code>Pod::Coverage</code> thought that lots of
routines weren't documented in <code>blead</code>. The routines in question
were all constant routines, and, thanks to Nicholas Clark's efforts
to reduce the amount of memory they use, they are now so small that
they escape <code>Pod::Coverage</code>'s attention entirely. Nicholas suggested
one way of fixing this.</p>

<p>
<h2> <a name="_threads__failures">'threads' failures</a> </h2>
<p>Jerry D. Hedden cooked up a torture test to provoke race conditions
more easily with threads. The results exceeded his wildest dreams (or
nightmares, take your pick).</p>
<p>Dave Mitchell gave Jerry some assistance, and after a while Jerry
found the root of the problem that was responsible for nearly all the
errors. Once this was fixed, only a couple remained, but Jerry had a
feeling he knew why they were occurring.</p>
<pre>
  <a href="http://xrl.us/tkcb">http://xrl.us/tkcb</a> </pre>
<p>
<h2> <a name="pl_perlio_fd_refcnt_and_perl_track_mempool"> <code>PL_perlio_fd_refcnt</code> and <code>PERL_TRACK_MEMPOOL</code> </a> </h2>

<p>Jan Dubois reported that things were still not playing nicely in PerlIO land
when the right combination of configuration parameters was found. The
problem was that the underlying memory allocation routine was receiving
a pointer to a block of memory allocated by a higher-level allocation
wrapper.</p>
<p>The higher level code is needed when threads come into play, where more
detailed knowledge about which thread asked for the allocated memory
becomes more important (especially on Win32). Jarkko Hietaniemi had an
idea of how it could be fixed.</p>
<pre>
  <a href="http://xrl.us/tkcc">http://xrl.us/tkcc</a> </pre>
<p>Jerry hacked around a bit more, and found that a detached thread was
destructing itself after the main script had already ended, but didn't
know how to pin it down in more detail. After stepping through the
code he found a wonderful comment <code>/* FIXME: treaddead ??? */</code> in
the routine at the top of the call stack.</p>
<p>Evidently he was onto something, and supplied a patch to fix it up,
which Rafa&#235;l dutifully applied.</p>
<pre>
  <a href="http://xrl.us/tkcd">http://xrl.us/tkcd</a> </pre>

<p>Having pondered the metaphysical issues of FIXME comments in code
for a while, Jerry grepped the source to see if there were any
others lying in ambush... and discovered dozens.</p>
<p>He wondered whether it was worth going through the list and
adding items to the TODO list as needed. Warnocked.</p>
<pre>
  <a href="http://xrl.us/tkce">http://xrl.us/tkce</a> </pre>
<p>
<h2> <a name="fix_linker_error_on_win32">Fix linker error on Win32</a> </h2>
<p>Recent code changes to <code>blead</code> caused linker failures on Win32. Both he and
Yves Orton independently discovered the fix. So Rafa&#235;l applied the change,
but Steve continued to note a crash in <em>ext/XS/APItest/t/svsetsv.t</em>.</p>

<p>Steve finally managed to get things straightened out with some particularly
devious macro trickery.</p>
<pre>
  pay no attention to the man behind the preprocessor
  <a href="http://xrl.us/tkcf">http://xrl.us/tkcf</a> </pre>
<p>
<h2> <a name="bignum_breaks_getopt__long"> <code>bignum</code> breaks <code>Getopt::Long</code> </a> </h2>
<p>It's not so much that one breaks the other, it's just that politely ignoring
each other can only get you so far. H.Merijn Brand uncovered a number of
problems when he needed 64 bit integers on a 32-bit CPU, so he just
added <code>-Mbignum</code> to the command-line, and was faintly surprised when
things fell apart.</p>

<p>There followed a long thread about implicit assumptions, containers
and content, the uselessness of <code>ref($foo) eq 'REF'</code>. In the middle,
Yves Orton proposed a patch to fix things up, and a nice overview of
why it's so difficult to write code that asks &quot;can I use this reference
as an array?&quot;.</p>
<pre>
  <a href="http://xrl.us/tkcg">http://xrl.us/tkcg</a> </pre>
<p>Tels discovered that <code>Benchmark</code> fails under <code>-Mbignum</code> and filed
bug #40917. Sadahiro Tomoyuki determined what the problem was and
came up with a fix, which Steve Peters applied.</p>

<pre>
  <a href="http://xrl.us/tkch">http://xrl.us/tkch</a> </pre>
<p>
<h2> <a name="lvalue_substr_using_mortals">lvalue <code>substr</code> using mortals</a> </h2>
<p>Gerard Goossen returned to a problem he raised in August:</p>
<pre>
  <a href="http://xrl.us/tkci">http://xrl.us/tkci</a> </pre>

<p>with a patch that he proposed to fix the behaviour. Rafa&#235;l had quick
look at Gerard's idea, but wondered if it wasn't just sweeping the
underlying problem under the carpet until the end of the scope. Gerard
explained that he saw there were two alternatives available and
how to make them work.</p>
<p>Unfortunately, after a little thought, he realised that the first
alternative couldn't work. Rafa&#235;l found another couple of
problems with it as well, and hinted that the second alternative
was possibly too fragile. It remains to be seen whether some sort
of weak reference might do the trick.</p>
<pre>
  <a href="http://xrl.us/tkcj">http://xrl.us/tkcj</a> </pre>
<p>
<h2> <a name="config_on__other_os_s">Config on 'other OS's</a> </h2>
<p>H.Merijn Brand did some house-keeping on Configure. First he refreshed
the MC units.</p>
<pre>
  <a href="http://xrl.us/tkck">http://xrl.us/tkck</a> </pre>

<p>and then went through to see which new variables that had been added
to <em>Configure</em> in recent times had no sensible defaults for them.
The platforms included Plan 9, Win32, VMS, Symbian and a few others.</p>
<p>He also wrote some code to ensure that changes in the future will
come up on the radar much more quickly, rather than having to
remember to do run some quickly-forgotten script, A number of porters
pitched in and filled out most of the missing blanks.</p>
<pre>
  <a href="http://xrl.us/tkcm">http://xrl.us/tkcm</a> </pre>
<p>
<h2> <a name="class__methodmaker_breaks_somewhere_between_5_9_3_and_5_9_4"> <code>Class::MethodMaker</code> breaks somewhere between 5.9.3 and 5.9.4</a> </h2>

<p>Steffen Schwigon noticed that this module, a pre-requisite for
several dozen modules on CPAN alone, fails on <code>blead</code>, from
5.9.4 onwards. Rafa&#235;l traced this to a change that outlawed
the lvalue use of <code>GvNAME</code>.</p>
<p>Steve Peters fixed things up, and started to work on getting
ppport up to speed on the matter.</p>
<pre>
  <a href="http://xrl.us/tkcn">http://xrl.us/tkcn</a> </pre>
<p>
<h2> <a name="can_gcc_s_ar_command_use_a_file_to_list_the_objects_to_add">Can gcc's <code>ar</code> command use a file to list the objects to add?</a> </h2>

<p>Steve Hay was trying to teach <code>ar</code> to look at a file and use its
contents as a list of object names to add to a library, all for
the sake of reducing the length of a command line.</p>
<p>Nicholas Clark wondered if <code>miniperl</code> was usable at this point, in
which case it could be used to furnish basic <code>xargs</code> functionality.</p>
<pre>
  <a href="http://xrl.us/tkco">http://xrl.us/tkco</a> </pre>

<p>
<h2> <a name="perl5db_pl_detecting_forked_debugger_on_vms"> <em>perl5db.pl</em> detecting forked debugger on VMS</a> </h2>
<p>John E. Malmberg was back in town, hacking perl on VMS. He was
having trouble with the debugger, and he and Craig A. Berry thrashed
out the issues.</p>
<pre>
  <a href="http://xrl.us/tkcp">http://xrl.us/tkcp</a> </pre>
<p>Later on he committed a patch, which provided some nifty functionality
for running the debugger in a separate terminal windows. Craig A. Berry
thought the patch was promising, although he had a couple of reservations
about the implementation. Nevertheless, he applied the patch and promised
to take the debugger out for a spin.</p>
<pre>
  <a href="http://xrl.us/tkcq">http://xrl.us/tkcq</a> </pre>

<p>
<h2> <a name="28325_6_breaks_datetime__format__strptime">28325/6 breaks <code>DateTime::Format::Strptime</code> </a> </h2>
<p>Andreas Knig isolated the change that caused <code>DateTime::Format::Strptime</code>
to start falling over. Yves Orton realised that this was a symptom
of a bug in the regular expression engine, made the appropriate
fix, and added a test to make sure it stays fixed.</p>
<pre>
  <a href="http://xrl.us/tkcr">http://xrl.us/tkcr</a> </pre>
<p>The patch caused something else to fall over in the test
suite. This turned out to be because Yves forgot to include
all the relevant pieces needed.</p>
<pre>

  <a href="http://xrl.us/tkcs">http://xrl.us/tkcs</a> </pre>
<p>Andeas also caught the problem, leading Nicholas to comment that
t/harness needs to become fussier, since it misses things on
Win32 (where Yves develops) that only show up under <code>TEST</code> on
Unix.</p>
<pre>
  <a href="http://xrl.us/tkct">http://xrl.us/tkct</a> </pre>
<p>
<h2> <a name="configure_silence_for_5005threads">Configure silence for 5005threads</a> </h2>
<p>Even though 5.005 threads have been completely excised from the
5.10 codebase, the <em>Configure</em> infrastructure still knows about
it, since it is used to generate the final <code>Configure</code> scripts
for both <code>maint</code> and <code>blead</code>. He did manage, however, to make
it shut up.</p>

<pre>
  <a href="http://xrl.us/tkcu">http://xrl.us/tkcu</a> </pre>
<p>
<h2> <a name="new_development_release_in_sight">New development release in sight</a> </h2>
<p>Rafa&#235;l announced that he wanted to push 5.9.5 out the door,
and asked the porters what they were working on, and what they
thought would be ready soon.</p>
<p>Dave Mitchell admitted that he had broken a few things recently
but was unlikely to find the time in the next few weeks to
attempt the repairs.</p>
<p>Steve Peters wanted to make directory handles more useful, but
was stuck on a problem with pipes hanging on OpenBSD, and was
having trouble ruling Perl out before filing a bug with the
OpenBSD kernel hackers.</p>
<p>H.Merijn Brand mentioned that there were a few <code>Configure</code>

issues he wanted to look into, and possibly an edit or two to
the <em>README</em>/<em>INSTALL</em> issues as raised by Michael G.
Schwern. H.Merijn's <code>Configure</code> issues reminded Andy
Dougherty about a problem with locales, GNU's make and Solaris,
but lacked a Solaris box to check it out.</p>
<p>Yves Orton mapped out his priorities, mainly bug fixes and
making semi-broken things work sanely. One big item was that
he wanted to get the regular expression engine to a state
where custom engines could be dropped in, that would allow,
for instance, test coverage analysis of regular expressions,
or otherwise hacking on the engine without being forced to
relink perl.</p>
<p>Steve Hay wants to get Visual C++ support finished, and
resolve the bug that prevents mod_perl 1.x from building
successfully. When Nicholas Clark mentioned the probable
cause of the problem, it reminded Rick Delaney about diddling
<code>%INC</code> to force a module to be reloaded (something that
<code>mod_perl</code> likes doing a lot). And that was enough for
Nicholas to track down the offending code, and fix it.</p>

<p>Jos I. Boumans provided the list of what modules need to
go into core in order for CPANPLUS to be added in.</p>
<p>Philip M. Gollucci noted that there were still some 5.005
threads remnants dotted about in the code. Steve Hay
thought that it was just harmless detritus, since the 5.005
threads implementation code had been removed over four years
ago. Steve Hay thought that it should be cleaned up
completely, if only to avoid further confusion in the future.</p>
<p>Andy Dougherty cautioned that further cleaning would only
add to the difficulty of merging <code>blead</code> back into <code>maint</code>.
H.Merijn agreed, saying that the current state of affairs
was pretty much optimal.</p>
<pre>
  <a href="http://xrl.us/tkcv">http://xrl.us/tkcv</a> </pre>
<p>

<h2> <a name="io_sock_t_failure_with_vc8"> <em>io_sock.t</em> failure with VC8</a> </h2>
<p>Steve Hay discovered that this test reads its own source code,
and saw that it managed to read only 4096 bytes of code and
thus flunked the test. Steve thought the number was a little
too coincidental to have been left to chance, and wondered
where to start looking.</p>
<pre>
  my lucky number
  <a href="http://xrl.us/tkcw">http://xrl.us/tkcw</a> </pre>
<p>Steve Hay fixed up problems in <em>posix.t</em> with <code>strftime</code> hanging when VC8 was
used to build Perl. He traced it down to the fact that the C run-time
library didn't recognise <code>%D</code> as a valid format, and things went
downhill from there.</p>

<pre>
  <a href="http://xrl.us/tkcx">http://xrl.us/tkcx</a> </pre>
<p>He also tidied up the warnings about deprecated CRT function names in VC8,
and updated <code>perltodo</code>, because what he did was at best a stop-gap measure,
and someone needs to come up with something better.</p>
<pre>
  <a href="http://xrl.us/tkcy">http://xrl.us/tkcy</a> </pre>
<p>
<h2> <a name="qr___benchmark"> <code>qr//</code> benchmark</a> </h2>

<p>Tels ran some benchmarks on compiled regexps and wondered what the numbers
meant. A long discussion followed, developing on the concepts of implementing
a &quot;rule&quot; feature for Perl 5, how compiled regexps behave, how to deal with
combining precompiled regexps and best practices for building a big
precompiled expression from a number of smaller fragments.</p>
<pre>
  <a href="http://xrl.us/tkcz">http://xrl.us/tkcz</a> </pre>
<p>
<hr>
<h1> <a name="patches_of_interest">Patches of Interest</a> </h1>
<p>
<h2> <a name="static_linkage_for_perl_exe_for_win32">static linkage for <em>perl.exe</em> for win32</a> </h2>

<p>A number of porters agreed that this would be useful, and in the end
the necessary changes were committed to Win32's <em>Makefile</em>.</p>
<pre>
  <a href="http://xrl.us/tkc2">http://xrl.us/tkc2</a> </pre>
<p>
<h2> <a name="regex_utility_functions_and_substitution_fix__xml__twig_core_dump_">Regex Utility Functions and Substitution Fix (XML::Twig core dump)</a> </h2>
<p>Yves recent work to teach the regular expression optimiser about lookahead
assertions threw some other assumptions about target lengths off. So he
whipped up a patch to straighten things out. Bundled in with the patch
were assorted improvements he'd made to the engine here and there.</p>
<pre>
  <a href="http://xrl.us/tkc3">http://xrl.us/tkc3</a> </pre>

<p>
<h2> <a name="assorted_goodness_added_to_the_regular_expression_engine">Assorted goodness added to the regular expression engine</a> </h2>
<p>Now that the regular expression has a new recursion syntax (via
<code>(?1)</code>), Yves has been exercising them by converting old-style
<code>(??{...}</code> recursion patterns over to it, and in doing so discovered
a fundamental limitation, in that some times you want to recurse
back to a capture buffer that's relative to the current location,
not the beginning. So he extended <code>(?1)</code> to allow <code>(?-1)</code>, and
made it work, too.</p>
<pre>

  A new feature in every box
  <a href="http://xrl.us/tkc4">http://xrl.us/tkc4</a> </pre>
<p>He also closed out bug #19049 and added relative backreferences, which
means you can say <code>/foo (\w+) bar (\w+) \R1/</code> and the reference count
runs backwards from the current point, leftwards, to the nth capture
group.</p>
<pre>
  I for one will find this handy
  <a href="http://xrl.us/tkc5">http://xrl.us/tkc5</a> </pre>
<p>He also fixed up <code>/a++b/</code> by teaching the optimiser to look for &quot;ab&quot;

before bringing the heavy artillery to bear.</p>
<pre>
  <a href="http://xrl.us/tkc6">http://xrl.us/tkc6</a> </pre>
<p>He also added <code>regmust()</code> to <em>re.pm</em>/<em>re.xs</em>, which exposes to the
client code what the optimiser considers to be the floating and
anchored strings of a potential match.</p>
<pre>
  <a href="http://xrl.us/tkc7">http://xrl.us/tkc7</a> </pre>

<p>In other news, Yves also reorganised the flags of the <code>regexp</code>
struct into two fields, one internal, and one external and applied
a consistent naming convention.</p>
<pre>
  Separation of interest
  <a href="http://xrl.us/tkc8">http://xrl.us/tkc8</a> </pre>
<p>
<hr>
<h1> <a name="new_and_old_bugs_from_rt">New and old bugs from RT</a> </h1>
<p>

<h2> <a name="search_position_reset_after_local_save_restore___1716_">search position reset after <code>local</code> save/restore (#1716)</a> </h2>
<p>Yves Orton went travelling back in time to have a look at some really olde
bugs. This earliest bug was an issue of magic. Yves thought that there should
be some way of getting things to work correctly for <code>pos</code> at least.</p>
<p>This reminded Dave Mitchell that he had been meaning to get around to
looking at how <code>local</code> and magic play together (or not), and told Yves
that it was probably on his personal TODO list. Ironically, the sig attached
to the reply was &quot;Never do today what you can put off till tomorrow.&quot;</p>
<pre>

  Magic, murder and the weather
  <a href="http://xrl.us/tkc9">http://xrl.us/tkc9</a> </pre>
<p>
<h2> <a name="undefining_signals___2383_">Undefining signals (#2383)</a> </h2>
<p>Rafa&#235;l also retired another ancient bug: assigning <code>undef</code> to a signal
handler now restores the default handler.</p>
<pre>
  <a href="http://xrl.us/tkda">http://xrl.us/tkda</a> </pre>

<p>
<h2> <a name="segfault_on_big_regexp___3689_">segfault on big regexp (#3689)</a> </h2>
<p>Yves found another bug report concerning core dumping badness over a
regular expression that Steve Peters missed a while back when he closed
out several zillion bugs,and noted that it was fixed in <code>blead</code>.</p>
<pre>
  <a href="http://xrl.us/tkdb">http://xrl.us/tkdb</a> </pre>
<p>
<h2> <a name="misplaced_here_mark_in_regexp_error___4360_">misplaced HERE mark in regexp error (#4360)</a> </h2>
<p>Yves explained that attempts to use variable width look-behind
assertions (which aren't currently implemented in Perl, although
Yves will no doubt implement them next week) cause the HERE mark
to point at the wrong place.</p>

<p>This is because by the time the parser has figured out that there
is indeed a variable width look-behind assertion, it no lacks the
neurons to remember <em>where</em> it actually occurred. Yves suggested
that the best way forward would be to drop the HERE marker in this
context.</p>
<pre>
  He should know
  <a href="http://xrl.us/tkdc">http://xrl.us/tkdc</a> </pre>
<p>
<h2> <a name="regexp_replaces_using_large_replacement_variables_fails___6006_">Regexp replaces using large replacement variables fails (#6006)</a> </h2>
<p>Yves classified this bug a more of a parsing issue than a regular
expression issue (the fact that <code>${10}</code> doesn't behave as it should
(like <code>$10</code>)). He added a TODO test for someone else to address.</p>

<pre>
  <a href="http://xrl.us/tkdd">http://xrl.us/tkdd</a> </pre>
<p>
<h2> <a name="_g_with__h_results_in_infinite_loop_in_5_6_and_later___6893_"> <code>\G</code> with <code>/h</code> results in infinite loop in 5.6 and later (#6893)</a> </h2>
<p>Yves thought that this bug stank, since it involved people playing
around with things that the regular expression engine would rather
keep to itself. He fixed the problem, but this caused a test in
<code>Text::Balanced</code> to fail. But then again, as the man page of that
module says, &quot;There are undoubtedly serious bugs lurking somewhere
in this code&quot;.</p>

<pre>
  <a href="http://xrl.us/tkde">http://xrl.us/tkde</a> </pre>
<p>With another round of patching, he managed to get thing into good
shape.</p>
<pre>
  <a href="http://xrl.us/tkdf">http://xrl.us/tkdf</a> </pre>
<p>
<h2> <a name="bug_in_s__s_word_s___gi_and______18209_">bug in <code>s/\s$word\s/ /gi</code> and <code>$&amp;</code> (#18209)</a> </h2>

<p>Yves could not reproduce this problem, either in <code>maint</code> or <code>blead</code>.
Just to be on the safe side, he wrote a test case to make sure someone finds
out about it if it ever comes back again.</p>
<pre>
  <a href="http://xrl.us/tkdg">http://xrl.us/tkdg</a> </pre>
<p>
<h2> <a name="_a_b___cannot_match_a_string_longer_than_2__151_characters___18268_"> <code>(a|b)*</code> cannot match a string longer than <code>2**15-1</code> characters (#18268)</a> </h2>

<p>Yves confirmed that this was indeed a hard limit of the regular
expression engine and couldn't see how it could be fixed, so he
added a couple of tests to the test suite, and marked them TODO.</p>
<pre>
  <a href="http://xrl.us/tkdh">http://xrl.us/tkdh</a> </pre>
<p>
<h2> <a name="______bc___10000_times_slower_in_5_8_0_vs_5_6_1___22395_"> <code>/(.*)[bc]/</code> 10000 times slower in 5.8.0 vs 5.6.1 (#22395)</a> </h2>
<p>This was caused by an over-pessimisation in change #14115. Yves optimised
the common case to make it go 10000 time faster again.</p>
<pre>
  <a href="http://xrl.us/tkdi">http://xrl.us/tkdi</a> </pre>

<p>He also made another regular expression go speedy fast again (bug in regexp <code>m/(.*?)b/ig</code>) (#25822)</p>
<pre>
  <a href="http://xrl.us/tkdj">http://xrl.us/tkdj</a> </pre>
<p>
<h2> <a name="encode__is_utf8_on_tainted_utf8_string_returns_false___32687_"> <code>Encode::is_utf8</code> on tainted UTF8 string returns false (#32687)</a> </h2>
<p>Rafa&#235;l fixed up the tainting logic of <code>blead</code>'s copy of <code>Encode</code> and
suggested to Dan Kogai that he incorporate the change in his own version.</p>

<pre>
  Paging Dan &quot;Mr. Encode Maintainer&quot; Kogai, white courtesy phone
  <a href="http://xrl.us/tkdk">http://xrl.us/tkdk</a> </pre>
<p>
<h2> <a name="__r_undefined_on_matches_involving_backreferences___36909_"> <code>$^R</code> undefined on matches involving backreferences (#36909)</a> </h2>
<p>Yves also fixed this bug. H.Merijn yearned to clean up the white space
as well, thought about what Dave Mitchell might say, and decided to do
nothing.</p>
<pre>

  <a href="http://xrl.us/tkdm">http://xrl.us/tkdm</a> </pre>
<p>The above change also fixed a bug your humble summariser uncovered
a couple of years ago. Now it's fixed. Yay Yves! ($^R value lost
in (?:...)? constructs, bug #32840)</p>
<pre>
  <a href="http://xrl.us/tkdn">http://xrl.us/tkdn</a> </pre>
<p>
<h2> <a name="regexp_stack_overflow_in_5_8_7___37230_">Regexp stack overflow in 5.8.7 (#37230)</a> </h2>
<p>Brian Candler posted a bug report in September concerning a regular expression
used to parse a particularly devious line in an Apache log file. Yves was
pretty sure that the problem was resolved in <code>blead</code>.</p>

<pre>
  <a href="http://xrl.us/tkdo">http://xrl.us/tkdo</a> </pre>
<p>
<h2> <a name="cwd__chdir___and_handles___38466_"> <code>Cwd::chdir()</code> and handles (#38466)</a> </h2>
<p>Ken Williams was astonished to learn that <code>chdir</code> may operate on file
handles. He updated the <code>PathTools</code> distribution.</p>

<pre>
  &quot;Holy crap, chdir() can accept a filehandle? I had no idea.&quot;
  <a href="http://xrl.us/tasi">http://xrl.us/tasi</a> </pre>
<p>
<h2> <a name="segfault_in_regex_on_a_very_long_string___40654_">segfault in regex on a very long string (#40654)</a> </h2>
<p>Stas Bekman checked in to see what the status is with this bug.
Answer: fixed in <code>blead</code>, still fails in latest <code>maint</code>.</p>

<pre>
  <a href="http://xrl.us/tkdp">http://xrl.us/tkdp</a> </pre>
<p>
<h2> <a name="perlop______40854_">perlop <code>=&gt;</code> (#40854)</a> </h2>
<p>Dr. Ruud asked a fairly innocent question about bareword hash keys
and the fat comma operator, and this generated a certain amount
of traffic. John Peacock correctly identified the issue as being the
fact that the leading zero of the bareword was triggering octal
interpretation.</p>
<pre>
  <a href="http://xrl.us/tkdq">http://xrl.us/tkdq</a> </pre>

<p>
<h2> <a name="find2perl_ls_very_slow_on_some_ldapbased_getpwent_systems___40867_"> <code>find2perl -ls</code> very slow on some LDAP-based <code>getpwent</code> systems (#40867)</a> </h2>
<p>David Dyck found that <code>find2perl</code>'s propensity to warm its caches
caused massive slowdowns on big LDAP directories, and wondered if
there would be any problems in adopting a lazy caching strategy.
Rafa&#235;l saw no problem.</p>
<pre>
  do not do today...
  <a href="http://xrl.us/tkdr">http://xrl.us/tkdr</a> </pre>

<p>
<h2> <a name="pod2xxx_requires_pod____parsers_to_reset_state___40899_"> <code>pod2xxx</code> requires <code>Pod::*</code> parsers to reset state (#40899)</a> </h2>
<p>espie uncovered a problem with Pod::Man <em>et al.</em> using a single POD
parser object to parse multiple files, which causes problems. Earlier
files with POD errors influence the rendering of subsequent files.
(This issue reared its head a few months back, when Russ Alberry was
working on the podlators distribution).</p>
<pre>
  <a href="http://xrl.us/tkds">http://xrl.us/tkds</a> </pre>

<p>
<h2> <a name="record_reads_and__encoding_don_t_mix___40901_">Record reads and :encoding don't mix (#40901)</a> </h2>
<p>Christopher J. Madsen discovered that reading fixed-length records
(for instance, with <code>$/ = \10</code>) and <code>:encoding</code> don't play well
together. Especially when converting between EBCDIC and UTF-8.</p>
<pre>
  why am I not surprised?
  <a href="http://xrl.us/tkdt">http://xrl.us/tkdt</a> </pre>
<p>
<h2> <a name="_ahocorasick__regex_patch__28373__not_threadsafe___40954_">'Aho-Corasick' regex patch (28373) not thread-safe (#40954)</a> </h2>
<p>Jerry D. Hedden found, much to Yves's dismay, that the Aho-Corasick
patch was not thread-safe. When Yves looked at what needed to be done
he threw up his hands in horror and wondered if there wasn't a better
way of abstracted the differences between threaded an unthreaded
builds.</p>
<p>The main problem is that the op-tree (which also contains regops)
is shared among all threads, so detached threads tend to have more
problems with heavy objects hanging off the op-tree. Dave Mitchell
said that he had plans for a &quot;copy-on-retrieve&quot; technique for this
problem, which would mean that a lot of these sorts of issues with
threads would suddenly disappear.</p>
<pre>
  <a href="http://xrl.us/tkdu">http://xrl.us/tkdu</a> </pre>
<p>Similarly, Jerry also found that <code>Perl_op_clear</code> is not thread-safe (#40965).</p>

<pre>
  <a href="http://xrl.us/tkdv">http://xrl.us/tkdv</a> </pre>
<p>
<h2> <a name="date__parse_mysteriously_lowercasing_text_when_an_unrelated_variable_is_used____40957_"> <code>Date::Parse</code> mysteriously lowercasing text when an unrelated variable is used. (#40957)</a> </h2>
<p>Mumia W. encountered a curious bug involving sorts, closures and <code>lc</code>
which resulted in some very strange action at a distance.</p>
<pre>
  and there was great puzzlement
  <a href="http://xrl.us/tkdw">http://xrl.us/tkdw</a> </pre>

<p>
<h2> <a name="build_fails_with_dno_mathoms___40963_">Build fails with <code>-DNO_MATHOMS</code> (#40963)</a> </h2>
<p>Jerry D. Hedden found that you can't build perl without mathoms, despite
what it says on the tin.</p>
<pre>
  <a href="http://xrl.us/tkdx">http://xrl.us/tkdx</a> </pre>
<p>
<h2> <a name="mswin32__can_t_disable_crlf_trans__on_stdxxx_using__raw_or_binmode___40964_">MSWin32: can't disable crlf trans. on STDxxx using :raw or binmode (#40964)</a> </h2>

<p>Vaclav Ovsik built a perl with his bare hands on Win32, and noticed
that he couldn't disable line-endings translations through the PerlIO
layer.</p>
<pre>
  <a href="http://xrl.us/tkdy">http://xrl.us/tkdy</a> </pre>
<p>
<h2> <a name="sigsegv_with_pos___in_regexp___40989_">SIGSEGV with <code>pos()</code> in regexp (#40989)</a> </h2>
<p>Christian Mittag had the decency to produce one of the tiniest
programs possible to provoke a core dump, with the following code:</p>
<pre>
  $_=&quot;a\x{111}\x{111}a\t&quot;;
  s/\t/pos;' ';/eg;</pre>

<p>Unfortunately no-one leapt to his rescue.</p>
<pre>
  won't you come on down to my
  <a href="http://xrl.us/tkdz">http://xrl.us/tkdz</a> </pre>
<p>
<h2> <a name="perl5_bug_summary">Perl5 Bug Summary</a> </h2>
<p>For the first time in a quite some time, a significant reduction in the number
of open bugs was observed. Yay! Congratulations to everyone who helped out.</p>
<pre>
  5 open, 7 closed
  <a href="http://xrl.us/tkd2">http://xrl.us/tkd2</a> </pre>

<pre>
  7 open.... and *18* closed
  <a href="http://xrl.us/tkd3">http://xrl.us/tkd3</a> </pre>
<pre>
  We need a &quot;choose random bug&quot; link
  <a href="http://rt.perl.org/rt3/NoAuth/perl5/Overview.html">http://rt.perl.org/rt3/NoAuth/perl5/Overview.html</a> </pre>
<p>
<hr>
<h1> <a name="new_core_modules">New Core Modules</a> </h1>

<ul>
<li>
<p> <code>threads</code> went to version 1.51 and on to version 1.52.</p>
<pre>
  <a href="http://xrl.us/tkd4">http://xrl.us/tkd4</a>
  <a href="http://xrl.us/tkd5">http://xrl.us/tkd5</a> </pre>
</li>
<li>
<p> <code>Module::Pluggable</code> was offered to the core.</p>

<pre>
  Jos, unplugged
  <a href="http://xrl.us/tkd6">http://xrl.us/tkd6</a> </pre>
</li>
<li>
<p> <code>Module::Load::Conditional</code> made it to the core. Tels wondered about
core bloat, but I told him that there was nothing to worry about.</p>
<pre>
  It's all good
  <a href="http://xrl.us/tkd7">http://xrl.us/tkd7</a> </pre>
</li>

<li>
<p> <code>IPC::Cmd</code> also went past Go and collected $200.</p>
<pre>
  <a href="http://xrl.us/tkd8">http://xrl.us/tkd8</a> </pre>
</li>
</ul>
<p>
<hr>
<h1> <a name="in_brief">In Brief</a> </h1>
<p>The <strong>&quot;WHOA THERE&quot; messages</strong> were toned down.</p>

<pre>
  <a href="http://xrl.us/tkd9">http://xrl.us/tkd9</a> </pre>
<p>Yves Orton was a busy man this week, in case you hadn't already realised. Some
more of his handiwork included noticing that <strong>bug #6719</strong> wasn't. It was</p>
<pre>
  working as documented
  <a href="http://xrl.us/tkea">http://xrl.us/tkea</a> </pre>
<p> <strong>Bug #17542</strong> is no longer confuses on <code>blead</code>,</p>

<pre>
  <a href="http://xrl.us/tkeb">http://xrl.us/tkeb</a> </pre>
<p> <code>$`</code> is now always <strong>correct after replacement</strong> (bug #19049)</p>
<pre>
  <a href="http://xrl.us/tkec">http://xrl.us/tkec</a> </pre>
<p>and there are <strong>no more spurious undefs</strong> in <code>@-</code> and <code>@+</code> during

<code>(?{})</code> and <code>(??{})</code> (bug #22614)</p>
<pre>
  <a href="http://xrl.us/tked">http://xrl.us/tked</a> </pre>
<p>In other news, Rafa&#235;l fixed up <strong>a problem with <em>base.pm</em> calling <code>-&gt;isa()</code> </strong> (bug #24824)</p>

<pre>
  <a href="http://xrl.us/tkee">http://xrl.us/tkee</a> </pre>
<p>and made <strong>tied variables work with .= &lt;&gt;</strong> in blead (bug #38631)</p>
<pre>
  <a href="http://xrl.us/tkef">http://xrl.us/tkef</a> </pre>
<p>On the other hand, he didn't know what to do when <strong> <code>$1</code> is bound
to an out-of-scope variable</strong> so he added an assert in the code, to
fail gracefully, (bug #38869)</p>

<pre>
  <a href="http://xrl.us/tkeg">http://xrl.us/tkeg</a> </pre>
<p>although he managed to <strong>make <code>Tie::Memoize::EXISTS</code> cache its value</strong>
(bug #39026),</p>
<pre>
  <a href="http://xrl.us/tkeh">http://xrl.us/tkeh</a> </pre>
<p>as well as ensuring that <strong> <code>rcatline</code> stringifies references</strong> (bug #39037)
(when it has to).</p>

<pre>
  <a href="http://xrl.us/tkei">http://xrl.us/tkei</a> </pre>
<p>Adriano Ferreira closed out <strong>a <code>Symbol::delete_package()</code> bug</strong> (bug #34078) (a
documentation patch), since the documentation has already been patched,</p>
<pre>
  <a href="http://xrl.us/tkej">http://xrl.us/tkej</a> </pre>
<p>and added some <strong>tests and documentation for <code>&amp;=</code>, <code>|=</code> and <code>^=</code> </strong> (bug #36689)</p>

<pre>
  <a href="http://xrl.us/tkek">http://xrl.us/tkek</a> </pre>
<p>as well as an improvement to <strong>a documentation example for
<code>File::Basename</code> </strong>. (bug #40866)</p>
<pre>
  <a href="http://xrl.us/tkem">http://xrl.us/tkem</a> </pre>
<p>Nicholas Clark managed to resolve the <strong> <code>blead</code> crash in

<code>Perl_pp_entersub()</code> </strong> (bug #40681) to his satisfaction by
tweaking the <code>sv_setsv_flags</code> macro's behaviour.</p>
<pre>
  <a href="http://xrl.us/tken">http://xrl.us/tken</a> </pre>
<p>Philippe found <strong>some inconsistencies in items formatted with
<code>pod2html</code> </strong> (bug #40851), but no <code>pod2html</code> specialists were
on hand to offer advice.</p>

<pre>
  <a href="http://xrl.us/tkeo">http://xrl.us/tkeo</a> </pre>
<p>Philip M. Gollucci thought that <strong> <code>rt.perl.org</code> needs a 5.9.5</strong> category
for reporting bugs.</p>
<pre>
  <a href="http://xrl.us/tkep">http://xrl.us/tkep</a> </pre>
<p>Mike Guy, man of infinite memory, recalled that <strong>list assignments with
lvalue <code>undef</code>s</strong> (such as <code>($foo, undef, $bar) = @list</code>) was introduced
between 5.004_04 and 5.004_05.</p>

<pre>
  <a href="http://xrl.us/tkeq">http://xrl.us/tkeq</a> </pre>
<p>Buu wondered if you could <strong>create lexicals via other methods than <code>my</code> </strong>.</p>
<pre>
  why?
  <a href="http://xrl.us/tker">http://xrl.us/tker</a> </pre>
<p>Ken Williams wanted a regression test for <strong>the change to
<code>ExtUtils::ParseXS</code> for <code>$filepathname</code> </strong>.</p>

<pre>
  Warnocked
  <a href="http://xrl.us/tkes">http://xrl.us/tkes</a> </pre>
<p>Ron Blaschke had <strong>some thoughts on Microsoft Visual C++ 8.0</strong> (quite
an essay, really), and Steve Hay commented that he had reached much
the same conclusion.</p>
<pre>
  <a href="http://xrl.us/tket">http://xrl.us/tket</a> </pre>
<p>H.Merijn Brand and <strong>HP-UX 11.xx and GNU gcc can make the 5.8.x
debugger dump core</strong> at will.</p>

<pre>
  <a href="http://xrl.us/tkeu">http://xrl.us/tkeu</a> </pre>
<p>Phil Pennock penned a message describing <strong>problems in <code>IO::Socket::INET6</code> and
<code>INET4</code> compatibility</strong>.</p>
<pre>
  <a href="http://xrl.us/tkev">http://xrl.us/tkev</a> </pre>

<p>Andreas K&#246;nig noted that <strong>patch 28788 to bleadperl breaks
<code>XML::Atom</code> </strong>, so Steve Peters fixed things up.</p>
<pre>
  <a href="http://xrl.us/tkew">http://xrl.us/tkew</a> </pre>
<p> <strong> <code>POSIX::remove()</code> deletes directories</strong> now, because the specification
says it should.</p>
<pre>
  <a href="http://xrl.us/tkex">http://xrl.us/tkex</a> </pre>

<p> <strong> <code>Text::Template</code> fails with bleadperl</strong> and so it should, because it
uses <code>\Q</code> to quotemeta a string, and that string contains <code>'\</code>, and
quotemeta is now correctly doubling up the backslash.</p>
<pre>
  <a href="http://xrl.us/tkey">http://xrl.us/tkey</a> </pre>
<p>Jarkko gave us a pointer to the <strong>Safer C Library</strong>.</p>

<pre>
  they've done it now
  <a href="http://xrl.us/tkez">http://xrl.us/tkez</a> </pre>
<p>Nicholas wondered if it was worth <strong>warning about unused lexicals</strong>.</p>
<pre>
  <a href="http://xrl.us/tke2">http://xrl.us/tke2</a> </pre>
<p>He also met up with an old familiar silly error, and as a result
<strong> <code>Carp</code>'s cache should work better</strong>.</p>

<pre>
  hand the man a brownie point
  <a href="http://xrl.us/tke3">http://xrl.us/tke3</a> </pre>
<p>Jarkko bestowed <strong>some portability updates</strong> upon <em>perlhack</em>,</p>
<pre>
  <a href="http://xrl.us/tke4">http://xrl.us/tke4</a> </pre>
<p>and pointed the fire extinguisher at certain bits of code that <strong>the
daily smokes were coughing</strong> over.</p>

<pre>
  <a href="http://xrl.us/tke5">http://xrl.us/tke5</a> </pre>
<p>
<h2> <a name="about_this_summary">About this summary</a> </h2>
<p>This summary was written by David Landgren. My apologies to those
of you undergoing summary withdrawal symptoms. The reason there was
no summary last week was that I spent all my tuits working on slides
for the French Perl Workshop. If perl 5.10 isn't released before
YAPC::Europe next year, I just might have to inflict my talk on
another audience...</p>
<p>In the previous summary, I wrote that Brandon Black wrote <code>Class::C3</code>,
when in fact it was written by Stevan Little. Brandon is the current
maintainer. My apologies to both for the mix-up.</p>
<p>Weekly summaries are published on <em> <a href="http://use.perl.org/">http://use.perl.org/</a> </em> and posted
on a mailing list, (subscription: <em> <a href="mailto:perl5-summary-subscribe@perl.org">perl5-summary-subscribe@perl.org</a> </em>).
The archive is at <em> <a href="http://dev.perl.org/perl5/list-summaries/">http://dev.perl.org/perl5/list-summaries/</a> </em>.
Corrections and comments are welcome.</p>

<p>If you found this summary useful, please consider contributing to
the Perl Foundation to help support the development of Perl.</p></p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

