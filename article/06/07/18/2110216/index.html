<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org story by grinder: This Week on perl5-porters (10-16 July 2006)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>This Week on perl5-porters (10-16 July 2006)</h1>
<h2><a href="/user/grinder/">grinder</a> on 2006-07-18T21:08:00</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p> <em>"Kindly avoid inflicting upon this one the same fate shared by
so much other documentation produced by a patchwork of well-meaning
but disparate contributors seeing more the trees than the forest
as they continually apply peephole optimizations that inadvertently
compromise the overall integrity of the work, where the presentation
eventually more resembles an illegible patchwork quilt of no especial
application or intended purpose than it does a dedicated garment of
one cloth woven."</em> -- Tom Christiansen, at the height of his form.</p></p>
<p><h1> <a name="topics_of_interest">Topics of Interest</a> </h1>
<p>
<h2> <a name="adding_examples_to_the_core_documentation">Adding examples to the core documentation</a> </h2>
<p>Gabor Szabo continued his quest to add examples to the core
documentation, based on feedback he had received giving training
lessons. First up, he wanted to rewrite <code>perlfunc</code> to use the
modern approach for opening files (using lexical file handles and
the three argument form).</p>
<p>While no-one could dispute that this was a good idea, Nicholas
objected to the fact that it meant that new stuff was being added
but no old stuff was being pruned away.</p>
<p>Other changes that Gabor wished to make involved adding more
examples to the documentation. Again, Nicholas wondered why people
wouldn't have the reflex to toss off a few one-liners to see how
things worked.</p>

<p>H.Merijn Brand suggested creating an examples directory. Gabor
liked the idea, but regretted that the usual installer tools
(<code>CPAN</code> and <code>CPANPLUS</code>) do not install the <code>eg/</code> directories,
making them all but invisible to mere mortals.</p>
<pre>
  Opening gambit
  <a href="http://xrl.us/o7qy">http://xrl.us/o7qy</a> </pre>
<p>Gabor then continued with examples for <code>index</code>/<code>rindex</code>. Given
that the debate about <code>open</code> was not resolved, this was not applied.</p>

<pre>
  <a href="http://xrl.us/o7qz">http://xrl.us/o7qz</a> </pre>
<p>He then added a brief discussion of <code>use strict</code> in <code>perlintro</code>
and replaced the use of <code>$a</code> and <code>$b</code> by some less-special
variables. H.Merijn liked it enough to apply it.</p>

<pre>
  <a href="http://xrl.us/o7q2">http://xrl.us/o7q2</a> </pre>
<p> <code>perlintro</code> also received another two batches of changes, here:</p>
<pre>
  <a href="http://xrl.us/o7q3">http://xrl.us/o7q3</a> </pre>
<p>and here:</p>
<pre>
  <a href="http://xrl.us/o7q4">http://xrl.us/o7q4</a> </pre>

<p>Gabor was briefly confused as to whether he should be patching
<code>blead</code> or <code>maint</code>. H.Merijn Brand and Yves Orton explained that
he should patch <code>blead</code>, and that the <code>maint</code> pumpking (currently
Nicholas Clark, but will be Dave Mitchell in the future) will backport
patches to <code>maint</code> as appropriate.</p>
<pre>
  <a href="http://xrl.us/o7q5">http://xrl.us/o7q5</a> </pre>

<p>So Gabor patched <code>perlhack</code> in order to point future porters to the
right thing to hack.</p>
<pre>
  X marks the spot
  <a href="http://xrl.us/o7q6">http://xrl.us/o7q6</a> </pre>
<p>Gabor then gave <em>perlopentut.pod</em> a work-over to begin recommending
the use of lexical file handles rather than typeglobs. H.Merijn
Brand had a number of issues with the proposed changes, and the
thread continued on for quite some time. People seemed to be in
agreement that some sort of improvement was needed, but the hard
question was what was truly essential for a tutorial, and in what
order to present it.</p>
<pre>
  Opening night
  <a href="http://xrl.us/o7q7">http://xrl.us/o7q7</a> </pre>

<p>After digesting the suggestions that everyone put forward, Gabor
produced a second cut. After an initial false start, Tom Christiansen
explained that from a tutorial perspective, omitting parentheses
and preferring <code>or</code> over <code>||</code> is incorrect. Having taught thousands
of people Perl, Tom has come to the conclusion that parens and
low-precedence <code>||</code> <em>helps</em> people come to grips with the language.
Omitting needless parentheses comes further up the curve of Perl
mastery.</p>
<pre>
  <a href="http://xrl.us/o7q8">http://xrl.us/o7q8</a> </pre>

<p>
<h2> <a name="on_the_correct_use_of_my_strlcpy">On the correct use of <code>my_strlcpy</code> </a> </h2>
<p>Steve Peters had tried to replace some uses of <code>strcpy</code>, (which
is deemed ``unsafe'' in that it can copy without limit), with the
safer <code>my_strlcpy</code>. Except that they don't return the same thing,
which caused Steve Hay's smoke machine to have a fit. The first
Steve was rather embarrassed and apologised.</p>
<p>On the plus side, this revealed a place where more tests are needed.</p>
<pre>
  Copy right
  <a href="http://xrl.us/o7q9">http://xrl.us/o7q9</a> </pre>

<p>
<h2> <a name="hash__util__fieldhash_versus_global_destruction"> <code>Hash::Util::FieldHash</code> <em>versus</em> global destruction</a> </h2>
<p>Joshua ben Jore wanted to know whether <code>Hash::Util::FieldHash</code>
makes inside-out objects safe in the face of object that defines a
<code>DESTROY</code> method. Anno Siegel explained that everything should be
fine during the normal course of events, but wasn't too sure whether
global destruction (what happens when the interpreter is being taken
down just before the perl process expires) changes the rules so
much that this no longer holds true.</p>
<p>Joshua spelt out some of the potential problem scenarios he envisaged,
and how best to deal with them. Anno thought that the proposed
work-arounds were all rather bletcherous, and promised to think
about it to see whether he could come up with a good solution.</p>

<p>The underlying problem is that inside-out objects reveal an aspect
of global destruction that was never apparent before, and if you're
really unlucky, it could bite your code.</p>
<pre>
  Unintended consequences
  <a href="http://xrl.us/o7ra">http://xrl.us/o7ra</a> </pre>
<p>
<h2> <a name="confusing_svcur_and_svlen_documentation">Confusing <code>SvCUR</code> and <code>SvLEN</code> documentation</a> </h2>

<p>Yves Orton read the documentation concerning these two functions
and had difficulty in reconciling it with what <code>Devel::Peek</code> was
telling him. Jan thought it made sense to him, and so he wondered
what it was that Yves didn't understand. There ensued a long
conversation between Jan and Yves that discussed the matter in
more detail.</p>
<p>Yves finally understood the issue, and suggested that Jan write
up some documentation to clarify the matter. Jan hoped that
someone else could summarise the issue instead (who, me?) and
Yves said that he would take a stab at it, and allow Jan to make
fun of it until it all made sense.</p>
<pre>
  String theory
  <a href="http://xrl.us/o7rb">http://xrl.us/o7rb</a> </pre>
<p>
<h2> <a name="cpan_contributor_feedback">CPAN contributor feedback</a> </h2>
<p>Responding to the itchy thread from last week, David Muir Sharnoff
explained that his number one gripe with the core was its less than
complete support for tied arrays, magic on tied variables, and the
lack of a <code>GETREF</code> method for ties. All of which would no doubt
make his life easier.</p>

<pre>
  Not to mention closing a bug or two
  <a href="http://xrl.us/o7rc">http://xrl.us/o7rc</a> </pre>
<p>
<h2> <a name="code_that_is_only_executed_once">Code that is only executed once</a> </h2>
<p>David Nicol proposed adding a 'once' statement modifier, that, after
having been executed, would then delve into the optree and excise
the statement out of the optree by rethreading the prior opcode to
the next opcode.</p>
<p>Rafael agreed that Perl 6 has a similar construct, but that there
were no plans to add it to 5.10. He was happy that <code>state</code> variables
resolved the ugly <code>my $x if 0</code> hack, and thought that <code>UNITCHECK</code>,
from the <code>perltodo</code> list was more worthy of burning up some tuits.</p>

<pre>
  COBOL has an ALTER verb, after all
  <a href="http://xrl.us/o7rd">http://xrl.us/o7rd</a> </pre>
<p>
<h2> <a name="removing_the_succeed_path_from_the_superlinear_cache_code">Removing the succeed path from the super-linear cache code</a> </h2>
<p>This is an optimisation in the regular expression engine that, as
far as Dave Mitchell can tell, is never exercised by the test suite,
and, try as he might, was unable to concoct any example that could.
So after talking things over with Hugo van der Sanden, he decided
to fire up the chain-saw.</p>
<p>So if your fancy patterns now starting taking longer than the
scheduled moment of the heat death of the universe, you know who
to blame. Hugo had hoped that some sort of instrumentation under a
debugging build might be added to the engine to allow the measurements
of different optimisation strategies. Dave wasn't planning to,
although he figured it would probably be doable, even if he didn't
know right now what shape or form it would take.</p>
<pre>
  Look for a patch tomorrow morning
  <a href="http://xrl.us/o7re">http://xrl.us/o7re</a> </pre>

<p>
<h2> <a name="comments_on_recent_api_changes_to_threads">Comments on recent API changes to <code>threads</code> </a> </h2>
<p>Artur Bergman, one of the original authors of the <code>threads</code> module,
discovered all the work that had been done recently, and objected
to the change that allowed <code>exit</code> to end a thread silently (and
not the entire process), saying that it blurred the distinction
between threads and processes.</p>
<p>He also spotted a section in the code that dealt with passing signals
to threads, noting that it was not thread-safe. Jerry wasn't sure
whether this was a true, and asked for a patch to help him understand
the situation.</p>
<p>Jerry D. Hedden regretted that some of the design decisions that
Artur mentioned, as a way of explaining why things were the way
they were, were not mentioned in the documentation.</p>

<p>Jan defended the design decision to allow a nested function to
terminate the thread, and not have to percolate the desire back up
the call stack to the main thread function.</p>
<p>Liz Mattijsen voiced the opinion that it was important for a thread
encountering some naughty library code, that contained evil <code>exit</code>
somewhere, to not be able to take out the whole application.</p>
<p>Artur explained that a technique already existed for dealing with
this situation.</p>
<pre>
  Picking up the thread
  <a href="http://xrl.us/o7rf">http://xrl.us/o7rf</a> </pre>
<p>
<h2> <a name="threads_signalling_issue">Threads signalling issue</a> </h2>

<p>Jerry D. Hedden was sufficiently worried by Artur's claim that the
signal dispatching code was not safe, that he broke the discussion
out into a separate thread. He stated that as far as he could see,
the code <em>was</em> thread-safe. Jan Dubois confirmed that he was certain
that it was fine, as well.</p>
<p>Artur described the problem he envisaged in more detail, which
allowed Jan to point out where the argument was flawed, since the
code already took the situation Artur outlined into account.</p>
<p>And so now Artur owes Jan a beer.</p>
<p>Nicholas Clark pointed out that even though the above code is
race-safe on a single-processor box, on an SMP machine it might be
possible to have a race, and he showed where it could happen. The
jury is still out on this matter.</p>
<pre>
  <a href="http://xrl.us/o7rg">http://xrl.us/o7rg</a> </pre>
<p>

<h2> <a name="storable_pm_has_poor_version_compatibility"> <code>Storable.pm</code> has poor version compatibility</a> </h2>
<p>Kari Pahula was shuffling binary images between two computers using
<code>RPC::PlServer</code> and <code>RPC::PlClient</code>, with <code>Storable</code> acting as a
serialising mechanism, and shipping the result over the wire.</p>
<p>Things started to fall apart when the two computers in question
were running different versions of <code>Storable</code> (The 2.6 receiver

<em>versus</em> the 2.7 sender), which rendered the received data essentially
worthless. Kari wished that <code>Storable</code> had a mechanism to specify
that version <code>N</code> should produce a data stream compatible with
version <code>N-x</code>, for some small value of <code>x</code>. That is, Kari would
quite happy to go back to his 2.7 server, and explicitly add a
<code>make this 2.6 compatible</code> flag, except that this is currently
not possible.</p>

<pre>
  <a href="http://xrl.us/o7rh">http://xrl.us/o7rh</a> </pre>
<p>
<hr>
<h1> <a name="patches_of_interest">Patches of Interest</a> </h1>
<p>
<h2> <a name="test_scripts_for_i18n__langinfo_and_posix">Test scripts for <code>I18N::Langinfo</code> and <code>POSIX</code> </a> </h2>

<p>Last week, S&#233;bastien Aperghis-Tramoni wrote some tests to
improve the coverage of these two modules. In doing so, he discovered
a couple of bugs: fields documented as existing, in fact, don't.
Steve Peters had problems with some of the test results, and
applied a partial patch. Craig Berry looked at some of the
skipped tests this week, and made a few more changes.</p>
<pre>
  <a href="http://xrl.us/o7ri">http://xrl.us/o7ri</a> </pre>
<p>Here are the changes, concerning missing POSIX functionality, that
Craig realised was being dealt with appropriately.</p>
<pre>
  <a href="http://xrl.us/o7rj">http://xrl.us/o7rj</a> </pre>
<p>S&#233;bastien came back later on with a way to improve
<code>POSIX::localeconv()</code>'s usefulness, by defining all keys in the
underlying hash, and making the undefined ones point to an empty
string. This would make the test suite easier to manage, and would
lead to less make-work code being required in client code.</p>
<pre>

  <a href="http://xrl.us/o7rk">http://xrl.us/o7rk</a> </pre>
<p>
<h2> <a name="perlhack__reflections_on_portability"> <code>perlhack</code>: reflections on portability</a> </h2>
<p>Jarkko Hietaniemi is undergoing therapy to recover from doing combat
for far too long with C compilers that conspire to make the perl
codebase such a fun place to hang out.</p>
<pre>
  The tao of portability
  <a href="http://xrl.us/o7rm">http://xrl.us/o7rm</a> </pre>
<p>And another batch of things to watch out for.</p>

<pre>
  <a href="http://xrl.us/o7rn">http://xrl.us/o7rn</a> </pre>
<p>
<h2> <a name="making_sense_of_the_z_os_patches">Making sense of the z/OS patches</a> </h2>
<p>Jarkko then started picking away at the z/OS patches that had
recently been sent to the list from IBM, to see what he could
salvage. First up was some low-hanging fruit in the shape of
<em>hints/os390.sh</em> and <code>Makefile.SH</code>.</p>
<pre>
  <a href="http://xrl.us/o7ro">http://xrl.us/o7ro</a> </pre>

<p>And then a number of EBCDIC fixes in the test suite.</p>
<pre>
  <a href="http://xrl.us/o7rp">http://xrl.us/o7rp</a> </pre>
<p>He carried on with some more library files and test. Stephen McCamant
wondered whether there wasn't an elegant way to factorise the
EBCDIC/ASCII differences so that less code wound up being duplicated.</p>
<pre>
  <a href="http://xrl.us/o7rq">http://xrl.us/o7rq</a> </pre>
<p>And something to do with <code>main</code> that H.Merijn was unable to apply,
despite his best intentions.</p>

<pre>
  <a href="http://xrl.us/o7rr">http://xrl.us/o7rr</a> </pre>
<p>Taking that, and Stephen's, remarks into account, Jarkko brewed a
fresh patch.</p>
<pre>
  <a href="http://xrl.us/o7rs">http://xrl.us/o7rs</a> </pre>
<p>At the end of the week, Jarkko was able to tease out a fix for
<code>MIME::Base64</code>'s <code>quoted-print.t</code> test. He wasn't precisely sure
how EBCDIC and <code>quoted-printable</code> are supposed to work together
at the best of times, but sent the patch on its way.</p>

<pre>
  =E8=96=A4@=94=81=A8@=98=A4=96=A3=85@=94=85@=96=95@=A3=88=81=A3=
  <a href="http://xrl.us/o7rt">http://xrl.us/o7rt</a> </pre>
<p>
<h2> <a name="various_additions_to_cflags_sh_and_sundry_files">Various additions to <em>cflags.SH</em> and sundry files</a> </h2>
<p>Jarkko discovered with delight that recent versions of <code>gcc</code> have a
<code>-std</code> to specify to which C standard the source code should be held
against. So he taught <em>cflags.SH</em> to specify that C89 is the only
game in town.</p>

<pre>
  // is not a comment
  <a href="http://xrl.us/o7ru">http://xrl.us/o7ru</a> </pre>
<p>And in the interest of perfection, Jarkko also ensured that a number of
recent additions to the code base were cited in <em>cflags.SH</em>.</p>
<pre>
  <a href="http://xrl.us/o7rv">http://xrl.us/o7rv</a> </pre>
<p>In a grab-bag of assorted fixes, Jarkko patched <em>dump.c</em>, <em>pp_sys.c</em>,

<em>sv.c</em> and <em>util.c</em> and snuck in a few more additions to <code>perlhack</code>.</p>
<pre>
  <a href="http://xrl.us/o7rw">http://xrl.us/o7rw</a> </pre>
<p>In a last glorious attack on <code>perlhack</code>, Jarkko wrote about the
<code>Configure -Dgccansipedantic</code> switch, that forces the <code>gcc</code> compiler
to become extremely fussy about what it considers acceptable
practices in code.</p>

<pre>
  Squeaky clean
  <a href="http://xrl.us/o7rx">http://xrl.us/o7rx</a> </pre>
<p>
<h2> <a name="updated_escapes_and_debug_output_improvements">Updated escapes and debug output improvements</a> </h2>
<p>Yves Orton landed a fairly hefty patch of tweakery, in part to
improve the escaping code, making it Unicode aware. The second part
was to clean up the way debugging output is displayed by the regexp
engine. The latter work was not yet complete, but Yves felt it was
time to commit.</p>
<p>Dave Mitchell applied the changes, and noted a number of compiler
warnings about <code>char *</code>/<code>U8</code> differences, and mentioned that the
debug output is currently a bit of mess, and the direction in which
he wished to push it.</p>

<p>Yves explained what he was tinkering with at the moment, and asked
for guidance on dealing with the variables used in the code. He
thought that the de-recursion work that Dave had put into the engine
offered a suitable place for squirrelling away new variables, and
thought that the current way of dealing with variables was weird.</p>
<p>Dave Mitchell explained that the current state of affairs can be
traced back to the heritage of Henry Spencer's original regular
expression library, twisted beyond belief to work in a multi-interpreter,
multi-threaded environment.</p>
<pre>
  *sounds of hammers, saws and arc-welders in the basement*
  <a href="http://xrl.us/o7ry">http://xrl.us/o7ry</a> </pre>
<p>Yves fixed up a number of warnings that the new code issued, in a
subsequent patch.</p>
<pre>
  <a href="http://xrl.us/o7rz">http://xrl.us/o7rz</a> </pre>
<p>

<hr>
<h1> <a name="watching_the_smoke_signals">Watching the smoke signals</a> </h1>
<p>
<h2> <a name="smoke__5_9_4__28549_fail_f__linux_2_6_129powerpc__debian___ppc_1_cpu_">Smoke [5.9.4] 28549 <code>FAIL(F)</code> linux 2.6.12-9-powerpc [debian] (ppc/1 cpu)</a> </h2>
<p>This failure, Rafael Garcia-Suarez believed, was due to the recent
work performed on <em>dump.c</em> whose aim was to improve the output by
escaping ``invisible'' characters. Yves promised to take a look (which
happened just above).</p>
<pre>
  <a href="http://xrl.us/o7r2">http://xrl.us/o7r2</a> </pre>

<p>
<hr>
<h1> <a name="new_and_old_bugs_from_rt">New and old bugs from RT</a> </h1>
<p>
<h2> <a name="5_7_2_and_perlpod__text__overstrike___7959_">5.7.2 and <code>perlPod::Text::Overstrike</code> (#7959)</a> </h2>
<p>Whatever the problem was, at some point in the past four years,
Steve Peters discovered that it had been fixed.</p>
<pre>
  Counterstrike
  <a href="http://xrl.us/o7r3">http://xrl.us/o7r3</a> </pre>

<p>
<h2> <a name="localtime_3__calls_tzset_3___but_localtime_r_3__may_not____26136_"> <code>localtime(3)</code> calls <code>tzset(3)</code>, but <code>localtime_r(3)</code> may not. (#26136)</a> </h2>
<p>Jason Vas Dias posted an patch to fix a bug for Perl on Fedora,
following on from a revival of the patch by Benjamin Holzman.
Benjamin followed up on Jason's work and tweaked the patch to make
it suitable for both <code>maint</code> and <code>blead</code>.</p>

<pre>
  It's about time
  <a href="http://xrl.us/o7r4">http://xrl.us/o7r4</a> </pre>
<p>
<h2> <a name="definedness_of_substrings_disappear_over_repeated_calls___39247_"> <code>defined</code>-ness of substrings disappear over repeated calls (#39247)</a> </h2>
<p>A few words of wisdom from Yitzchak Scott-Thoennes on the matter
of XS code dealing with magic.</p>
<pre>
  <a href="http://xrl.us/o7r5">http://xrl.us/o7r5</a> </pre>
<p>
<h2> <a name="bug_in_system_calls_when__env_is_very_large___39547_">Bug in system calls when <code>%ENV</code> is very large (#39547)</a> </h2>
<p>Steve Hay traced this problem down to the way perl gets compiled
on the Win32 platform and thought that as things stand, the restriction
appears to be an intrinsic limitation of the platform, and doubted
it could be solved.</p>
<p>Randy W. Sims forwarded the message to Microsoft, who confirmed
that the environment block for a process is indeed limited to just
shy of 32 kilobytes.</p>
<pre>
  Their bug, not ours
  <a href="http://xrl.us/o7r6">http://xrl.us/o7r6</a> </pre>
<p>

<h2> <a name="gcc_3_3_has_problems_with___attribute____unused_____39634_">gcc 3.3 has problems with <code>__attribute__((unused))</code> (#39634)</a> </h2>
<p>Andy Dougherty tweaked the setting of the <code>HAS_ATTRIBUTE</code> define in
a way that he felt was the clearest to understand. Rafael applied it.</p>
<pre>
  <a href="http://xrl.us/o7r7">http://xrl.us/o7r7</a> </pre>
<p>
<h2> <a name="filetest_problem_with_stdin_out_on_windows___39637_">filetest problem with STDIN/OUT on Windows (#39637)</a> </h2>

<p>Steve Hay wrote some more C code to analyse this problem and found
that indeed, the <code>-r</code> operator returns false for <code>STDIN</code>. Trying
it out with various C compilers led him to conclude that this is
also some sort of Win32 limitation. Steve and Yves kicked around a
few ideas, but at the end of the week it looks like it will wind up
documented in <code>perlport</code> as something that doesn't work.</p>
<pre>
  The tailor's face and hands
  <a href="http://xrl.us/o7r8">http://xrl.us/o7r8</a> </pre>
<p>

<h2> <a name="s_regmatch_produces_a_stack_overflow___39774_"> <code>S_regmatch</code> produces a stack overflow (#39774)</a> </h2>
<p>A pattern that results in a stack overflow was reported. Steve Peters
explained that in <code>blead</code>, the overflow no longer exists, although an
error message described another sort of exhaustion is emitted instead.</p>
<p>Yves Orton explained how the pattern was one of the sort that tend to
give NFAs such as perl's regexp engine fits, as it forces backtracking
information to be stashed away at every single point in the string. He
went on to show how the pattern could be rewritten in a much more
efficient manner.</p>
<p>He then expressed hope that some day, the optimiser might be able to
compose the transform all by itself, but reasoned that it might be
difficult.</p>
<pre>
  When he says it's not easy
  <a href="http://xrl.us/o7r9">http://xrl.us/o7r9</a> </pre>

<p>
<h2> <a name="cygwin_perl_bug__pod2usage_verbose____0__and_pod2usage_verbose____1____39775_">Cygwin Perl bug -- <code>pod2usage(-verbose =&gt; 0)</code> and <code>pod2usage(-verbose =&gt; 1)</code> (#39775)</a> </h2>
<p>David Christensen wanted to know what the status was on a patch that fixes
a problem with <code>pod2usage</code>.</p>

<pre>
  <a href="http://xrl.us/o7sa">http://xrl.us/o7sa</a> </pre>
<p>
<h2> <a name="switch_module_bug___39789_"> <code>Switch</code> module bug (#39789)</a> </h2>
<p>Artyom Tseitlin, poor chap, was bitten by too-clever-by-half magic
of <code>Text::Balanced</code> (upon which <code>Switch</code> relies). Adriano Ferreira
posted a semi-evil hack that would allow Artyom to continue to use

<code>Switch</code>.</p>
<pre>
  Divide and conquer
  <a href="http://xrl.us/o7sb">http://xrl.us/o7sb</a> </pre>
<p>
<h2> <a name="unable_to_build_perl_under_irix_with_duseshrplib___39797_">Unable to build Perl under Irix with <code>-Duseshrplib</code> (#39797)</a> </h2>
<p>Philippe Schaffnit was going mad trying to discover what his mistake
was in trying to build Perl on Irix. (no, <em>using Irix</em> is not an
acceptable answer). The problem sounded familiar to Andy Dougherty,
who suggested an approach to narrow things down. At the end of the
week we still had not heard back from Philippe.</p>

<pre>
  <a href="http://xrl.us/o7sc">http://xrl.us/o7sc</a> </pre>
<p>
<h2> <a name="mortality_of_objects__e_g_______passed_as_args___39800_">Mortality of objects (<em>e.g.</em> <code>%$_</code>) passed as args (#39800)</a> </h2>
<p>Vaclav Ovsik ran afoul of the absence of refcounting to <code>@_</code> and the
perl stack.</p>

<pre>
  Don't do that then
  <a href="http://xrl.us/o7sd">http://xrl.us/o7sd</a> </pre>
<p>
<h2> <a name="bleadperl_dm_e1_segfaults_on_win32___39806_"> <code>bleadperl -Dm -e1</code> segfaults on win32 (#39806)</a> </h2>
<p>Rafael made an educated guess that a thread was trying
to print something using a data structure that had already been freed...</p>
<pre>
  <a href="http://xrl.us/o7se">http://xrl.us/o7se</a> </pre>

<p>
<h2> <a name="eval_and_hash_access_in_subroutine___39816_"> <code>eval</code> and hash access in subroutine (#39816)</a> </h2>
<p>Thomas Ziehmer composed a clever little ditty that shows how he was
forced to make a bogus <code>%hash = %hash</code> assignment to make things
work correctly. I shall have commented on this next week, since
nobody did this week.</p>
<pre>
  Which was last week, anyway
  <a href="http://xrl.us/o7sf">http://xrl.us/o7sf</a> </pre>
<p>
<h2> <a name="perl5shell_is_not_checked_for_tainted_data___39832_"> <code>PERL5SHELL</code> is not checked for tainted data (#39832)</a> </h2>
<p>Paul Fenwick showed how an evil hacker could make Perl inadvertently
launch Notepad through a <code>system</code> call, even in taint mode, since
<code>PERL5SHELL</code> is not subject to the usual tainting strictures.</p>
<p>Rafael took a stab at closing the hole, and asked for someone with
access to a Windows machine to validate the fix. Yves confirmed that
the problem was indeed resolved. Dr. Ruud suggested applying
similar checks upon <code>$ENV{SystemRoot}</code> and <code>$ENV{windir}</code>.</p>

<p>Rafael wanted to know what purpose those two variables served.</p>
<pre>
  Could have been worse
  <a href="http://xrl.us/o7sg">http://xrl.us/o7sg</a> </pre>
<p>
<h2> <a name="update_perlipc_pod_tcp_server_example_with_respect_to_safe_signals_and_accept_____39835_">Update <em>perlipc.pod</em> TCP server example with respect to safe signals and <code>accept()</code> (#39835)</a> </h2>

<p>Andy Wardley discovered that the introduction of Safe Signals, from
5.7.3 onwards had rendered the TCP server examples in <code>perlipc</code>
obsolete. So he updated the POD, in the hope that some kind soul
would apply it to <code>blead</code> (and even <code>maint</code>) so that others may
avoid running into the same problem.</p>
<pre>
  <a href="http://xrl.us/o7sh">http://xrl.us/o7sh</a> </pre>
<p>
<h2> <a name="script_with_threads_hang_when_there_are_nested_subthreads___39839_">Script with threads hang when there are nested subthreads (#39839)</a> </h2>

<p>Erland Sommarskog discovered that nested threads don't.</p>
<pre>
  <a href="http://xrl.us/o7si">http://xrl.us/o7si</a> </pre>
<p>Rafael Garcia-Suarez noticed that a <strong> <code>Data::Bind</code> compilation failure</strong>
could be fixed by diddling with how <code>Carp</code> was used, and therefore
wondered if something hadn't been broken somewhere. The symptoms reminded
David Landgren that he had encountered similar problems testing modules
under <code>blead</code>.</p>

<pre>
  <a href="http://xrl.us/o7sj">http://xrl.us/o7sj</a> </pre>
<p>
<h2> <a name="perl5_bug_summary">Perl5 Bug Summary</a> </h2>
<p>An internal server error prevented the bug summary from being posted this
week, but I assume we are somewhere around 1500.</p>
<pre>
  Check 'em out
  <a href="http://rt.perl.org/rt3/NoAuth/perl5/Overview.html">http://rt.perl.org/rt3/NoAuth/perl5/Overview.html</a> </pre>
<p>

<hr>
<h1> <a name="new_core_modules">New Core Modules</a> </h1>
<ul>
<li>
<p> <code>Term::ANSIColor</code> version 1.11 released by Russ Allbery. Essentially a
documentation and test suite enhancements release.</p>
<pre>
  <a href="http://xrl.us/o7sk">http://xrl.us/o7sk</a> </pre>
</li>
<li>
<p> <code>Test::Builder/More/Simple</code> version 0.64 was rushed to the delivery
room in an emergency by Michael Schwern. A change in 0.63 to

<code>test_fail()</code> broke <code>Test::Exception</code> (and possibly many more
modules as well).</p>
<pre>
  Author and module are in good health
  <a href="http://xrl.us/o7sm">http://xrl.us/o7sm</a> </pre>
</li>
</ul>
<p>
<hr>

<h1> <a name="in_brief">In Brief</a> </h1>
<p>Marcus Holland-Moritz commented on the <strong> <code>state</code> variables progress</strong>,
saying that if the making iffy constructs results in a slowdown in the
general case, then those constructs should simply be outlawed as errors.</p>
<pre>
  But the slowdown is only wafer thin
  <a href="http://xrl.us/o7sn">http://xrl.us/o7sn</a> </pre>
<p>David Nicol suggested that <code>INIT</code> blocks could be used to initialise

<code>state</code> variables, and proposed a suitable error message to be used
when indicating that a state variable was not going to be initialised
as expected.</p>
<pre>
  <a href="http://xrl.us/o7so">http://xrl.us/o7so</a> </pre>
<p>Ron Savage followed up on the followup from Jan Dubois regarding
Oracle on ActiveState, noting that he was <strong>able to install
<code>DBD::Oracle</code> </strong>, but unable to do anything with it. Jan suggested
a few things to try out, and outlined what ActiveState would have
to do to get it to work in all cases.</p>
<pre>
  <a href="http://xrl.us/o7sp">http://xrl.us/o7sp</a> </pre>

<p>Steve Hay noted that a recent version of <strong> <code>ext/threads</code> doesn't
build with Borland</strong> on Win32, due to differences in header files.
Jerry D. Hedden found an appropriate <code>#define</code> upon which to hang
the missing definitions.</p>
<pre>
  <a href="http://xrl.us/o7sq">http://xrl.us/o7sq</a> </pre>
<p>And Jerry delivered the patch, applied by Rafael.</p>
<pre>

  <a href="http://xrl.us/o7sr">http://xrl.us/o7sr</a> </pre>
<p>He then bumped up the version with a fix to stop <strong>signalling terminated threads
from dumping core</strong>.</p>
<pre>
  <a href="http://xrl.us/o7ss">http://xrl.us/o7ss</a> </pre>
<p>Dr. Ruud wondered whether it was worth chasing down <strong> <code>0</code> and replacing
it with <code>NULL</code> </strong>, in <em>pp.c</em> to begin with.</p>

<pre>
  <a href="http://xrl.us/o7st">http://xrl.us/o7st</a> </pre>
<p> <strong>statefulness is a property of the code, not the variable</strong>, sayeth Dave
Mitchell.</p>
<pre>
  <a href="http://xrl.us/o7su">http://xrl.us/o7su</a> </pre>
<p>Steve Hay encountered a <strong>strange problem with <em>perly.h</em> on Win32</strong>, that he
traced tentatively back to the switch-over from <code>byacc</code> to <code>bison</code>. A tweak
to <em>regen_perly.pl</em> fixed the problem. So Steve applied the fix, but regretted
not being able to understand why the error was occurring.</p>

<pre>
  Action and reaction
  <a href="http://xrl.us/o7sv">http://xrl.us/o7sv</a> </pre>
<p>Jarkko tweaked <strong> <em>hv.c</em> and <em>sv.c</em> for <code>-DPERL_GLOBAL_STRUCT_PRIVATE</code> </strong> and
expressed disgust at the very existence of a global variable named
<code>done_sanity_check</code>. After having stepped back to look at his handiwork, he
realised that recent work to bring <em>DynaLoader.o</em> into <code>libperl</code> has
rendered the Symbian port of Perl unusable.</p>

<pre>
  <a href="http://xrl.us/o7sw">http://xrl.us/o7sw</a> </pre>
<p>Steve Hay discovered that <strong> <code>mod_perl</code> 1.x and <code>apache</code> 1.x do not like
<code>blead</code> </strong>, possibly due to the way constants have been rejigged.</p>
<pre>
  <a href="http://xrl.us/o7sx">http://xrl.us/o7sx</a> </pre>

<p>Sadahiro Tomoyuki produced a patch to <strong>update comments in
<code>scan_const</code> </strong>, since much of it remains as it did at change #780
in the repository, which, if the records are correct, is roughly
about the same time that the porters stopped using punched cards.</p>
<pre>
  <a href="http://xrl.us/o7sy">http://xrl.us/o7sy</a> </pre>
<p>He also edited <code>perlop</code> to clarify the <strong>parsing of quoted constructs</strong>,
so that people could apply some scientific method rather than just
guessing to see how things behaved.</p>
<pre>

  <a href="http://xrl.us/o7sz">http://xrl.us/o7sz</a> </pre>
<p>Yves Orton <strong>silenced a <code>system</code> warning during tests</strong>, although
was only able to do so for Win32, although he thought that it
should be possible to tweak it to work in a cross-platform manner.</p>
<pre>
  <a href="http://xrl.us/o7s3">http://xrl.us/o7s3</a> </pre>
<p>
<h2> <a name="about_this_summary">About this summary</a> </h2>

<p>This summary was written by David Landgren.</p>
<p>Last week's summary, here:</p>
<pre>
  <a href="http://xrl.us/o7s4">http://xrl.us/o7s4</a> </pre>
<p>elicited a response from H.Merijn who was concerned with some
smoke tests throwing out black smoke that was not reproducible
with a test run by hand.</p>
<p>Yves Orton also mentioned that he had a documentation patch for the
heredoc/escaping muddle that was in limbo, and was wondering whether
it needed improvement or was just pushed down on the stack of things
to apply.</p>
<p>If you want a bookmarklet approach to viewing bugs and change
reports, there are a couple of bookmarklets that you might find
useful on my page of Perl stuff:</p>
<pre>
  <a href="http://www.landgren.net/perl/">http://www.landgren.net/perl/</a> </pre>

<p>Weekly summaries are published on <em> <a href="http://use.perl.org/">http://use.perl.org/</a> </em> and posted
on a mailing list, (subscription: <em> <a href="mailto:perl5-summary-subscribe@perl.org">perl5-summary-subscribe@perl.org</a> </em>).
The archive is at <em> <a href="http://dev.perl.org/perl5/list-summaries/">http://dev.perl.org/perl5/list-summaries/</a> </em>.
Corrections and comments are welcome.</p>
<p>If you found this summary useful, please consider contributing to
the Perl Foundation to help support the development of Perl.</p></p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

