<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org story by pudge: Petal, Perl Implementation of Zope's TAL</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Petal, Perl Implementation of Zope's TAL</h1>
<h2><a href="/user/pudge/">pudge</a> on 2002-10-14T20:20:16</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><a href="http://webmatrix.net/">Jean-Michel Hiver</a> writes <i>"These guys from Zope have really interesting ideas.  Among then is a really cool spec called <a href="http://www.zope.org/Wikis/DevSite/Projects/ZPT/TAL">TAL</a> that lets them build WYSIWYG-friendly template by just using HTML attributes rather than having special extra tags.  Petal is an attempt to reproduce TAL functionality in Perl and also to take it further by enhancing its syntax and XML processing capabilites. Check out the <a href="http://search.cpan.org/author/JHIVER/Petal-0.74/lib/Petal.pm">documentation</a> and <a href="http://lists.webarch.co.uk/mailman/listinfo/petal">mailing list</a>."</i></p>
<p></p>


<hr/>



<h2>Another templating system?</h2>
<h3><a href="/user/acme/">acme</a> on 2002-10-15T08:52:59</h3>
Hmmm, I appear to be having this rant quite a lot recently. Anyway, here we go:
<p>
Everyone seems to write their own template system with slightly
different syntax / features and then upload it to the CPAN. Far be it
from me to dissuade you doing the same.
</p><p>
Have you read <a href="http://www.perl.com/pub/a/2001/08/21/templating.html" title="perl.com">Choosing a Templating System</a perl.com>?
</p><p>
What does TAL provide that, say the
Template Toolkit or AxKit does not? Wouldn't it be better to rely on a module
that has had years of testing, complete documentation, an active
support group and many users than roll your own? Surely patching an existing module is a much better use of your resources than maintaining a new one?
</p><p>
Grumpy old Leon.
</p><p>
PS "Compatibility" is a good answer, but not if your fork off from the TAL spec later on.
</p><p>
PPS <i>And don't get me started on those Acme:: modules...</i></p>



<blockquote>

<h2>Re:Another templating system?</h2>
<h3><a href="/user/TeeJay/">TeeJay</a> on 2002-10-15T09:03:37</h3>
I think this templating system is well justified because it would allow Zope and Python users to migrate to perl.
<p>
More importantly it means that Zope-Compatible or Competitive CMS can be written in perl.
</p><p>
One of the great things about Open Source is the level of competition and also the way in which many components are fairly easy to interchange.
</p><p>



<blockquote>

<h2>Re:Another templating system?</h2>
<h3><a href="/user/ignatz/">ignatz</a> on 2002-10-15T16:36:21</h3>
I think that it is important to note that Zope-Tal/Petal interopability is not a goal of the Petal project. I asked about Zope-Tal/Petal interopability on the Petal mailing list. Here's Mr. Hiver's response:<br> <blockquote><div>&gt;&gt; Is keeping things in sync between Tal and Petal a goal of the project?<br> <br>No it isn't. The goal of the project is to make a useful library to template any kind of XML and XHTML. The TAL spec was a good place to start, it has plenty of really good ideas.<br> <br>Now I had my own good ideas as well that I needed to integrate in this library<nobr> <wbr></nobr>:-)<br> <br>However, wherever I can, I try to make the library as TAL-compliant as I<br>can because it's good practice.<br> <br>&gt; What problems would there be in having language neutral templates?<br> <br>Unfortunately TAL is not that neutral, it's been designed for Zope. I you limit yourself to the intersection of features between TAL and Petal, you could very well write templates that run on both engines, but you'll loose functionality for either side. </div></blockquote> <br>A grand unification between Zope and Perl does seem interesting, but I wonder how realistic this is.





</blockquote>


<h2>Re:Another templating system?</h2>
<h3><a href="/user/Dom2/">Dom2</a> on 2002-10-15T12:36:43</h3>
It's different to all the others because it doesn't interfere with XML/SGML validitity and well formedness.  That's enough to make me very interested in it.

<p>-Dom</p>



<h2>Re:Another templating system?</h2>
<h3><a href="/user/jhiver/">jhiver</a> on 2002-10-15T15:32:12</h3>
<p>Actually, yes I _DID_ read Perrin Harkins' <a href="http://www.perl.com/pub/a/2001/08/21/templating.html" title="perl.com">Choosing a Templating System</a perl.com> article and none of the templating systems listed here offer the same functionality as Petal.</p>

<p>I have sent an email to Perrin Harkins and here is an extract of his reply:</p>

<p> <em>Because there are so many template tools (literally dozens) and most of them have very few distinguishing features, I try to limit the number of tools described in detail in my document.In general, I have only
talked about the most widely used ones, and just listed the other interesting ones briefly.  <strong>However, Petal has a special appeal for
people who want to use standard HTML for their templates (the "TAL" syntax), and the module I currently list for that is not well supported
anymore, so I was planning to list Petal there.</strong> </em> </p>


<p>That should answer your question. It is my feeling that Petal *DOES* fill in a niche in the Perl templating world.</p>



<blockquote>

<h2>Re:Another templating system?</h2>
<h3><a href="/user/acme/">acme</a> on 2002-10-15T15:51:54</h3>
OK. That's fine then<nobr> <wbr></nobr>;-)





</blockquote>

</blockquote>


<h2>Nice, but...</h2>
<h3><a href="/user/barries/">barries</a> on 2002-10-15T09:44:56</h3>
<p>Nice twist on the old templating system scheme.  Not sure CPAN needed YATS, but hey, it's a commons, post bills where you may.

</p><p>A few issues you might consider:

</p><ol>

<li>Getting rid of those globals, otherwise a modules using petal are likely to screw up other modules using it.  Take a good look at how TT2 and HTML::Template's APIs work.  Yes, local $Petal::foo can work; no, not enough people know (or are likely to remember to use) <code>local()</code>.</li>

<li>Be a polite user of the CPAN commons.  try to find a top level namespace that petal can fit under, like Text:: or HTML:: or XML::.  In retrospect, there should be a TLNS of Template:: for everyone to put their efforts in.  Oh, wait, that's been taken.</li>

</ol>

<p>You might want to warn about esaping issues in PIs, since the fake attribute in
may not parse right if you stick a &quot; in the
same string as the "b".  This may not be an issue
in your instance, but you might want to think about it.  How (well?) does this interoperate with XML namespaces?

- Barrie</p>



<blockquote>

<h2>Re:Nice, but...</h2>
<h3><a href="/user/snowball/">snowball</a> on 2002-10-15T15:30:39</h3>
<blockquote><div> <p> <em>How (well?) does this interoperate with XML namespaces?</em> </p> </div></blockquote>
<p>This is near the top of Jean-Michels TODO list and it will get fixed.</p>
<p>I also want to see <a href="http://lists.webarch.co.uk/pipermail/petal/2002-August/000085.html" title="webarch.co.uk">support
 for Xincludes</a webarch.co.uk>.</p>



<h2>Re:Nice, but...</h2>
<h3><a href="/user/jhiver/">jhiver</a> on 2002-10-15T16:14:24</h3>
<p>Globals. As for getting rid of the globals, why not, but I'm pretty sure that I have made it so that it is not likely to be screwed by other modules... I have also spent a great deal of time making sure that Petal leaks no memory for persistent environments a la mod_perl. In other words, I'm not sure about what you mean. Can you give a better explanation?</p>

<p>As for CPAN namespace, there was a bit of a fight on the modules list about it. Basically the suggested name was Template::Petal. I think that  generic names like 'Template' or 'CGI' which are attributed to specific modules are a terrible mistake.</p>

<p>If the Template Toolkit was in the 'Template::Toolkit' namespace, I would have no problem renaming 'Petal' to 'Template::Petal'.</p>

<p>However that's not the case. If I renamed Petal to 'Template::Petal' it would merely sound like some kind of plugin for the Template Toolkit, and because of the 3rd virtue I cannot do that<nobr> <wbr></nobr>:-)</p>

<p>I don't really understand your comment about processing instructions. Would you be so kind as to give an example, so that I can check that Petal has the proper behavior.</p>



<blockquote>

<h2>Re:Globals</h2>
<h3><a href="/user/barries/">barries</a> on 2002-10-15T17:44:31</h3>
<p>Consider an app that wants two petal processors; how do you allow that app to configure them differently?  Right now, the user has to be a bit savvy and write a wrapper sub, preferably using local() to set each of the $Petal::foo settings the way they want.  By allowing</p>

<blockquote><div> <code>
   my $p = Petal-&gt;new( %options );
</code> </div></blockquote>

<p>You offer the service of encapsulation in addition to the service of handling templates.  Now maybe Petal does that under the hood, but the docs say that you have to set some options as globals and others (file =&gt; ) passing in to new().  Petal currently thinks of an instance as being one file; I'm suggesting that one instance is more powerfully thought of as one processor which can process multiple files.  That way the settings for a processor can be persistent across requests and files, but the files are transient.

</p><p>In my experience, larger systems benefit from the instance-as-processor approach being primary instead of only offering the instance-as-file approach

</p><p>- Barrie</p>



<h2>Re: PIs &amp;amp; quoting</h2>
<h3><a href="/user/barries/">barries</a> on 2002-10-15T17:54:34</h3>
<p>Here's what</p>

<blockquote><div> <code>
&lt;?foo a=<b>"b&amp;quot;"</b>?&gt;<br>
<br>
&lt;snork/&gt;
</code> </div></blockquote>

looks like to an XML parser (much snippage):

<blockquote><div> <code>
$ perl -d:TraceSAX -e 'use XML::SAX::PurePerl; XML::SAX::PurePerl-&gt;new-&gt;parse_uri( "foo.xml" )' <br><nobr> <wbr></nobr>...  start_document( {} )<br><nobr> <wbr></nobr>... processing_instruction: &lt;?foo a=<b>&quot;b&quot;&quot;</b>?&gt; <br><nobr> <wbr></nobr>... start_element: &lt;snork&gt; <br><nobr> <wbr></nobr>... end_element: &lt;/snork&gt; <br><nobr> <wbr></nobr>... end_document( {} )<br>
</code> </div></blockquote>

<p>Note that there is no differentiation between
<code>&amp;quot;</code> and <code>"</code> in the parsed output; this pretend attribute syntax can lead people in to thinking that they can put &amp;quote; in these attributes.  This may or may not be a problem with Petal; if it only ever allows/needs non-escaped things in these pretend attributes, it's not.

</p><p>- Barrie</p>





</blockquote>

</blockquote>


<h2>Yes, finally another templating system</h2>
<h3><a href="/user/knowmad/">knowmad</a> on 2002-10-15T14:42:43</h3>
<p>I, too, used to think like Grumpy old Leon. I've used lots of templating libraries and often wished for a better solution but kept being disappointed with the latest template library released to CPAN. Petal is a different beast than the typical search-and-replace library.</p>

<p>The template attribute language (TAL) is a great solution for mini-language templates (see Perrin's <a href="http://www.perl.com/pub/a/2001/08/21/templating.html" title="perl.com">Choosing a Template Language</a perl.com>), and Jean-Michel has done an admirable job of creating a module that implements this functionality in Perl. It plays nicely with the GUI editors which my designers like to subject my templates to, it doesn't generate too many errors when scanned with HTML Tidy, and my templates look cleaner than when using custom html tags.</p>

<p>BTW, Perrin has told Jean-Michel that he plans to cover Petal in his next update of that article. Furthermore, if you use TT2, HTML::Template or Text::Template and pass a hash reference to these templates, it's relatively easy to convert your existing templates to Petal without many changes to your existing Perl code.</p>

<p>Try it! Like me, you might find it's going to become a best of breed solution for implementing HTML/XML templates.</p>

William



<h2>Sold</h2>
<h3><a href="/user/ignatz/">ignatz</a> on 2002-10-15T16:51:55</h3>
I've been playing with Petal for about three weeks now and I must confess that I'm sold. It was a bit of a mental leap for me having been working with standard templating systems for a long time, but once I read up on the whole TAL concept I could see the advantage.<br> <br>It's really nice for generating static web sites. The fact that it isn't joined at the hip with mod_perl gives it a nice low threshold for developers who want to use it.



<h2>original ideas</h2>
<h3><a href="/user/davegaramond/">davegaramond</a> on 2002-10-24T13:53:52</h3>
the store-variables-in-attribute templating thingie actually originated from the Enhydra guys (the Java camp). come to think of it, Zope is certainly not the first "object publishing" product in the market.

<p>this is not by any means to dismiss Zope, just that the ideas are not novel.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

