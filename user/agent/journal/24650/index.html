<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of agent: Guessing Password and Developing Thief 0.03</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Guessing Password and Developing Thief 0.03</h1>
<h2><a href="/user/agent/">agent</a> on 2005-05-12T09:45:49</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>=from 2005.5.11.10:00.PM
=to ...5.12.8:10.AM<br/><br/>I'm sorry for the lack of summaries these days. In the first few days of this month, I focused on the development of Thief 0.03.<br/><br/>At the very beginning, I found that thief.pl couldn't log in the <a href="http://jwcweb.ujs.edu.cn/">Educational Administration System (EAS)</a> even using my own account. However, I could always do this in a web browser, such as IE. Later I utilized the <a href="http://www.mozilla.org/products/">Mozilla</a> extension <a href="http://livehttpheaders.mozdev.org/">"Live HTTP Headers"</a> to intercept the HTTP requests sent by the Mozilla or Firefox browser locating a missing HTTP attribute named "Referrer" in my perl script, whose value is a URL. I wondered why this peculiar attribute was necessary for login and subsequent page requests in the EAS site. I asked Laye about it, but there was no reply.<br/><br/>I must thank Laye for his implication in one of his e-mails that there was some wonderful tool which could record down the low-level actions performed by the browser. I found "Live HTTP Headers" on the Internet by myself and solved my problem immediately. However, what he actually used was another independent tool named <a href="http://www.effetech.com/sniffer/">EffeTech HTTP Sniffer</a>, which did not rely on any specific browser and had the ability to keep record of all the HTTP requests and responses taking place over the Windows OS. All I could say was "Wow". It was very kind of him to offer me a serial number for this shareware after he learned that I loved this tool so much.<br/><br/>Yeah, just as what I said in a mail to Laye, HTTP Sniffer is the very tool that we perl hackers are dreaming of every night! The cost of developing a client-side web application will decrease significantly in virtue of the precise GET or POST headers intercepted by this application. For example, in a project I recently developed for <a href="http://www.jmsoft.cn/">the JMSoft Company</a>, I was asked to develop a fully automated tester for a web-based <a href="http://www.jmsoft.cn/products/oa.asp">JMOA system</a>. If I knew HTTP Sniffer at that time, it would be a trivial task to implement such things.<br/><br/>Having successfully passed the login stage of the EAS site, I tried to modify the student ID encoded in the GET URL at once, hoping to access other user's pages. Unfortunately, I only confirmed the fact that the EAS team had completely fixed this infamous security leak. Bad luck!<br/><br/>I shortly realized that it would be good idea to "guess" other students' passwords in EAS making full use of the personal info obtained from <a href="http://202.195.165.18:8080/reader/reader_info.php">the database of our university's public library</a>. I wrote seven similar scripts named trypassword.pl, trypassword2.pl, ..., and trypassword7.pl respectively, to probe EAS's login system using different password patterns. Basing on student IDs, phone numbers, Chinese names, and birthdays extracted from the Personal ID numbers, I luckily cracked in total 738 accounts (well above 12%) of the students in Grade 03.<br/><br/>I'd like to write down some typical passwords cracked by my Thief project. I wonder if you can figure out the "meaning" yourself:<br/><br/>    3030202018
    19841101, 198467
    841206, 05185763926, 6880313, 13706256959
    zhoujie, lxb, liu
    zhangmu1985, zhou1985, py1983
    lxx3482858, 7301572huyewen<br/><br/>Thanks to the <a href="http://tech.sina.com.cn/c/2001-10-08/6239.html">Imegen.exe</a> program shipped with Windows. I got a GBK-PinYin mapping list within only a few minutes by using the Reverse-Conversion function provided by this tool. The data were actually extracted from the WINPY.MB file used by the Quan Pin IME (Input Method Editor). So we have no reason to worry about the correctness and completeness of our mapping list.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

