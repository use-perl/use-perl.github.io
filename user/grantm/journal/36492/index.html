<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of grantm: Coming up for air</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Coming up for air</h1>
<h2><a href="/user/grantm/">grantm</a> on 2008-05-22T09:28:31</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>I've been working full time (and more) for most of the year on a CMS migration project.  It seemed to take over my every waking hour and meant my backlog of non-work work has moved from being ridiculously long to insanely long.  Anyway, we finally drew a line under it today and called it done.  Hooray!</p>

<p>I don't imagine that migrating from one CMS to another is ever much fun.  In this case it was certainly an adventure.  We were moving from a proprietary CMS called ArticleManager (ArtMan) to <a href="http://drupal.org/">Drupal</a>.  The version of ArtMan was quite old; was written in Perl (which had been obfuscated to protect their IP); and used a binary on-disk file rather than a database.  I didn't have to worry about the Drupal side of things because our company has half a dozen people who specialise in knocking together Drupal sites and one of them would look after that side of things.</p>

<p>I was able to get a fairly high-fidelity export of the data using WWW::Mechanize to walk through ArtMan's article and category edit screens and pulling out the contents of the HTML form elements.  I inserted the data into a Postgres database which I was then able to run lots of SQL queries over to try and decode what the various flags and statuses meant.</p>

<p>It was around this time that I discovered all our Drupal people were fully committed so despite my complete ignorance of PHP, the Drupal deployment became my problem too.  Fortunately there were good people on hand to answer my many questions - thanks especially to <a href="http://dollyfish.net.nz/blog">Martyn</a>.</p>

<p>I've worked with a few CMSs and I have yet to meet one that I like.  Having said that, Drupal is probably the one I hate the least so far.  The big thing that Drupal gets right is that they acknowledge everyone's requirements are different and that for all but the most trivial sites, you <i>will</i> need to customise the behaviour of the CMS.  With this in mind Drupal provides an architecture and an API that enables you to add new functionality and change core functionality without changing the core code.  The fact that the Drupal developers have achieved this using PHP is nothing short of miraculous.  The API is undeniably quirky but you can't go past the fact that it works.</p>

<p>Another great thing about Drupal is the large number of <a href="http://drupal.org/project/Modules">modules</a> that are available to drop into your installation.  Some of them will even do stuff that's vaguely similar to stuff you want.  I've come to the conclusion that the greatest value of these modules is that they provide sample code you can cut and paste when building your own modules to turn Drupal into <i>exactly</i> the system you want.<p>

<p>Another big win is that even though the core functions and add-on modules can be configured by pointing and clicking, they can also be configured from code.  Martyn helped me set up an installation profile script which took me from nothing to fully configured in a little over a minute.  Knowing you can burn down and completely recreate your development environment  in minutes really helps to build confidence in the product and your ability to deploy it.</p>

<p>So I ended up building two custom modules to support:</p>

<ul>
<li>custom content types with exactly the metadata we want</li>
<li>a category/navigation hierarchy and URL scheme that works the way we want</li>
<li>a simple system for hyperlinking between pages in such a way that the links don't break when pages are moved</li>
<li>file attachment handling that's close to what we want</li>
<li>a site design that's very close to what the designer mocked up</li>
<li>RSS feeds</li>
<li>integration with numerous small pieces of existing functionality</li>
<li>a reasonably straightforward user interface that content editors can use to manage all this stuff</li>
</ul>

<p>Of course all that comes at a cost.  Drupal performance sucks.  Big time.  No doubt a large part of that is all the hard work my custom code is doing and no doubt we could do magic with caching to make it suck less.  But it doesn't matter because we were never going to install Drupal on our web servers anyway.  We use wget to suck all the pages out into static files; run some fix-ups across it with a Perl script and rsync it up to the production server.  For DR we just rsync to two servers instead of one.</p>

<p>And <a href="http://www.elections.org.nz/">here's the result.</p>

<p>At least my next assignment is Perl.</p></p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

