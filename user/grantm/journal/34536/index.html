<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of grantm: License to Process Words</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>License to Process Words</h1>
<h2><a href="/user/grantm/">grantm</a> on 2007-09-25T09:06:49</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>I've just finished converting one MS Word document of about 150 pages to a group of about a dozen HTML pages.  What a nightmare!</p>

<p>Last time I had to do this, the output was closer to 100 HTML files with very little formatting so I ended up scripting much of it.  I loaded the document into Open Office and saved as ODT.  Then I used XPathScript to spit out a series of very plain HTML files.  With the site stylesheet applied they looked very smart.</p>

<p>This time, the document structure didn't really lend itself to scripting and there was more formatting that I wanted to preserve (eg: headings, bullet lists, simple tables).  So I used 'Save as Web Page' from Word and then did most of it manually with Vim.</p>

<p>The HTML that Word produced was unspeakably vile. All sorts of illegal constructs (e.g.: a &lt;p&gt; inside a &lt;span&gt; inside another &lt;p&gt;!); enormous sections of proprietary markup inside comment markers; kilobytes of unnecessary attributes (align="left" on every &lt;p&gt;); and invented markup tags (eg: &lt;place&gt; and &lt;placetype&gt;).</p>

<p>I was able to strip out much of the cruft with LibXML/XPath/DOM manipulations and some search and replace regexes in Vim.  But the result was still gruesomely awful.  Much of it came down to operator error on the part of whoever typed the document:</p>

<ul>
  <li>every alternate paragraph empty &emdash; to provide vertical whitespace</li>
  <li>strings of empty paragraphs to push content onto a new page</li>
  <li>'tables' of data with columns aligned using spaces</li>
  <li>'bulleted lists' created by inserting a bullet character at the start of each line</li>
  <li>vast sections of body text in 'Heading 2' style with the font overridden to give normal looking text</li>
  <li>most actual headings rendered using bold and/or font changes</li>
</ul>

<p>As one of my colleagues commented, people should not be allowed to use a Word Processor without a license.</p>

<p>It can't all be blamed on users though.  The user interfaces of Word and Open Office are absolutely awful.  They make it far <b>too easy to do the wrong thing</b>, by jamming the screen full of toolbar buttons and menus.  Conversely they make it <b>hard to do the right thing</b> by hiding the style selection tool in amongst all that visual clutter.  Each new release over the years seems to have made the problem worse.  What these interfaces need is less, not more.</p></p>


<hr/>



<h2>Dreamweaver++</h2>
<h3><a href="/user/Alias/">Alias</a> on 2007-09-26T01:21:36</h3>
Dreamweaver has this great little menu entry called "Clean up Word HTML".<br><br>It's not perfect, but generally when I need to do Word cleanup, I run it through that filter first, then do the rest by hand from there.



<h2>HTML Tidy++</h2>
<h3><a href="/user/ajt/">ajt</a> on 2007-09-26T11:42:38</h3>
<p>
There is also HTML-Tidy, which is available as a plug-in to many GUI HTML editors, e.g. HTML-Kit or Quanta+. It's a small c library and there is a small executable available for command line use and there is of course a Perl module based on it, HTML::Tidy.
</p>

<p>
As much as I loath and detest Microsoft products, what scares me even more is that people who love Microsoft have no idea how to use their products at all. It's hardly surprising that most Windows machines are infected with something or that when I receive an MS Office file from someone it's almost quicker to retype it from scratch than it is to use it as is...
</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

