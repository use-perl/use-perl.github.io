<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of rjbs: my new raid</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>my new raid</h1>
<h2><a href="/user/rjbs/">rjbs</a> on 2006-02-01T05:07:16</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>Yesterday afternoon, I saw that my Newegg order would be "shipping soon."  I hoped I'd see my drives before Friday.  This morning, I saw that it had shipped.  Not only that, but it had shipped from Edison, New Jersey, and was already out for delivery to my apartment.<br/><br/>I had two new 250 GB drives waiting for me at home, so I got to work getting my storage situation hashed out.<br/><br/>The first problem was recompiling with RAID1 and LVM support.  I kept getting a weird C-language level error from make.  Finally I realized that at some point I had bizarrely decided to upgrade my Slackware 7 box to GCC 4.  Using 2.95.3, the kernel compiled just fine.<br/><br/>The next problem was finding mdadm and the lvm tools.  Once I found them, one of them only compiled with 2.95.3, the other with GCC 4.  Huh?<br/><br/>I got the RAID set up easily with mdadm, spent a little time figuring out how to create a volume group, and got my CPAN mirror (and some other things) moved onto the first logical volume.  I rebooted, and found that I hadn't given any thought to the fact that I'd need to reassemble the RAID on boot.  I got it put back together, but I haven't rebooted again.  I'm hoping that the mdadm.conf that I put together, along with "mdadm -A /dev/md0" in my rc.S will be enough.<br/><br/>I'm also wondering whether I'll really need to run vgchange to activate the volume group on each boot.<br/><br/>Once I'd gotten my mirrors onto the RAID (which was running with just one drive) I was able to pull the old mirrors drive and put in the other 250.  I started md rebuilding the RAID mirror, and boy howdy!  It's going to take a while.  Under normal load, it was saying it was getting between 2.5 and 3 megs per second, which seems very low to me.  Now I decided to be impatient and start copying my music archive onto the raid.  The load is sitting around 4 and /proc/mdstat is showing recovery occuring between 400 and 1000 K/s, despite /proc/sys/dev/raid/speed_limit_min being set at 10000.<br/><br/>I have ATA-100 controllers on this motherboard, so I'm not sure what's up.<br/><br/>I think I'll give it more thought when I can talk to more knowledgeable people about it.  For now, I think I'll go to bed. </p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

