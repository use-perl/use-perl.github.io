<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of rjbs: making my mime mail merger</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>making my mime mail merger</h1>
<h2><a href="/user/rjbs/">rjbs</a> on 2004-12-22T18:47:53</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>We wanted to send out a "Seasons Greetings" mail to our customers.  I asked why we couldn't just use Office's mail merge feature, and it turned out that we wanted a custom "from" for each recipient, so that every customer would get the email from his sales rep.  This requirement was later dropped, at which point I realized that Outlook doesn't mail merge for email.  You can only mail merge if you're going to print, fold, and post your snail mail.  Ugh!<br/><br/>Of course we wanted to send HTML mail with colors and pictures, and of course I was offended and wanted to secretly make it multipart/alternative.  This gave me a reason to learn how to use some new PEP modules, mostly Email::MIME and Email::MIME::Creator.  I managed to write a simple mail merger for multipart mail in just a few lines of Perl.  It's not fantastic, but it's reusable for ... well, next Christmas, if nothing else.<br/><br/>I make a directory with just a few files:
<code>
  addrs      - a tab-delim list of salutations and email addresses 	
  part.plain - TT2 template of the plaintext part
  part.html  - TT2 template of the html part
</code><br/><br/>The directory should really store the sender and subject in a file; it'd be a simple use of IO::All to do so; I'll get around to it next year.<br/><br/>	http://rjbs.manxome.org/hacks/perl/mailmerge </p>


<hr/>



<h2>mail merge</h2>
<h3><a href="/user/kjones4/">kjones4</a> on 2004-12-22T20:17:19</h3>
Oddly enough, you can do an email merge from Word rather than Outlook. I've done this as far back as Office 97. You can specify plain text for the email. We used to send email to our customers using a list in Excel as the email data source. This feature continues to exist in Office 2003 as far as I can tell. I haven't tested it for many years though. Look for "mail merge" under the tools menu.



<blockquote>

<h2>Re:mail merge</h2>
<h3><a href="/user/rjbs/">rjbs</a> on 2004-12-23T12:59:59</h3>
Why didn't you anticipate that I was doing this and ring me at the office?!<br> <br>Oh well.  MS Help wasn't forthcoming about this on searches for "email merge," and I didn't think to try in Word.  I forget that some people (ugh) use Word to edit email.<br> <br>Hey, it got me to learn more Email:: stuff, so that's good, right? Right??





</blockquote>


<h2>how many would that be</h2>
<h3><a href="/user/cog/">cog</a> on 2004-12-23T23:48:32</h3>
Just out of curiosity, how many costumers and how many sales rep. do you have?<br> <br>I assume the answer could be "enough to bother doing this", but I'm just curious as to how much time was saved.



<blockquote>

<h2>Re:how many would that be</h2>
<h3><a href="/user/rjbs/">rjbs</a> on 2004-12-23T23:54:38</h3>
I sent a few hundred emails.  It was certainly faster to do what I did (learn the requisite Email:: modules and write a script) than it would have been to edit each one by hand for the right salutation.<br> <br>It would have been faster to use Office.  Of course, that wouldn't have worked with the initial (but later dropped) requirement.<br> <br>So, it wasn't a horrible idea, and I got to learn something new.  Yay!





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

