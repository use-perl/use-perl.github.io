<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of VSarkiss: Coding judo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Coding judo</h1>
<h2><a href="/user/VSarkiss/">VSarkiss</a> on 2002-10-02T15:33:50</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>I'm currently working on Microsoft SQL Server 2000, using something called Data Transformation Services, or DTS.  It's basically MS trying to work into the data warehouse market, by edging out competitors like Informatica.</p>
<p>You build a DTS package out of components, which do things like establish connections, execute SQL, transform columns, etc.  One component allows you to write scripts using VBScript or JScript, or if you install it yourself, Perlscript.  Guess which I picked.</p>
<p>Well, in typical MS fashion, the software doesn't do everything that the documents claim.  In some cases you have to read <em>very</em> carefully, because the wording seems to be precisely crafted to make it sound like it does more than it actually says.  After two days of struggle to make Perlscript work in that environment, yesterday I gave up and decided to try writing VBScript.  Well, I'd forgotten a lot of how (badly) it worked, so I figured I'd write some small tests to make sure that what I wanted would work at all.  Small surprise, it did seem to work in VBScript, if I copied their example code carefully.</p>
<p>So what was the problem?  I decided to go back and carefully re-craft the code from VBScript to Perl.  I found that this resulted in code slightly different from what I had written previously, mainly due to not fully understanding how Win32::OLE implements the COM interfaces.  (Should I use <code>$obj->{foo}->Value</code>? or <code>$obj->foo()</code>? or ...)  When I got it to work, I quickly tucked away its guts in a module, and verified I could call from it DTS.  Hallelujah!  Free at last!  I can now re-use the code without copying-and-pasting, and without putting up with VBScript.</p>
<p>So, boys and girls, remember: sometimes the way to win is by giving in first, then turning it to your advantage.</p>
<p>BTW, I have to mention: if you're going to try anything with Win32::OLE, the best resource I've found is <a href="http://www.roth.net">Dave Roth's web site</a>.  Invaluable information, in the form of tips and example.  Thank you, Dave!</p></p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

