<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of Ovid: ASP Expert</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>ASP Expert</h1>
<h2><a href="/user/Ovid/">Ovid</a> on 2003-03-07T19:17:46</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>"Who's our ASP expert?"</p>

<p>All eyes turn towards me.  "Uh, I did ASP for about two months, but that's all."</p>

<p>Thus, I am their ASP expert.</p>

<p>The scenario:  an ASP page is using an Excel spreadsheet for a database.  The client has complained that they made some format changes to the spreadsheet and now the darned ASP page won't read it.  Stupid ASP pages (sarcasm, folks).</p>

<p>Since the problem is either in the spreadsheet or the ASP page that reads it, the client decides to "fix" (?!?) the global.asa file.  This is a file used with ASP pages (if used correctly) to store application and session information.  That's it.  It should have nothing to do with the fact that this guy changed his spreadsheet format.  Fortunately, Front Page kept crashing whenever he tried to open the file.  For once I am happy that MS apps can be flaky.</p>

<p>Meanwhile, I'm looking at the email complaint and it's ... well ... do I need to explain?  We've all gotten those "it doesn't work" complaints.  So I need to replicate the error, but the Web site is password protected.  The passwords are in the database, but someone was thoughtful enough to <tt>crypt</tt> them.  Not great, but it's better than plaintext.</p>

<p>I still need to replicate the error.  I need to get pass the password screen.  I try forcing an error to see if they have weak security that I can break (we host the site, so I'm not worried), but no dice.  I know the filesystem and, on a lark, type in the real URL directly, knowing that it won't work.  But it does.  I now have access to the appropriate screen, but it looks perfect.  I hit reload a couple of times and it crashes and burns with a beautifully formatted "Database Results Error:  Unspecified error".</p>

<p>Now I need to find the error log.  Searching the Web, I find examples of VBScripts (!) that allow me to figure out the Web site number which I can then use to run on another script to determine the logs.  (This is user-friendly?)  Then another page tells me how to use the drag-n-drool GUI to figure out where the logs are hidden.  Once I finally get to the log, it turns out to be an access log.  I can't find error logs <em>anywhere</em>.  I check the headers the page is returning and even on errors, it's returning a 200 OK status, thus implying that whatever errors might get reported, I may not even find them in an error log, if it exists.  I don't know ASP very well, I don't know IIS very well.  It's going to be a long day.</p></p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

