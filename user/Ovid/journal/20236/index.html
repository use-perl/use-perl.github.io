<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of Ovid: Obvious and annoying</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Obvious and annoying</h1>
<h2><a href="/user/Ovid/">Ovid</a> on 2004-08-04T21:08:38</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>Obvious in retrospect, but it was annoying when I stumbled on it.  This was fairly obscure in a much larger program.</p>

<pre>use warnings;
use strict;
                                                                                     
foo('bar');

my %hash = (bar => 'value');
sub foo { print $hash{+shift} }</pre></p>


<hr/>



<h2>Argh</h2>
<h3><a href="/user/vsergu/">vsergu</a> on 2004-08-04T22:11:01</h3>
It took me a while. Too used to doing that sort of thing in modules, where it works.



<h2>Not that obvious</h2>
<h3><a href="/user/phillup/">phillup</a> on 2004-08-05T00:39:34</h3>
I give... what is it supposed to do?<br> <br>TIA



<blockquote>

<h2>Re:Not that obvious</h2>
<h3><a href="/user/grantm/">grantm</a> on 2004-08-05T00:48:48</h3>
<blockquote><div> <i>what is it supposed to do?</i> </div></blockquote>

<p>The function foo takes the name of a key and prints out the corresponding value from %hash.</p>

<p>You might expect it would print 'bar' but the call to foo is executed before the line that initialises %hash so instead Perl complains about an uninitialised value and exits.</p>



<blockquote>

<h2>Re:Not that obvious</h2>
<h3><a href="/user/phillup/">phillup</a> on 2004-08-05T00:51:41</h3>
Thanks.<br> <br>I was actually getting hung up on the +shift part... didn't realize that the + was a unary operator.<br> <br>I thought it would choke because it didn't have a left hand value...



<blockquote>

<h2>Re:Not that obvious</h2>
<h3><a href="/user/grantm/">grantm</a> on 2004-08-05T08:43:24</h3>
Yes, the + is there to stop <blockquote><div> <tt>$hash{shift}</tt> </div></blockquote> being interpreted as <blockquote><div> <tt>$hash{'shift'}</tt> </div></blockquote>





</blockquote>

</blockquote>


<h2>Re:Not that obvious</h2>
<h3><a href="/user/phillup/">phillup</a> on 2004-08-05T00:49:33</h3>
hm... didn't realize that the + was a unary operator.<br> <br>Is this thing supposed to print out 'bar'?



<blockquote>

<h2>Re:Not that obvious</h2>
<h3><a href="/user/Ovid/">Ovid</a> on 2004-08-05T19:04:51</h3>
<p>One might think that it should print out 'value', but the crux of the problem, as noted by grantm, is that the hash is declared at compile time (so strict doesn't complain) but the line that assigns data to the hash is not executed by the time <tt>&amp;foo</tt> is called.  this means that the hash is empty, even though it's been declared.  I can only remember being bitten by this twice, but both times it's confused the heck out of me.</p>



<blockquote>

<h2>Re:Not that obvious</h2>
<h3><a href="/user/phillup/">phillup</a> on 2004-08-05T20:40:08</h3>
<i>One might think that it should print out 'value'</i> <br> <br>Of course... I meant to say that.<nobr> <wbr></nobr>;-)<br> <br>Which reminds me.<br> <br>If I reply to someone's comment, I see the message I'm replying to on the page I type my response in.<br> <br>But, if I reply to a journal entry, I don't see the message and I'm basically "flying blind" and going from memory.<br> <br>To make matters worse, replying to a comment involves clicking on a link. So, I can open the page in another tab and have easy access to the original comment. But, replying to a journal entry involves a button... and opens in the same tab. So, using a nice browser doesn't help either...<br> <br>Is this something I can change via a preference setting on this site, or is it a "feature"?<br> <br>TIA



<blockquote>

<h2>Re:Not that obvious</h2>
<h3><a href="/user/Ovid/">Ovid</a> on 2004-08-05T21:55:01</h3>
<p>I'm not aware that it's changeable, but I've also not paid much attention to the customization features.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

