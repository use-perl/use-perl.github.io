<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of Ovid: Building Enterprise Level Web Applications with Maypole</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Building Enterprise Level Web Applications with Maypole</h1>
<h2><a href="/user/Ovid/">Ovid</a> on 2004-03-02T15:28:37</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>I've been hearing a bit about <a href="http://maypole.simon-cozens.org/">Maypole</a> (think "<a href="http://jakarta.apache.org/struts/">Struts</a> for Perl").  In a nutshell, it's designed to allow you to write complex database driven Web applications very quickly.  For example, how long would it take you to build a Friendster/Orkut type web application that does the following?</p>

<ul>
    <li>login</li>
    <li>logout</li>
    <li>view users</li>
    <li>browse users</li>
    <li>search for users</li>
    <li>edit profiles</li>
    <li>mail out invites to new users</li>
    <li>accept invites</li>
    <li>reject invites</li>
    <li>sign up new users</li>
    <li>offer friend connections</li>
    <li>accept friend connections</li>
</ul>

<p><a href="http://blog.simon-cozens.org/6670.html">Simon Cozens writes that it took him just over a week with only 300 lines of Perl</a>.  Maypole runs under mod_perl and is <a href="http://search.cpan.org/user/simon/Maypole-1.1/">available on the CPAN</a>.  It's built on top of Class::DBI, Template Toolkit, DBI and Apache::MVC.</p>

<p>This is something that I think Perl has long been needing.  Whether or not Maypole is the way to go is not something that I can say, but I do feel that <em>something</em> like this would be a Good Thing for several reasons.  First, my job boils down to providing maximum value for minumum cost and the less code I have to write, the fewer bugs I will create.  Second, Perl has long been lacking an enterprise level Web application framework.  Regardless of your views on frameworks, this has been an issue which has led many outside of the Perl community to dismiss Perl.</p>

<p>Maypole is being actively developed, it has a <a href="http://lists.netthink.co.uk/listinfo/maypole">mailing list</a> and, with Simon Cozens being behind it, I think it has a chance to go far so long as people get behind it.  It's also being built on top of solid, proven technologies.</p>

<p>Any thoughts?  Are there problems with his approach?  Are there competitors worth checking out?</p></p>


<hr/>



<h2>Maypole. . .</h2>
<h3><a href="/user/CromeDome/">CromeDome</a> on 2004-03-02T16:31:20</h3>
. .<nobr> <wbr></nobr>.seems very promising to me.  Being in the middle of such an app as you describe, this could have been a real timesaver.  I'll definitely be checking it out.<br> <br>It seems to be, in some ways, CGI::Application on steroids.  Using CGI::Application has bought me some flexibility that I might not have with Maypole, but like you said, a consistent, enterprise-class framework is something that Perl could really use.<br> <br>Thanks for bringing this to my attention<nobr> <wbr></nobr>:)  This will get added to my growing list of things to check out and learn.



<blockquote>

<h2>Re:Maypole. . .</h2>
<h3><a href="/user/Ovid/">Ovid</a> on 2004-03-02T16:41:28</h3>
<p>I also posted this to <a href="http://www.perlmonks.org/index.pl?node_id=333276" title="perlmonks.org">Perlmonks</a perlmonks.org> and <a href="http://search.cpan.org/user/borisz/Apache-PageKit-1.12/" title="cpan.org">Apache::PageKit</a cpan.org> has been brought to my attention.  It appear to have been around quite a bit longer, but I don't know enough about it to know how to compare and contrast the two.  The only thing that stood out right away is that PageKit uses HTML::Template.  That's a great module, but I've been seduced by the power of Template Toolkit.  With TT, I'm not restricted to HTML.  I can output data in many different formats.  This would be great for creating automatic report download in CSV or similar formats.</p>



<blockquote>

<h2>Re:Maypole. . .</h2>
<h3><a href="/user/perrin/">perrin</a> on 2004-03-02T23:17:17</h3>
Actually, HTML::Template is not restricted to HTML.  It can be used for any text-based templating problem.  I've used it for e-mail.





</blockquote>

</blockquote>


<h2>Reinventing OpenInteract?</h2>
<h3><a href="/user/merlyn/">merlyn</a> on 2004-03-02T17:09:27</h3>
It sounds to me like a reinvention of SPOPS/OpenInteract, which is a mature and slowly-developing project.  I wonder if the distinctions are worth the redundant overlaps.



<h2>OpenInteract comparison</h2>
<h3><a href="/user/lachoy/">lachoy</a> on 2004-03-02T18:56:55</h3>
I haven't taken a detailed look at Maypole yet (no tuits), but just off the top of my head there are a number of similarities between Maypole and OpenInteract (I'll focus on the still-in-beta OpenInteract2 because it's got a lot more going for it). Generally OI2 is much more heavyweight and designed to adapt to more environments than Maypole. But that doesn't mean it's better -- as usual flexibility comes at a price, in this case complexity. And as usual whether this complexity is worth it really depends on what you're doing.

<ul>
  <li>OI2 is very big. The <a href="http://openinteract.sourceforge.net/docs/oi2-snapshot/" title="sourceforge.net">HTML doc snapshot</a sourceforge.net> for the next beta weighs in at 1.3 MB -- and some parts need better docs<nobr> <wbr></nobr>:-) As a result you need to do more work to startup a new system, although the <a href="http://openinteract.sourceforge.net/docs/oi2-snapshot/OpenInteract2/Manual/QuickStart.shtml" title="sourceforge.net">quick start guide</a sourceforge.net> helps out with that.</li>
  <li>Both rely on the Template Toolkit, although OI2 supports additional content generation methods (pluggable, and it's distributed with support for HTML::Template and Text::Template)</li>
  <li>Both are tied to an object-relational mapping solution -- OI2 uses SPOPS while Maypole uses Class::DBI. But I think  both can use other solutions without too much problem (that is, using SPOPS objects in Maypole and Class::DBI objects in OI2). Class::DBI is generally simpler than SPOPS but SPOPS also does LDAP and some mildly interesting stuff with security.</li>
  <li>OI2 seems to be more internally declarative. (Keep in mind, this is based on a cursory look at Maypole -- I wouldn't be surprised if under the covers they did much the same thing.) So in Maypole you map a URL to an action (represented by a PerlHandler) using Apache. In OI2 a package (or distributable application) contains an 'action.ini' file which registers classes (and optional parameters) with the framework and tells it what names it will respond to. Another component is responsible for mapping incoming URLs to names. You also declare if an action is secured, what methods are not allowed, and more. In fact comparing the beer DB example from Simon's weblog entry to the <a href="http://openinteract.sourceforge.net/docs/oi2/OpenInteract2/Manual/Tutorial.shtml" title="sourceforge.net">OI2 package development tutorial</a sourceforge.net> is pretty useful -- note that the first part of the tutorial does things the "longer" way, the second part introduces the 'common' actions and does it more declaratively.</li>
  <li>You can use OI2 under multiple environments. Currently Apache 1.x, CGI and LWP are supported, with a working (but probably suboptimal) version using Apache 2.x in the next beta.</li>
  <li>OI2 focuses on creating distributable, standalone applications. So I can send you a zip file (foo-0.01.zip) and you can run <br>
<tt>oi2_manage install_package --package_file=foo-0.01.zip<br>
oi2_manage install_sql --package=foo</tt> <br>
And have it install that application's database structures, initial data, templates, static HTML pages and images, configuration, classes (including actions, TT plugins, normal Perl classes), localized messages (in the next beta), etc.</li>
</ul>

<p>There are almost certainly more differences, but I have a non-Perl day job to get back to<nobr> <wbr></nobr>:-) That said, I think the application server problemspace is sufficently complex that having multiple solutions are extremely useful. </p>



<blockquote>

<h2>Re:OpenInteract comparison</h2>
<h3><a href="/user/Simon/">Simon</a> on 2004-03-02T22:13:54</h3>
On the whole, I agree with Chris! However...

<blockquote><div>
Generally OI2 is much more heavyweight and designed to adapt to more environments than Maypole. But that doesn't mean it's better -- as usual flexibility comes at a price, in this case complexity. And as usual whether this complexity is worth it really depends on what you're doing.
</div></blockquote>

<p>
True. Maypole aims to be as simple as possible, while still enabling you to do the complex things if you need to. The Orkut-alike was designed basically as a test to make sure Maypole could actually do the complex things relatively easily. But OI2 is certainly bigger and chunkier, and possibly better suited to more environments - Maypole is meant to be sleek and generic, and I hope I've designed it well enough to be generic but it hasn't been stressed in as many environments as OI2 yet.
</p>

<blockquote><div>
OI2 is very big.
</div></blockquote>
<p>
That's because you have documentation, you cheat!<nobr> <wbr></nobr>:)
</p>

<blockquote><div>
As a result you need to do more work to startup a new system, although the quick start guide [sourceforge.net] helps out with that.
</div></blockquote>

<p>
Yeah. I wanted Maypole initially so that I could run up really really quick interfaces to databases. The fact that it does more is a bonus. I'm a big fan of obviating as much code as possible and generally doing what the user means. As you say, there's always a trade-off for that and Maypole and OI2 sit at different ends of the scale.
</p>
<blockquote><div>
Both rely on the Template Toolkit, although OI2 supports additional content generation methods
</div></blockquote>
<p>
Maypole does too, but the Template Toolkit is Too Damned Good so nobody's written any other View classes yet.<nobr> <wbr></nobr>:)
</p>
<blockquote><div>
Both are tied to an object-relational mapping solution -- OI2 uses SPOPS while Maypole uses Class::DBI. But I think both can use other solutions without too much problem (that is, using SPOPS objects in Maypole and Class::DBI objects in OI2).
</div></blockquote>
<p>
Yep.
</p>
<blockquote><div> Class::DBI is generally simpler than SPOPS but SPOPS also does LDAP and some mildly interesting stuff with security.
</div></blockquote>
<p>
There's your simplicity-functionality tradeoff again.
</p>
<blockquote><div>
So in Maypole you map a URL to an action (represented by a PerlHandler) using Apache. In OI2 a package (or distributable application) contains an 'action.ini' file which registers classes (and optional parameters) with the framework and tells it what names it will respond to. Another component is responsible for mapping incoming URLs to names.
</div></blockquote>

<p>
Yeah. Now you can override the mapping method in Maypole - or indeed any of the methods - but it's intended to give you sensible defaults that do what you mean. In fact, the mapping method isn't in Maypole at all - it's in Apache::MVC.
</p>
<blockquote><div>
You also declare if an action is secured, what methods are not allowed, and more.
</div></blockquote>
<p>
Maypole does this with attributes, which is quirky but fun.
</p>
<blockquote><div> In fact comparing the beer DB example from Simon's weblog entry to the OI2 package development tutorial [sourceforge.net] is pretty useful
</div></blockquote>
<p>
There's a much longer Maypole article coming out on DeveloperWorks soon, hopefully, which not only talks about simple stuff like the BeerDB, but also how I put together Flox.
</p>
<blockquote><div>
You can use OI2 under multiple environments. Currently Apache 1.x, CGI and LWP are supported, with a working (but probably suboptimal) version using Apache 2.x in the next beta.
</div></blockquote>
<p>
Again, you got there first, and nobody's implemented the front-end classes for Maypole yet. That said, I got some patches to
support Apache 2, and so there'll probably be a CGI::Maypole coming out this Thursday.
</p>
<blockquote><div>
OI2 focuses on creating distributable, standalone applications.
</div></blockquote>
<p>
*nod*. Maypole doesn't touch this.
</p>
<blockquote><div>
 I think the application server problemspace is sufficently complex that having multiple solutions are extremely useful.
</div></blockquote>
<p>
No quibbles there.
</p>



<blockquote>

<h2>Re:OpenInteract comparison</h2>
<h3><a href="/user/lachoy/">lachoy</a> on 2004-03-03T03:45:16</h3>
<blockquote><div>Maypole does this with attributes, which is quirky but fun.</div></blockquote>

<p>That's an interesting idea. For some reason attributes always seem a little peek-a-boo to me, but that's probably because I haven't hung out with them enough.</p>

<p>One of the more obvious comparisons I forgot: Maypole has a much better name than OpenInteract!</p>



<blockquote>

<h2>Re:OpenInteract comparison</h2>
<h3><a href="/user/Ovid/">Ovid</a> on 2004-03-03T06:02:08</h3>
<p>What do you mean by "peek-a-boo"?  If handled properly, they can provide elegant solutions.  For example, what if you want your subroutine to return a list in list context, a reference to an array in scalar context and die if called in void context?  You might write this:</p> <blockquote><div> <tt>sub foo {<br>&nbsp; &nbsp; # do stuff<br>&nbsp; &nbsp; return wantarray<br>&nbsp; &nbsp; &nbsp; &nbsp; ? @array<br>&nbsp; &nbsp; &nbsp; &nbsp; : defined wantarray<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ? \@array<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; : die "Do not call me in void context";<br>}</tt> </div></blockquote> <p>Doing that for several subroutines can get tedious.  One alternative is to use attributes (via <a href="http://search.cpan.org/user/ovid/Attribute-Context-0.03/lib/Attribute/Context.pm" title="cpan.org">Attribute::Context</a cpan.org>).</p> <blockquote><div> <tt>use base 'Attribute::Context';<br> <br>sub foo : Arrayref(NOVOID) {<br>&nbsp; &nbsp; # do stuff<br>&nbsp; &nbsp; return @array;<br>}</tt> </div></blockquote> <p>No muss, no fuss.  You just specify what happens depending upon the context in which something is called.  Attributes are really quite nifty once you get used to them.</p>



<blockquote>

<h2>Re:OpenInteract comparison</h2>
<h3><a href="/user/lachoy/">lachoy</a> on 2004-03-03T12:11:39</h3>
I understand what attributes are, it's just that they have a fairly large potential for misuse. (Then again, so does Perl...) I agree that they can be extremely elegant and the example you gave is great, but often they're used for application-level behavior like security, web services, etc. I have a suspicion (perhaps unfounded) that it's better and easier to maintain to have this behavior external to the code so it can be modified externally.

<p>But I'm probably concerned over nothing<nobr> <wbr></nobr>:-)</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

