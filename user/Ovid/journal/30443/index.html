<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of Ovid: MS (again) flunks security 101(with Python and Perl CGI)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>MS (again) flunks security 101(with Python and Perl CGI)</h1>
<h2><a href="/user/Ovid/">Ovid</a> on 2006-07-27T12:21:33</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>As pointed out in <a href="http://doxdesk.com/updates/2006.html#u20060416-cgi">this blog entry</a> and <a href="http://support.microsoft.com/default.aspx?scid=kb%3Ben-us%3B276494">verified in Microsoft's knowledge base</a>, Microsoft is giving out some pretty dangerous security advice on how to set up Python CGI.  Basically, the IIS mapping the recommend for Python CGI is "C:\Python20\python.exe %s %s".  The problem, as noted in the blog:</p>

<blockquote>Unfortunately this is not just wrong, but possibly dangerous. The first problem is that it'll break if a CGI script's filename has a space in it, because everything after the space becomes parameters to the script. Secondly, if the script name starts with a hyphen, it become a flag to the Python interpreter. And there are some dangerous flagsÃ¢â¬âfor example -c allows you to execute any Python code.
<br>
<br>If the Ã¢â¬Ëcheck file existsÃ¢â¬â¢ option is turned on, this is only an annoyance in that you can't use script names with these characters in. However if turned off an attacker would be able to abuse these holes without you having to provide a script with a weird name.
<br>
<br>The solution is to put the Ã¢â¬Ë%sÃ¢â¬â¢s in quotes, and ensure that the Ã¢â¬Ëcheck file existsÃ¢â¬â¢ option is always on.</blockquote>

<p>Oh, wait!  Naturally, I had to do some digging.  <a href="http://support.microsoft.com/default.aspx?scid=kb;en-us;245225">Looks like they have similarly bogus advice for Perl</a>.  Curiously, the latter link shows up as a blank page in my Firefox but renders just fine in IE.</p></p>


<hr/>



<h2>My favourite line</h2>
<h3><a href="/user/clscott/">clscott</a> on 2006-07-27T13:44:40</h3>
NOTE: The PERL language permits no spaces at the beginning of a line.



<h2>Weird rendering</h2>
<h3><a href="/user/VSarkiss/">VSarkiss</a> on 2006-07-27T13:56:07</h3>
<p>Weird. Only the top of the page renders for me in Firefox.  Thank goodness for the <a href="https://addons.mozilla.org/firefox/1419/" title="mozilla.org">IE tab extension</a mozilla.org>.</p>
<p>I also liked that they consistently capitalized PERL.  Obviously they know about the <a href="http://search.cpan.org/src/JMCNAMARA/Acme-Inline-PERL-0.01/PERL.pm" title="cpan.org">Inline::PERL</a cpan.org> module.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

