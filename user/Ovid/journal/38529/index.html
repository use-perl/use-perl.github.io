<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of Ovid: Making Test::Class More Like xUnit</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Making Test::Class More Like xUnit</h1>
<h2><a href="/user/Ovid/">Ovid</a> on 2009-02-22T15:09:36</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>In xUnit style tests, this is an entire test:</p>

<pre>sub first_name : Tests(tests => 3) {
    my $test   = shift;
    my $person = $test->class->new;
    can_ok $person, 'first_name';
    ok !defined $person->first_name,
      '... and first_name should start out undefined';
    $person->first_name('John');
    is $person->first_name, 'John', '... and setting its value should succeed';
}</pre>

<p>In the TAP world, we would look at this as three tests, but xUnit says we have three asserts to validate one feature, thus we have one test.  Now TAP-based tests have a long way to go before working for xUnit users, but there's one thing we <em>can</em> do.  Let's say that you have a test with 30 asserts and the fourth assert fails.  Many xUnit programmers argue that once an assert fails, the rest of the information in the test is unreliable.  Thus, the tests should be halted.  Now regardless of whether or not you agree with this (I hate the fact that, for example, junit <em>requires</em> the test method to stop), you can get this behavior with <tt>Test::Class</tt>.  Just use <tt>Test::Most</tt> instead of <tt>Test::More</tt> and put this in your test base class:</p>

<pre>BEGIN { $ENV{DIE_ON_FAIL} = 1 }</pre>

<p>Because each test method in <tt>Test::Class</tt> is wrapped in an <tt>eval</tt>, that test method will stop running and the tests will resume with the next test method.</p></p>


<hr/>



<h2>Nice...</h2>
<h3><a href="/user/Adrian/">Adrian</a> on 2009-02-22T15:34:17</h3>
<p>Patches to the non-existent Test::Class::Cookbook are welcome<nobr> <wbr></nobr>:-)</p>



<blockquote>

<h2>Re:Nice...</h2>
<h3><a href="/user/Ovid/">Ovid</a> on 2009-02-22T15:55:01</h3>
<p>The reason I'm posting this is because I'm rewriting my <tt>Test::Class</tt> article.  I never published it and now am trying to figure out where.  I've also considered putting out a <tt>Test::Class::Base</tt> module which uses the features I'm describing and makes life just a tad easier for <tt>Test::Class</tt> users.</p>



<blockquote>

<h2>Re:Nice...</h2>
<h3><a href="/user/Adrian/">Adrian</a> on 2009-02-22T16:06:47</h3>
<p>Super!</p><p>One of the things I'd like to do at the qa-hackathon (assuming nothing more important shows up). Is clear up the T::C internals which... y'know.... suck...</p><p>If the Beeb decides you can go - we should chat.</p>



<blockquote>

<h2>Re:Nice...</h2>
<h3><a href="/user/Ovid/">Ovid</a> on 2009-02-22T16:26:10</h3>
<p>It's now been approved that I can go.  See you in Birmingham<nobr> <wbr></nobr>:)</p>





</blockquote>


<h2>Re:Nice...</h2>
<h3><a href="/user/chromatic/">chromatic</a> on 2009-02-22T18:00:38</h3>
<blockquote><div><p> <em>I never published it and now am trying to figure out where.</em></p></div> </blockquote><p>If you're still looking for a place, Modern Perl Books is happy to feature guest authors.</p>



<blockquote>

<h2>Re:Nice...</h2>
<h3><a href="/user/Ovid/">Ovid</a> on 2009-02-22T18:13:35</h3>
<p>Is it OK if it's published elsewhere? I've already had someone offer to publish it in another language.  I'll need to get their approval if I go that route, though.</p><p>I should probably rewrite the intro if it's for Moderl Perl Books.  I'd want to better tailor it for what you're trying to do with that site.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

