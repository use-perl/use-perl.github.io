<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of schwern: How do you amplify a public service announcement?</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>How do you amplify a public service announcement?</h1>
<h2><a href="/user/schwern/">schwern</a> on 2003-08-19T21:18:11</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><P>I've put up on my <a href="http://www.pobox.com/user/schwern">home page</a> a plea for mail admins to stop bouncing email viruses as it just adds to the problem.<br/><br/><P>I'm wondering what it would take to really amplify this message to the point it becomes
common knowledge.  How do we get the message out there that bouncing viruses is harmful to the point where Joe Corp Mail Admin knows this?</p>


<hr/>



<h2>Not Slashdot</h2>
<h3><a href="/user/cwest/">cwest</a> on 2003-08-19T22:26:55</h3>
They rejected my submission detailing the problem, it's cause and effect.  I even explained that it was not a Windows-only menace (referenced register story).  I even linked to chromatic's one question test for mail filter writers!<br> <br>Oh well, I guess the public doesn't *want* to know...



<h2>Ideas, some stupid, some maybe not so stupid</h2>
<h3><a href="/user/wnodom/">wnodom</a> on 2003-08-20T04:42:01</h3>
<p>
I'll let you decide which are which.
</p>

<ul>

<li>
Contact Microsoft and request that they include this information as part of
their virus-related security alerts (which they send out regularly, as you
can imagine).<br>&nbsp;<br>
</li>

<li>
Contact the major virus-protection vendors and have them place a prominent
notice in their support newsletters.  Better yet, get them to modify their
installation procedures and instructions to include this information.<br>&nbsp;<br>
</li>

<li>
Encourage the authors of e-mail server software to include this as part
of their installation instructions.<br>&nbsp;<br>
</li>

<li>
Purchase inexpensive text ads on popular sites (Metafilter, Kuro5hin, etc.;
typically $1 per thousand impressions).  Hell, they're all having the same
public-Internet-persona problem that you are, so you can probably get a
non-profit PSA into the ad rotation for free.<br>&nbsp;<br>
</li>

<li>
Like Casey suggested, get it on Slashdot. Avoid fighting the submission queue
by sucking up to nearby members of the Slash team.<br>&nbsp;<br>
</li>

<li>
Submit it as a PSA on Fark. (I don't know who to recommend sucking up to for
that one, however.)<br>&nbsp;<br>
</li>

<li>
Ask DiBona to mention it next time he's on TechTV.<br>&nbsp;<br>
</li>

</ul>



<blockquote>

<h2>Re:Ideas, some stupid, some maybe not so stupid</h2>
<h3><a href="/user/bart/">bart</a> on 2003-08-24T16:09:40</h3>
Add them in the next version of SpamAssasin.





</blockquote>


<h2>Is bouncing bad?</h2>
<h3><a href="/user/nik/">nik</a> on 2003-08-20T08:56:36</h3>
<p>Disclaimer: I do AV/Anti-spam for ~ 250,000 folk.  Many of my e-mail addresses are also plastered all over the 'net, so I get plenty of these bounces too.</p>

<p>Still, from my perspective, mail must *not* get lost.  Failure to deliver a message to it's recipient must *always* generate a bounce message (i.e., an SMTP 5xx error).</p>

<p>Why?  Because I don't trust anti-virus software to always do the right thing.  I don't trust anti-spam software to always do the right thing.  I don't trust *BLs and local block lists to always be 100% accurate.</p>

<p>Silently dropping mail on the floor just isn't an option.  Because sooner or later you'll drop something important.</p>

<p>N</p>



<blockquote>

<h2>Re:Is bouncing bad?</h2>
<h3><a href="/user/chromatic/">chromatic</a> on 2003-08-20T17:00:06</h3>
<p>I fail to see how an automated message saying "A message you didn't send to someone you don't know couldn't be delivered" is useful.</p>



<blockquote>

<h2>Re:Is bouncing bad?</h2>
<h3><a href="/user/nik/">nik</a> on 2003-08-20T20:08:47</h3>
<blockquote><div>
I fail to see how an automated message saying "A message you didn't send to someone you don't know couldn't be delivered" is useful.
</div></blockquote>

<p>It's not.  And if you've got an algorithm that can determine when to silently drop mail on the floor with no false positives, I'm all ears. But RFC 2821, s4.2.5 is quite clear on an MTA's responsibilities after it accepts a message. I don't think picking and choosing which bits of an RFC to implement is a good idea.</p>

<p>Yes, 2821 is in need of an update to deal with today's Internet, but at the moment, it's the best we've got.</p>

<p>Although having said that, things like SPF and RMX look interesting.</p>

<p>N</p>



<blockquote>

<h2>Re:Is bouncing bad?</h2>
<h3><a href="/user/gav/">gav</a> on 2003-08-21T00:18:09</h3>
&gt; I don't think picking and choosing which bits of an RFC to implement is a good idea
<br>
<br>
I do. Please feel free to not do things that are obviously broken. It wasn't that long ago that an RFC called for all SMTP servers to be open relays.



<h2>Re:Is bouncing bad?</h2>
<h3><a href="/user/chromatic/">chromatic</a> on 2003-08-21T01:11:02</h3>
<p>If you can detect that the message contains a virus, don't send the virus back.  If you can detect which virus the message contains, you can tell whether the virus spoofs e-mail addresses.  If it does, don't even send a bounce.</p>

<p>I gather from the fact that so many of these bounce messages say "Your message tested positive for Sobig" that both points are actually possible &mdash; and pratical.</p>



<blockquote>

<h2>Re:Is bouncing bad?</h2>
<h3><a href="/user/nik/">nik</a> on 2003-08-21T08:54:29</h3>
<blockquote><div>If you can detect that the message contains a virus, don't send the virus back.</div></blockquote>

<p>Doesn't work if you're trying to save cycles for wanted mail, and rejecting messages based on attachment types, or other content (e.g., the presence of web bugs).</p>

<p>To be specific, consider three sites, A, B, and C.  B has the virus, and is sending mail to C, with forged headers that look like it came from A. </p>

<p>If C refuses to accept the message (SMTP 5xx), it's B that generates the bounce message to A.  The mail logs at B should show (a) a high number of bounces going to A, (b) a large number of 5xx rejections from C.  The mail admins at B *should* notice this, and do something about it, and (c) admins at both A and C should notice this, and start complaining to B.</p>

<p>If C simply drops the messages on the floor then (a) B is going to keep sending them (chewing up more of C's resources), and (b) B is going to take longer to realise its got a problem.</p>

<p>N</p>



<blockquote>

<h2>Of course bouncing due to viruses is bad!</h2>
<h3><a href="/user/grantm/">grantm</a> on 2003-08-21T09:26:26</h3>
<p>If C accepted the message and silently refused to deilver it then why would B retry?  That makes no sense.</p>

<p>As Schwern pointed out the anti-virus vendors <i>do</i> know which virus is which and they <i>do</i> know which ones spoof sender addresses so <i>of course</i> they shouldn't bounce those ones back to the 'sender'.  They should simply say '200 Hmm Yummy' and do nothing more.</p>

<p>But I have an even simpler rule<nobr> <wbr></nobr>... Never generate a bounce response when a virus is detected.  Any virus.  Ever.  By all means have your virus scanning software alert the <i>recipient</i> - as a human being, they can eyeball the sender address and decide whether they want to do anything about it.  But the chances that the apparent 'sender' is going to find the bounce message useful is so close to zero that it simply isn't worth sending.</p>

<p>I've received close on 200MB of unsolicited mail at my personal email address in the last 48hrs.  The <b>vast</b> bulk of it (well over 90%) is bounce messages.  Even if there was a useful nugget of information in one of those bounce messages, I would never see it since I'm deleting messages 20-30 at a time.</p>



<blockquote>

<h2>Re:Of course bouncing due to viruses is bad!</h2>
<h3><a href="/user/nik/">nik</a> on 2003-08-21T09:56:10</h3>
<blockquote><div>Never generate a bounce response when a virus is detected. Any virus.</div></blockquote>

<p>As I say -- doesn't work if you're bouncing because of something else in the message (e.g., an attachment type that you don't want to see --<nobr> <wbr></nobr>.exe,<nobr> <wbr></nobr>.pif, etc).  This is much simpler to check for than doing a full virus scan, so it runs faster, so it's a better use of resources.</p>

<blockquote><div>By all means have your virus scanning software alert the recipient - as a human being, they can eyeball the sender address and decide whether they want to do anything about it.</div></blockquote>

<p>Doesn't work in a large user population.  Especially one that's been well trained to avoid opening attachments or messages from people they don't recognise.  All you do is flood your helpdesks with calls from employees who think they're doing the right thing by being cautious.</p>

<p>It also pushes your costs up if you, for example, have a regulatory requirement to archive all mail that makes it in to the system.</p>

<p>Remember, the system that's generating the bounce is the system that's infected.  Systems that want to reject messages for policy reasons (whatever that policy is -- "Looks like spam", "Contains a web bug", "Has an attachment type we don't want", "Contains a virus") have a duty to respond with a 5xx, and not silently swallow mail. </p>

<p>If you want to block bounce messages then filter mail from &lt;&gt; at your site.  Then it's your decision to be RFC non-compliant, and the consequences of that decision are yours.</p>

<p>N</p>

<p>PS: Railing against AV software that sends helpful notifications back (instead of a 5xx), is a completely different kettle of fish, of course.  There's a special level of hell reserved for the authors of Norton AV, which is particularly offensive in this regard.</p>



<blockquote>

<h2>Re:Of course bouncing due to viruses is bad!</h2>
<h3><a href="/user/grantm/">grantm</a> on 2003-08-21T19:20:14</h3>
<blockquote><div> <i>As I say -- doesn't work if you're bouncing because of something else in the message (e.g.,<nobr> <wbr></nobr>...<nobr> <wbr></nobr>.exe,<nobr> <wbr></nobr>.pif, etc).</i> </div></blockquote>

<p>Nonsense.  You are treating messages with those file types <i>as if</i> they contained a virus.  So the rule still stands don't bounce it, drop it.</p>

<p>If your SMTP server makes a quantitative decision that it can't handle the message (eg: unknown user or out of disk space) then by all means bounce it.  On the other hand if your server examines the contents of the message and makes a qualitative decision that it doesn't want to accept it due to your security policy then generating a reply which details those policies helps no-one but a potential attacker.</p>

<blockquote><div> <i>Doesn't work in a large user population.<nobr> <wbr></nobr>... All you do is flood your helpdesks with calls<nobr> <wbr></nobr>...</i> </div></blockquote>

<p>Ok your real motivation is becoming apparent.  There is no monetary cost associated with sending thousands of bounce messages to people that <i>you know</i> didn't send the original viruses.  Since these people don't work for your company, it also doesn't matter if you piss them off.  Hmm, good business.</p>

<blockquote><div> <i>Remember, the system that's generating the bounce is the system that's infected.</i> </div></blockquote>

<p>No, it's relaying mail on behalf of the system that's infected.</p><p><p>But to get back to the point, there are two problems:</p>

<ol>
<li>email messages containing  viruses</li>
<li>bounce messages resulting from email servers refusing to accept messages containing  viruses</li>
</ol>

<p>Unfortunately there's not much we can do about number 1 - that's a whole separate discussion.  This discussion is about number 2, which in the experience of many people here is a much bigger problem.  This morning I woke up to 175 emails of which 3 were real mail (it was a good day), 172 were bounce messages and 0 were viruses!</p>



<blockquote>

<h2>Re:Of course bouncing due to viruses is bad!</h2>
<h3><a href="/user/nik/">nik</a> on 2003-08-21T20:16:27</h3>
<blockquote><div>
Nonsense. You are treating messages with those file types as if they contained a virus. So the rule still stands don't bounce it, drop it.
</div></blockquote>

<p>Not true.  It's being treated as 'content not wanted'.  There's a large amount of content that's not wanted, and 'has a virus' is just a subset of it.  And on a typical day, virus infected content is a tiny fraction of the stuff that gets 5xx'd.</p>

<blockquote><div>If your SMTP server makes a quantitative decision that it can't handle the message (eg: unknown user or out of disk space) then by all means bounce it. On the other hand if your server examines the contents of the message and makes a qualitative decision that it doesn't want to accept it due to your security policy then generating a reply which details those policies helps no-one but a potential attacker.</div></blockquote>

<p>Again, not true.  Differentiated response messages make troubleshooting much easier, and assist the technical support at the sender's site in determining whether the problem is at their end or ours.</p>

<p>And there's really not that much information you can leak in 70 or so characters that's going to be of any use to an attacked.  And, to be clear, I'm not talking about a system that composes a multi page reply and fires it off to the envelope FROM -- I'm talking about a SMTP 5xx response code.</p>

<p>If your system doesn't want to handle bounce messages and other adminstrivia, send mail from &lt;&gt; to<nobr> <wbr></nobr>/dev/null (or just refuse to accept it).  That'll generate a double-bounce, and the recipient site is free to choose how it wants to handle double bounces.</p>

<p>N</p>





</blockquote>


<h2>Re:Of course bouncing due to viruses is bad!</h2>
<h3><a href="/user/chromatic/">chromatic</a> on 2003-08-21T19:53:52</h3>
<blockquote><div> <em>This is much simpler to check for than doing a full virus scan, so it runs faster, so it's a better use of resources.</em> </div></blockquote>

<p>Randomly send bounce messages to random e-mail addresses 10% of the time.  Don't bother scanning messages.  That should keep your system almost as efficient as possible, at the completely ignorable expense of everyone else on the Internet.</p>

<p>I don't care if the RFC was handed down on stone tables from Jon Postel.  If a bad guy says "Harass innocent people!" and your system does, it's broken.</p>



<h2>Your cheapskate virus scanning is NOT MY PROBLEM!</h2>
<h3><a href="/user/schwern/">schwern</a> on 2003-08-22T20:13:50</h3>
<blockquote><div>As I say -- doesn't work if you're bouncing because of something else in the message (e.g., an attachment type that you don't want to see --<nobr> <wbr></nobr>.exe,<nobr> <wbr></nobr>.pif, etc).  This is much simpler to check for than doing a full virus scan, so it runs faster, so it's a better use of resources.
</div></blockquote>

<p>A better use of <b>YOUR</b> resources.  What about <b>MINE</b>, the poor slob getting flooded?

</p><p>How selfish.  You want to employ the world as a giant meat verification system for your overly simplistic virus scanning so you can save a buck!

</p><p>Get a real virus scanner and don't shovel off your problem onto me.  I'm up to 200K of bounces just for the last 8 hours and I haven't even pulled all my mail down yet.</p>



<h2>Re:Of course bouncing due to viruses is bad!</h2>
<h3><a href="/user/nicholas/">nicholas</a> on 2003-08-23T08:30:11</h3>
<p>Beware of talking cross purposes</p>
<blockquote><div>PS: Railing against AV software that sends helpful notifications back (instead of a 5xx), is a completely different kettle of fish, of course. There's a special level of hell reserved for the authors of Norton AV, which is particularly offensive in this regard.</div></blockquote>

<p>Agree. In the past 24 or so hours, I think I've had 185 "helpful" messages about viruses, versus 21 bounces. So it appears that both sides of this "argument" are right.</p>
<p>Personally I'd like </p>
<ul> <li>Fuckwits who create AV software that sends me "helpful messages" for positively identified viruses that are known to forge headers to change career. (Yes. If you're reading this and you wrote one of those, however insulted you feel by me right now, you <b>were</b> doing something fuckwitted)</li>
<li>all mail systems to 500 spam and other unacceptable content, rather than bounce it to the "envelope from". Given that most of this shit has faked envelope froms, once they drop their STMP connection it's the last you're going to see of the real sender. So only while that connection is still up can you co anything to send feedback to the true sender. (Although the feedback I'd like to send spammers isn't valid binary, given that 1 is only 5V)</li> </ul>





</blockquote>


<h2>Schwern != chromatic</h2>
<h3><a href="/user/schwern/">schwern</a> on 2003-08-22T20:15:26</h3>
<blockquote><div>As Schwern pointed out</div></blockquote><br/><br/>chromatic and I really are different people.  I swear.<nobr> <wbr></nobr>;)  He says potato, I say potato.



<blockquote>

<h2>Re:Schwern != chromatic</h2>
<h3><a href="/user/grantm/">grantm</a> on 2003-08-23T00:18:19</h3>
<p>Yes, I realised my mistake about 3 seconds after pressing submit (and hoped you wouldn't take offense).</p>

<p>And certain high ranking politicans have been known to say potatoe.</p>



<blockquote>

<h2>Re:Schwern != chromatic</h2>
<h3><a href="/user/schwern/">schwern</a> on 2003-08-23T00:59:35</h3>
I'm used to being mistaken for <a href="http://dc.pm.org/cgi-bin/gallery?gallery_num=2&amp;page_num=1&amp;image_num=2&amp;large=large" title="pm.org">other</a pm.org> <a href="http://www.freegeek.org/images/staff/oso.jpg" title="freegeek.org">peo</a freegeek.org> <a href="http://www.freegeek.org/staff.html" title="freegeek.org">ple</a freegeek.org> by now.





</blockquote>

</blockquote>

</blockquote>


<h2>What's a 5xx rejection?</h2>
<h3><a href="/user/schwern/">schwern</a> on 2003-08-22T20:17:49</h3>
Perhaps we're talking about different things.  Could you explain the difference between a 5xx rejection and a normal "You sent us a virus!" message?  Which does NAV, InterScan, etc... send out?   More importantly, does the 5xx show up as regular mail?



<blockquote>

<h2>Re:What's a 5xx rejection?</h2>
<h3><a href="/user/nik/">nik</a> on 2003-08-26T09:08:21</h3>
<blockquote><div>
Perhaps we're talking about different things. Could you explain the difference between a 5xx rejection and a normal "You sent us a virus!" message? Which does NAV, InterScan, etc... send out? More importantly, does the 5xx show up as regular mail?
</div></blockquote>

<p>The "You sent us a virus" messages are the ones from products like NAV that try to be helpful, while at the same time marketing the product.  They're generated by the site that's doing the scanning (so if B is infected, sends a message to C, forged to appear to be from A, it's the software running at C that generates the message and sends it to A).</p>

<p>A 5xx rejection is where C refuses to accept the e-mail from B for some reason.  This might be because the address to which the message has been sent doesn't exist at C's site, or B is trying to use C as an open relay, or the sender is not allowed to send mail to the recipient.  Or it might be because C thinks the message has a virus.</p>

<p>In this instance, the message that's sent to A is generated by B, and will normally (a) be fairly terse, (b) be sent from MAILER-DAEMON, or similar, and (c) have an empty envelope sender.  The format of that message will depend on the mail software running at B.  For example, if B are running qmail, then the message will start something like this:</p>

<blockquote><div> <tt>Hi. This is the qmail-send program at smtp.utexas.edu.<br>
I'm afraid I wasn't able to deliver your message to the following addresses.<br>
This is a permanent error; I've given up. Sorry it didn't work out.</tt> </div></blockquote>

<p>followed by a (hopefully useful) transcript of the SMTP session up to the point where the error occured.  This might include text like:</p>

    <blockquote><div> <tt>554 Might contain a virus: Sobig.f</tt> </div></blockquote>

<p>or:</p>

    <blockquote><div> <tt>553 joe@example.com is not a valid address here</tt> </div></blockquote>

<p>or:</p>

    <blockquote><div> <tt>552 joe@example.com has exceeded their mailbox quota</tt> </div></blockquote>

<p>Or similar.</p>

<p>N</p>



<blockquote>

<h2>Re:What's a 5xx rejection?</h2>
<h3><a href="/user/schwern/">schwern</a> on 2003-08-27T21:39:15</h3>
<p>I get so few of those.<nobr> <wbr></nobr>:(  Most are of the NAV variety.

</p><p>But it doesn't seem anyone's hit upon the simple idea of a mail header:</p><blockquote><div> <tt>SMTP-Reponse: 554 May contain nuts</tt> </div></blockquote> <p>Different SMTP servers encode their response code in different ways in the body of the mail.  That its just more <i>mail that I have to scan and junk</i>.  Since the format isn't unambiguous, I'm back to writing rules.<nobr> <wbr></nobr>:(  However, they are significantly easier rules than what NAV and friends are causing me to write.

</p><p>Ideally what I'd want is for server A to tell my SMTP server "Hey, you sent me a virus" in a clear way so that my SMTP server can throw it away before I ever see it.  A simple mail header would be nice.

</p><p>For no particular purpose, here's a very small sampling of the transcripts I've been getting that contain "554".</p><blockquote><div> <tt>----- Transcript of session follows -----<br>... while talking to smtp-bounce.mac.com.:<br>&gt;&gt;&gt; DATA<br>&lt;&lt;&lt; 550 5.1.1 unknown or illegal alias: 6bcb192e-5b33-11d6-aee8-0003937ae4da@mac<br>.com<br>550 5.1.1 &lt;6BCB192E-5B33-11D6-AEE8-0003937AE4DA@mac.com&gt;... User unknown<br>&lt;&lt;&lt; 554 5.5.0 No recipients have been specified.<br> <br>----- Transcript of session follows -----<br>... while talking to ms-mta-01-fn.nyroc.rr.com.:<br>&gt;&gt;&gt; DATA<br>&lt;&lt;&lt; 550 5.1.1 unknown or illegal alias: jc@rochester.rr.com<br>550 5.1.1 &lt;jc@rochester.rr.com&gt;... User unknown<br>&lt;&lt;&lt; 554 5.5.0 No recipients have been specified.<br> <br>----- Transcript of session follows -----<br>... while talking to ams-msg-core-1.cisco.com.:<br>&gt;&gt;&gt; DATA<br>&lt;&lt;&lt; 552 5.0.0 SOBIG.F Virus outbreak - temp fix<br>554 5.0.0 Service unavailable<br> <br>----- Transcript of session follows -----<br>... while talking to filter-a.smig.net.:<br>&gt;&gt;&gt; DATA<br>&lt;&lt;&lt; 554 5.6.0 Message rejected because it contains one or more viruses<br>554 5.0.0 Service unavailable<br> <br>----- Transcript of session follows -----<br>... while talking to ams-msg-core-1.cisco.com.:<br>&gt;&gt;&gt; DATA<br>&lt;&lt;&lt; 552 5.0.0 SOBIG.F Virus outbreak - temp fix<br>554 5.0.0 Service unavailable<br> <br>----- Transcript of session follows -----<br>... while talking to [172.31.255.102]:<br>&gt;&gt;&gt; RCPT To:&lt;scarrie@maginfo.fr&gt;<br>&lt;&lt;&lt; 554 Mail for scarrie@maginfo.fr rejected for policy reasons.<br>554 &lt;scarrie@maginfo.fr&gt;... Service unavailable<br> <br>----- Transcript of session follows -----<br>... while talking to syd-msg-core-1.cisco.com.:<br>&gt;&gt;&gt; DATA<br>&lt;&lt;&lt; 552 5.0.0 SOBIG.F Virus outbreak - temp fix<br>554 5.0.0 Service unavailable<br> <br>----- Transcript of session follows -----<br> <br>ANTIVIRUS SYSTEM FOUND VIRUSES<br> <br>From: &lt;schwern@pobox.com&gt;<br>Subject: Re: Details<br> <br>dfh7RCTwv16840/text&nbsp; &nbsp; infected: I-Worm.Sobig.f.txt<br>dfh7RCTwv16840/document_9446.pif&nbsp; &nbsp; infected: I-Worm.Sobig.f<br> <br>554 5.6.0 Viruses were detected<br>501 5.6.0 Data format error<br> <br>----- Transcript of session follows -----<br> <br>!!! POZOR !!! POSTOVNI SERVER MU NALEZL VE VASI POSTE VIRUS.<br>!!! POZOR !!! V PRILOZE MATE HLAVICKU MAILU PRO PRIPADNY<br>!!! POZOR !!! KONTAKT NA ODESILATELE<br> <br>ANTIVIRUS SYSTEM FOUND VIRUSES<br> <br>From:&nbsp; &nbsp; &lt;schwern@pobox.com&gt;<br>To:&nbsp; &nbsp; &nbsp; &lt;yeti@physics.muni.cz&gt;<br>Subject: Re: Details<br> <br>dfh7RCnaa7031411&nbsp; &nbsp; archive: Mail<br>dfh7RCnaa7031411/text&nbsp; &nbsp; infected: I-Worm.Sobig.f.txt<br>dfh7RCnaa7031411/movie0045.pif&nbsp; &nbsp; infected: I-Worm.Sobig.f<br> <br>This message contain viruses. Virus was detected<br>with Antiviral Toolkit Pro from http://www.avp.ru.<br> <br>554 5.6.0 Viruses were detected<br>501 5.6.0 Data format error<br> <br>----- Transcript of session follows -----<br>... while talking to ms-mta-02-fn.nyroc.rr.com.:<br>&gt;&gt;&gt; DATA<br>&lt;&lt;&lt; 550 5.1.1 unknown or illegal alias: jc@rochester.rr.com<br>550 5.1.1 &lt;jc@rochester.rr.com&gt;... User unknown<br>&lt;&lt;&lt; 554 5.5.0 No recipients have been specified.</tt> </div></blockquote>





</blockquote>

</blockquote>


<h2>Re:Is bouncing bad?</h2>
<h3><a href="/user/schwern/">schwern</a> on 2003-08-27T21:52:46</h3>
<blockquote><div>If C refuses to accept the message (SMTP 5xx), it's B that generates the bounce message to A.  The mail logs at B should show (a) a high number of bounces going to A, (b) a large number of 5xx rejections from C.  The mail admins at B *should* notice this, and do something about it, and (c) admins at both A and C should notice this, and start complaining to B.
</div></blockquote>

<p>Oh yeah, I remember the problem I had with this idea.  <i>WHAT MAIL ADMIN?!</i>

</p><p>I'm it.  One guy with a laptop.  I'm sure there's lots and lots and lots of other people out there in the same boat.  The scenario above seems circa 1992 when either you got a mail account from a university or your computer savvy employeer.  Both involve large numbers of users with dedicated system administrators.  While there's still plenty of places like this, you can't simply ignore Joe Single User.

</p><p>The other problem is its not three sites.  Its three THOUSAND sites!  Its not B sending the virus to C making it look like A.  Its <i>half the Internet sending the virus to the other half</i> making it look like A.  I'm A.

</p><p>To give you an idea of the magnitude of the problem...</p><blockquote><div> <tt>~ $ ls -l<nobr> <wbr></nobr>/var/mail/schwern<br>-rw-------&nbsp; &nbsp; 1 schwern&nbsp; schwern&nbsp; &nbsp;2725439 Aug 27 14:29<nobr> <wbr></nobr>/var/mail/schwern<br>~ $ ls -l ~/Mail/spam<br>-rw-------&nbsp; &nbsp; 1 schwern&nbsp; schwern&nbsp; &nbsp;4852022 Aug 27 14:45<nobr> <wbr></nobr>/Users/schwern/Mail/spam</tt> </div></blockquote> <p>This is about 18 hours worth of my personal mail.  Keeping in mind that my inbox contains about 340 old messages.  I got about 130 new messages that weren't filtered.  About 30% of them are unfiltered bounces.  I got 667 filtered pieces of spam.  The overwhelming majority is bounces from all over the Internet.

</p><p>You really think the proper solution is for me to contact them all?</p>





</blockquote>

</blockquote>

</blockquote>

</blockquote>


<h2>1% false negative vs 50% false positive</h2>
<h3><a href="/user/schwern/">schwern</a> on 2003-08-21T00:29:11</h3>
<p>You might not trust it to do the right thing, but right now its doing a Very, Very Wrong Thing to such an extent that its effecting the health of the Internet.  I don't think you quite understand the magnitude of the problem.  I got another 1000 bounce messages overnight.  That's absurd.

</p><p>With the current setup you're generating a massive quantity of false positives.  So much so that I'm now likely to ignore *all* bounce messages.  In effect, by flooding the system with false positives you're social engineering far more false negatives than you would have by simply not sending the virus warning.

</p><p>Furthermore, with the current setup there's almost no chance that your virus warning will get back to the infected machine.  No modern virus sends out mail with a legit From line.

</p><p>Here's a simple solution.  Check the Received headers to see if the originating machine and the From line or Reply-To are even vaguely related before sending out a warning.  That would slash the number of false positives by at least an order of magnitude while still avoiding most false negatives.  Those of us who use services like pobox.com will suffer gladly.  In the case of an obviously bogus From line, send to the originating machine's postmaster.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

