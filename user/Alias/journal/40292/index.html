<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of Alias: Mojo vs Dancer Week 1 - Installer, Support and Hello World</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Mojo vs Dancer Week 1 - Installer, Support and Hello World</h1>
<h2><a href="/user/Alias/">Alias</a> on 2010-04-03T17:17:59</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>Lets Get Ready To Ruuuumblllleeee*cough*splutter* ahem. Sorry about that.<br/><br/>Welcome to the Mojo vs Dancer Top 100 Competition.<br/><br/>Over the next month or so I'll be building a replacement for my prototype <a href="http://ali.as/top100">CPAN Top 100</a> website simultaneously using the Dancer and Mojolicious micro-web frameworks.<br/><br/><b>The Competition Rules</b><br/><br/>While I do have a fair bit of experience with Perl coding, I will be trying wherever possible to behave in naively and newbie'ish fashion when it comes to community, support and tools.<br/><br/>I hope that during this process we can get some idea of the typical end user who won't know the right people to talk to or the right places to go for help.<br/><br/>One round will occur each weekend. I shall address one area each round, progressing until I have a working application (hopefully two).<br/><br/>While each weekend you will be subjected to my newbie code, during the rest of the week I will be inviting the development teams of both web frameworks to "improve" my code. They do so, however, at risk of LOSING existing points, should they try to hard to show off and create something I don't understand.<br/><br/>The week gap also gives plenty of time for each team to respond to my comments, to deny problems, to clarifying mistakes, and to fix, upgrade and do new releases.<br/><br/>For each issue I stumble across on my journey, I shall appoint only one winner. Each week may address more than one issue.<br/><br/>However, while I'll be recording the scores issue by issue, ultimate victory will be based entirely on my subjective personal preference for the one I think will be quickest and easiest for me to maintain.<br/><br/>If you'd like to follow along at home you can checkout the code for each project at the following locations.<br/><br/>Mojolicious - <a href="http://svn.ali.as/cpan/trunk/Top100-Mojo">http://svn.ali.as/cpan/trunk/Top100-Mojo</a><br/><br/>Dancer - <a href="http://svn.ali.as/cpan/trunk/Top100-Dancer">http://svn.ali.as/cpan/trunk/Top100-Dancer</a><br/><br/><b>Mojo - Getting to Hello World</b><br/><br/>I have some history with Mojo, being present at (and in a small way contributing too) its birth when Sebastian Riedel left the Catalyst project.<br/><br/>I've even attempted to build a Mojo application before, but was told at the time they weren't quite ready for actual users yet.<br/><br/>Their website is clean, efficient, but practically unchanged since I looked at it the first time.<br/><br/>It's also somewhat broken or at least unmaintained. The "Blog" link just points back to the same page, the "Reference" link points at what looks like a search.cpan.org failed search, and the "Development" link just throws me out to Github (which doesn't seem to really help much if I wanted to write a plugin or something other than hacking the core).<br/><br/>The "Book" link points to another search.cpan error page, and the most recent version at time of writing is 0.999924 which seems weird and makes me wonder how well they run the project.<br/><br/>Although the website doesn't fill me with confidence, the installation process is an entirely different story. One of Mojo's core design principles is to be pure perl and have zero non-core dependencies.<br/><br/>Installation via the CPAN client is fast, simple, and effortless. And I have full confidence that (if I needed to) I could just drop the contents of lib into my project and upload it to shared hosting somewhere.<br/><br/>I hear some rumors that to achieve this they've done rewrites of some very common APIs that work slightly differently, but I won't be looking into this right now. It will be a matter for another week.<br/><br/>To create my initial Hello World I've taken the most obvious approach and just cut-and-paste the code off the front page of the Mojolicious website, then stripped out the param-handling stuff, and modified the rest to something obvious looking. I've also added in strict and warnings, which the sample doesn't have.<br/><br/>Before attempting to run it, I have the following.
<pre>
#!/usr/bin/perl<br/><br/>use strict;
use warnings;
use Mojolicious::Lite;
 
get '/' => 'index';<br/><br/>shagadelic;<br/><br/>__DATA__<br/><br/>@@ index.html.ep
<html>
 <body>
  Hello World!
 </body>
</html>
</pre>
Looking at this code, it seems that everything is template based. This should be a good thing in general, as I'm a heavy Dreamweaver user and don't much like generating pages from raw code.<br/><br/>So far, it seems fairly simple. My main problem is that I have no idea what the hell "shagadelic" does, although I suspect it's some kind of way of saying "done". Whatever it is for, it annoys me enormously and dates the framework to (I assume) the release date of one of the Austin Powers movies. I get the feeling it is going to make Mojo feel more and more dated over time.<br/><br/>And they don't use strict or warnings, which seems a bit iffy.<br/><br/>When I run this helloworld.pl script, I get a handy little block of quite informative help text for my application for free.
<pre>
C:\cpan\trunk\Top100-Mojo>perl helloworld.pl
usage: helloworld.pl COMMAND [OPTIONS]<br/><br/>Tip: CGI, FastCGI and PSGI environments can be automatically detected very
     often and work without commands.<br/><br/>These commands are currently available:
  generate         Generate files and directories from templates.
  inflate          Inflate embedded files to real files.
  routes           Show available routes.
  cgi              Start application with CGI backend.
  daemon           Start application with HTTP 1.1 backend.
  daemon_prefork   Start application with preforking HTTP 1.1 backend.
  fastcgi          Start application with FastCGI backend.
  get              Get file from URL.
  psgi             Start application with PSGI backend.
  test             Run unit tests.
  version          Show versions of installed modules.<br/><br/>See 'helloworld.pl help COMMAND' for more information on a specific command.
</pre>
Running the obvious "perl helloworld.pl daemon" like it says on the website and connecting to http://localhost:3000/ I get a simple working "Hello World!" response first time.<br/><br/>So far so good then, except for the rather dead website. And no need to try any of the support channels yet either.<br/><br/><b>Dancer - Getting to Hello World</b><br/><br/>The Dancer website seems quite a bit more enticing than the Mojo website, at least superficially. There's evidence of more attention to some of the visual details, with more design elegance and things like source code syntax highlighting.<br/><br/>Clicking through the links, however, it's clear information is still a bit thin on the ground. And the "latest release" version on the download page is behind the version on CPAN, but not by much.<br/><br/>The website generally has more of a "new and undeveloped" feel to it, compared to Mojo's "mild neglect" feel.<br/><br/>One nice thing about the website, is that they've dropped a Hello World example directly on the front page for me to copy and paste.<br/><br/>After some small tweaks for my personal take on Perl "correctness" and legibility (the Dancer guys also don't use strict or warnings...) I have the following.
<pre>
#!/usr/bin/perl<br/><br/>use strict;
use warnings;
use Dancer;<br/><br/>get '/' => sub { return <<'END_PAGE' };
<html>
 <body>
  Hello World!
 </body>
</html>
END_PAGE
   
dance;
</pre>
The Dancer example is smaller and simpler than Mojo example, and doesn't make template use compulsory. Again, I can't stand this use of non-descriptive functions to end these programs. But at least "dance" is cleaner, is an actual verb, and is a bit less tragic than "shagadelic".<br/><br/>Instead, tragedy strikes for Dancer when I try to install it.<br/><br/>Because it doesn't install. Or at least, it doesn't install on Windows. Or perhaps it's just my Vista machine.<br/><br/>A redirect test is failing with this...
<pre>
t/03_route_handler/11_redirect.t ............. 1/?
#   Failed test 'location is set to http://localhost/'
#   at t/03_route_handler/11_redirect.t line 36.
#          got: '//localhost/'
#     expected: 'http://localhost/'<br/><br/>#   Failed test 'location is set to /login?failed=1'
#   at t/03_route_handler/11_redirect.t line 44.
#          got: '//localhost/login?failed=1'
#     expected: 'http://localhost/login?failed=1'
# Looks like you failed 2 tests of 9.
t/03_route_handler/11_redirect.t ............. Dubious, test returned 2 (wstat   512, 0x200)
Failed 2/9 subtests
</pre>
As a non-expert, that looks pretty serious. Maybe I'd force the install if it wasn't something as essential as redirecting that fails. But this is a pretty ordinary feature, and it's not working, and forcing in general scares me.<br/><br/>The one saving grace is at least it failed quickly. While not keeping dependencies to zero, they've done a fairly decent job of keeping the dependency list down to a minimum.<br/><br/>But the most damning factor here is a not that it failed once, but when I follow up by taking a look at their CPAN Testers results. These show failure rates all over the place, up and down, with some big regressions.<br/><br/>This kind of pattern usually suggests that Dancer is seriously lacking in their QA procedures, or have a complete disregard for platforms or Perl versions other than newer Perls on operating systems they personally have. This makes Dancer a risky choice for me to bet on, because it means it could all go wrong down the line unexpectedly.<br/><br/>So at this point, I'm going to stop with Dancer for this week, having failed to get Hello World working. We'll see if the Dancer guys can address this before next weekend.<br/><br/><b>Week 1 Results</b><br/><br/><i><b>Best Website - Dancer</b></i><br/><br/>While this isn't a massive victory, Mojo's many broken links hurt it, while Dancer shows at least some desire to be pretty, which I take as a hint that it might be easier for me in the future to make on my website pretty too.<br/><br/><i><b>Best Installation - Mojo</b></i><br/><br/>Zero dependencies and a fast installation that Just Worked, contrasts enormously with the failed installation of Dancer, and its unreliability over time (according to CPAN Testers at least).<br/><br/>If left to my own devices, I would probably already have committed to Mojo at this point, although reluctantly given Dancer's more desirable prettiness.<br/><br/><i><b>Best Hello World - Dancer</b></i><br/><br/>This one was quite close. Mojo suffered a bit because it forced its templating syntax onto me during Hello World, while Dancer suffered a bit because I had to resort to a Heredoc in the hello world.<br/><br/>In the end I'm awarding this to Dancer because of the pain in my brain that the function name "shagadelic" causes. I might have been cool for the first day or two, but long term I just know this is going to become an eyesore in my code.<br/><br/><i><b>Overall Leader after Week 1 - Mojo</b></i><br/><br/>Despite Dancer beating Mojo two to one on the individual factors, when the time came to do what I needed to do, Mojo installed quickly, gave me some help in the right place, and ran my Hello World without error or argument.<br/><br/>And Dancer did not these things.<br/><br/>Clearly, there's some QA work for the Dancer guys to do before next week, and the Mojo guys should probably dust some of the cobwebs off their website at the same time.<br/><br/>Next week, the competition will continue with database and ORM integration.<br/><br/>Until then, hopefully the respective teams will be blogging their responses and hopefully dealing with any issues raised.</p>


<hr/>



<h2>Correctness</h2>
<h3><a href="/user/Hansen/">Hansen</a> on 2010-04-03T18:30:40</h3>
<p>I'm looking forward to you in-depth review of the actual codebases and not just syntextual suger, as you are probably aware some of the some competitors has re-implemented a lot of existing mature codebases on CPAN, such as RFC: 2109, 2388, 2616, 4627, etc.</p><p>And simple thing like I/O and syscalls (logging error reporting) etc...</p><p>


--
chansen</p>



<blockquote>

<h2>Re:Correctness</h2>
<h3><a href="/user/sri/">sri</a> on 2010-04-03T19:06:28</h3>
See comment below please.



<h2>Re:Correctness</h2>
<h3><a href="/user/Alias/">Alias</a> on 2010-04-04T02:06:11</h3>
<p>I won't be reviewing their code unless, for some reason, some failure takes me chasing down into it in the debugger.</p><p>However, I may end up commenting on their APIs and naming if it sticks out as unusual</p>



<h2>Re:Correctness</h2>
<h3><a href="/user/Ovid/">Ovid</a> on 2010-04-04T06:18:30</h3>
<p>A code review may not be as useful.  What users almost always want to know is:</p><ul>
  <li>Does it do what I need?</li><li>Is it easy to learn?</li><li>Can I trust it? (less so on this one, unless they'll be using it for the long haul)</li></ul><p>One issue with code reviews is that <a href="http://www.perlmonks.org/?node_id=124879" title="perlmonks.org">reviews are terribly subjective</a perlmonks.org>.  If I have a different take on how to approach a problem, I might very well ding someone on a review because I didn't understand/appreciate their code.</p>





</blockquote>


<h2>Yes!</h2>
<h3><a href="/user/sri/">sri</a> on 2010-04-03T18:51:58</h3>
Such an in depth review would be amazing and very helpful, but i think it might be a bit too much for this competition.<br>
Maybe we can find a GSOC student to give it a try!<nobr> <wbr></nobr>:)<br>
Btw. "use Mojolicious::Lite" activates strict and warnings.<br> <br>
P.S: Website should be fixed and all examples have been updated to use "app-&gt;start" instead of "shagadelic". (Lets face it, inside jokes are not fun for new users)



<blockquote>

<h2>Re:Yes!</h2>
<h3><a href="/user/sri/">sri</a> on 2010-04-03T19:15:02</h3>
This was meant as a reply to chansens comment above.



<h2>Re:Yes!</h2>
<h3><a href="/user/jeremiah/">jeremiah</a> on 2010-04-17T13:59:16</h3>
Excellent - looks like Mojolicious is responsive.<nobr> <wbr></nobr>:)





</blockquote>


<h2>Excellent Start</h2>
<h3><a href="/user/Ovid/">Ovid</a> on 2010-04-03T19:03:28</h3>
<p>Thanks for this excellent start to the competition.  I really appreciate that you're focusing on the viewpoint of a new user rather than an experienced developer.</p><p>This is particularly evident in the fact that some of your HTML is showing through rather than being rendered properly<nobr> <wbr></nobr>:) (e.g.,  &lt;a href="http://svn.ali.as/cpan/trunk/Top100-Mojo"&gt;http://svn.ali.as/cpan/trunk/To<nobr>p<wbr></nobr>  100-Mojo&lt;/a&gt; instead of  <a href="http://svn.ali.as/cpan/trunk/Top100-Mojo" title="svn.ali.as">http://svn.ali.as/cpan/trunk/Top 100-Mojo</a svn.ali.as>).</p>



<blockquote>

<h2>Re:Excellent Start</h2>
<h3><a href="/user/Alias/">Alias</a> on 2010-04-04T02:07:21</h3>
<p>It was very very late, and I wasn't paying enough attention obviously<nobr> <wbr></nobr>:)</p><p>Layout and spelling/grammar/etc nigglies fixed hopefully.</p>





</blockquote>


<h2>Dancer on MS Windows</h2>
<h3><a href="/user/jnareb/">jnareb</a> on 2010-04-03T19:07:56</h3>
Savyer X in blog post <a href="http://blogs.perl.org/users/sawyer_x/2010/03/stepping-up-to-the-plate.html" title="perl.org">Stepping up to the plate</a perl.org> wrote:<blockquote><div><p>
Adam Kennedy has declared a contest between Dancer and Mojolicious. Seems to me like a great idea. We'll both get a chance to learn from each other, show our strengths and try to work on our exposed weaknesses.
</p><p>
[...]
</p><p>
Right now, <i>Dancer cannot participate in the challenge</i>. The reason is since Adam uses Windows and <i>Dancer doesn't install on Windows</i>. It isn't that Dancer is not Windows-compatible, it's just that it uses <a href="http://p3rl.org/HTTP::Server::Simple::PSGI" title="p3rl.org">HTTP::Server::Simple::PSGI</a p3rl.org>, which uses <a href="http://p3rl.org/HTTP::Server::Simple" title="p3rl.org">HTTP::Server::Simple</a p3rl.org> which fails a test on Windows. Thus, Dancer cannot be installed on Windows (at least with StrawberryPerl, which is what Adam - and many others - use).
</p></div>
</blockquote><p>

P.S. You have formatting errors, like visible HTML codes  instead of formatting.</p>



<blockquote>

<h2>Re:Dancer on MS Windows</h2>
<h3><a href="/user/Alias/">Alias</a> on 2010-04-04T02:11:10</h3>
<p>I gave them a chance to fix that particular issue, and I even used the patched version of HTTP::Server::Simple they gave me.</p><p>The installation failed for another completely different reason.</p>





</blockquote>


<h2>Pair 'v' Pear</h2>
<h3><a href="/user/Ron Savage/">Ron Savage</a> on 2010-04-03T23:22:59</h3>
<p>Hi Adam</p><p>I'll let other discuss the code.</p><p>As for 'pair shaped', it should be 'pear-shaped', since it really describes a woman with too much bulk on her hips and thighs.</p><p>Cheers</p>



<blockquote>

<h2>Re:Pair 'v' Pear</h2>
<h3><a href="/user/Alias/">Alias</a> on 2010-04-04T02:08:01</h3>
<p>Typo, fixed.</p>





</blockquote>


<h2>It's not just you...</h2>
<h3><a href="/user/DiamondInTheRough/">DiamondInTheRough</a> on 2010-04-04T05:56:51</h3>
My Win7 machine gives the same errors.



<h2>use strict/warnings and Windows</h2>
<h3><a href="/user/reezer/">reezer</a> on 2010-04-04T09:22:56</h3>
From Dancer::Cookbook<br/><br/>"Note that you don't need to use the strict and warnings  pragma, they are already loaded by Dancer."<br/><br/>So it saves space, like Modern::Perl, which would be a bonus for me.<br/><br/>
To all users of Perl on Windows. Maybe it works with the latest (beta/RC) version of strawberry perl. At least here it works.
<a href="http://strawberryperl.com/beta/" title="strawberryperl.com">http://strawberryperl.com/beta/</a strawberryperl.com><br/><br/>This competition is a great idea!
I've never ever used one of these before I read about the competition. The reason is that nearly nobody was talking about this, so it's great someone does.



<blockquote>

<h2>Re:use strict/warnings and Windows</h2>
<h3><a href="/user/draven/">draven</a> on 2010-04-04T13:20:05</h3>
This is actually the case for Mojolicious as well.



<blockquote>

<h2>Re:use strict/warnings and Windows</h2>
<h3><a href="/user/reezer/">reezer</a> on 2010-04-04T13:44:39</h3>
I guess it would be better, if every module used Modern::Perl, so it is more visible. I also had to find this statement first.<br/><br/>Will create some Dancer and Modern::Perl packages for linux distros and pkgsrc.



<h2>Re:use strict/warnings and Windows</h2>
<h3><a href="/user/ruz/">ruz</a> on 2010-04-05T09:48:56</h3>
<p>Then both can win from either of the following:<br>1) a comment in hello world example, for example: "no need in use strict or use warnings as above does that for you"<br>2) every line in the example with comments<br>3) example without comments and with comments</p><p>By the way Alias doesn't sound like a newbie<nobr> <wbr></nobr>:) Who knows about CPAN testers during his first month programming in perl.</p>





</blockquote>

</blockquote>


<h2>Re:use strict/warnings</h2>
<h3><a href="/user/snarkyboojum/">snarkyboojum</a> on 2010-04-05T01:51:40</h3>
use'ing Modern::Perl also means I have to be running Perl 5.10 or later. It'd be a shame to prevent people on older Perls from using Dancer.<br/><br/>I'd suggest keeping it as it is.<br/><br/>I don't see the big deal; either spend 2 minutes reading the documentation and work out that 'use Dancer;' loads the strict and warnings pragmas for you, or do it in your code (redundantly) as Alias has done.<br/><br/>Please don't force me to use a particular version of Perl for some kind of bogus "consistency" argument.



<blockquote>

<h2>Re:use strict/warnings</h2>
<h3><a href="/user/snarkyboojum/">snarkyboojum</a> on 2010-04-05T01:53:18</h3>
apologies - that was supposed to be in reply to 'Re:use strict/warnings and Windows' by reezer.



<h2>Re:use strict/warnings</h2>
<h3><a href="/user/chromatic/">chromatic</a> on 2010-04-08T18:51:19</h3>
<p>M::P doesn't prevent people from running on earlier versions of Perl.  It only means they have to know how to do so.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

