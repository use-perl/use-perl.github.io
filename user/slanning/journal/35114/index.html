<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of slanning: Perl Ogre summary and screenshots so far</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Perl Ogre summary and screenshots so far</h1>
<h2><a href="/user/slanning/">slanning</a> on 2007-12-16T20:24:03</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>I took screenshots of all the <a href="http://search.cpan.org/dist/Ogre/">Perl Ogre</a> demos.
It gives an indication of how the project has progressed
over the past few months. Although screenshots
are insufficient for animation or sound demos,
I give explanations and you can use your imagination. If you want to try them, install the Ogre modules from <a href="http://search.cpan.org/user/slanning/">CPAN</a>.
Most of these demos are originally from <a href="http://www.ogre3d.org/wiki/index.php/Ogre_Tutorials">OGRE tutorials</a> or the samples that come with <a href="http://www.ogre3d.org/">OGRE</a>, <a href="http://sourceforge.net/projects/ogreal/">OgreAL</a>, and the <a href="http://www.ogre3d.org/wiki/index.php/Main_Page">OGRE wiki</a>, so you could just install those as well.</p>

<p><a href="http://aycu37.webshots.com/image/35676/2000018441924575572_rs.jpg">Robot</a><br/>
This is the first thing I made work in Perl with OGRE 3D.
It loads a robot mesh and attaches it to a scene node,
then rotates and scales it. It's a minimal app that doesn't
even handle input, so in order to exit you have to close
the window then Ctrl-C.</p>

<p><a href="http://aycu32.webshots.com/image/37911/2005226460641854814_rs.jpg">Ninja</a><br/>
The ninja demo adds lighting, shadows, and a textured plane,
and handles input of the Esc key to quit the app.
</p>

<p><a href="http://aycu32.webshots.com/image/37911/2005226460641854814_rs.jpg">Listening ninja</a><br/>
This is the same scene, so the same screenshot, but the demo
shows how to use the FrameListener interface to listen
for user input events (still only the Esc key). It does this
through "unbuffered" input, which means that events are
processed by callbacks immediately.</p>

<p><a href="http://aycu38.webshots.com/image/35717/2001533052511928311_rs.jpg">Buffered ninja</a><br/>
The same ninja but no distracting background, and now we see
his back. This demo shows how to do "buffered" input,
and was the first one to use the Ogre::ExampleApplication
and Ogre::ExampleFrameListener framework (used by
the C++ OGRE tutorials). You can move the camera around
with the arrow keys (and PgUp/PgDown) and the mouse when
you hold the right mouse button. Pressing 1 or 2 toggles the
camera position between two locations.</p>

<p><a href="http://aycu30.webshots.com/image/36829/2001377752372110167_rs.jpg">Space SkyBox</a><br/>
A SkyBox is a texture that's applied to a big box
in the background. This demo shows a space scene
with planets and stars. In the foreground there's a terrain
that has shadows. The camera can move about freely as before.</p>

<p><a href="http://aycu14.webshots.com/image/36933/2001341039659681121_rs.jpg">Dark SkyPlane</a><br/>
A SkyPlane is the same idea as a SkyBox, but the texture gets
applied to a plane instead. If you can never see below a terrain,
then you don't need a whole box. This one is really evil looking
and reminds me of <a href="http://en.wikipedia.org/wiki/Image:Oblivion.jpg">Oblivion</a>. There is also a dark, exponentially
increasing fog.</p>

<p><a href="http://aycu03.webshots.com/image/37642/2005154547165753440_rs.jpg">Robot animation</a><br/>
This was the first demo where objects in the scene actually moved
without moving the camera. The robot has a "Walk" animation which
he does on the way to the first waypoint, at which point he gets
rotated with a Quaternion to face the last waypoint and continues walking.
After reaching the last waypoint, he executes the "Idle" animation,
which is what you see in the screenshot. Except it's not moving.</p>

<p><a href="http://aycu21.webshots.com/image/36900/2001370054884616174_rs.jpg">Robot dance</a><br/>
This is meant to demonstrate adding an Ogre render window
to a Gtk2-Perl application. It's a neat idea in principle,
but isn't working too well yet. Whenever you click the
Gtk2::Button labeled "Dance!", the camera toggles to the opposite
side of the robot, giving the impression that the robot
flipped around. Sorry to spoil it if you thought the robot
really danced. (One step forward and two steps back?)</p>

<p><a href="http://aycu02.webshots.com/image/35881/2005127308358656306_rs.jpg">Camera tracking</a><br/>
Here the camera zooms around, while always tracking (looking at)
the ogre head. The interesting part is setting up the camera movement.
To do that, an animation is created with a few "key frames"
(waypoints at a certain time), and the animation does
a spline interpolation between those points. It therefore
<a href="http://aycu13.webshots.com/image/36852/2005191414805834782_rs.jpg">swooshes around like a bird</a> rather than jumping
from point to point as in the robot dance demo.
(The reason the background gets white is there is a fog applied.)</p>

<p><a href="http://aycu12.webshots.com/image/35331/2001353680446959375_rs.jpg">Particle Effects</a><br/>
This is the most spectacular demo. There are <a href="http://aycu02.webshots.com/image/37121/2001339143531888149_rs.jpg">two
"fountains" rotating around beneath the ogre head</a>, showering particles;
flat, smoky rings rotate and rise up around him; rain is falling
(easier to see when you <a href="http://aycu18.webshots.com/image/37697/2001302034613889071_rs.jpg">point the camera
upward</a>); and bright green blobs of light bubble up from him.</p>

<p><a href="http://aycu08.webshots.com/image/37927/2005187732635794215_rs.jpg">Skeletal animation</a><br/>
This has ladies, called "jaiquas", sneaking around
wearing some kind of futuristic diving suits. They start out
around a circle rotated by 60 degrees each one with respect
to the next. Each animation is started at a slightly (randomly)
different time, and moves at a slightly (randomly) different rate,
giving more of a choatic feel as opposed to if they all did the
same animation in lockstep. If you press the 'r' button
(which you can do with any demo based on ExampleFrameListener),
everything is <a href="http://aycu05.webshots.com/image/35044/2005133344282495244_rs.jpg">shown in wireframe</a>, giving a kind of <a href="http://www.fast-rewind.com/tron.htm">Tron-like appearance</a>.</p>

<p><a href="http://aycu31.webshots.com/image/38870/2001381949973617167_rs.jpg">Terrain</a><br/>
Normally I'd put this after the SkyBox demos, but I want to keep
things chronologically ordered here. In the sky demos, you can move
the camera freely about, as if it was mounted on a helicopter;
you can even pass through the terrain. In this demo, the camera
is constrained to always be 10 units above the terrain,
so it is more like the camera is mounted on a (very smoothly riding)
land vehicle. It reminds me of the 3D battle scenes in the game
<a href="http://www.firingsquad.com/media/gallery_image.asp/131/50">Medieval: Total War</a>. The way it works is by using a RaySceneQuery.
The ray (long arrow starting from a point) starts at the camera
and goes downward, at some point intersecting with the terrain.
The scene query part tells you where this intersection is,
so you can then update the camera position to always be 10 units
above it. It's not as inefficient as it sounds; as you can see in
the screenshot, the scene is being updated 330 times per second
(with a terrain and fog).</p>

<p><a href="http://aycu32.webshots.com/image/36591/2005158388206604344_rs.jpg">Lighting and ribbon trails</a><br/>
The ogre head again, now floating in outer space, with shiny
lights slowly buzzing around him. The animation of the lights
is similar to the camera track demo above, with spline interpolation.
The lights are so-called RibbonTrails, which are a stream (trail)
of small Billboards. (It's a surprising fact that particle
effects are mostly based on billboards: lots of little billboards.) 
</p>

<p>At this point I made <a href="http://search.cpan.org/dist/Ogre-BetaGUI/">Ogre::BetaGUI</a> (more accurately, I ported
it to Perl from C++), which is used in the following three demos
merely to provide a mouse pointer.</p>

<p><a href="http://aycu27.webshots.com/image/37266/2005142010519980028_rs.jpg">Robots on a terrain</a><br/>
(There's a pun I'll make related to a movie featuring snakes and
a "plane" if I can ever figure out how to create a snake mesh
in Blender.)<br/>
This demo builds on the terrain demo. First of all, there is now
a mouse cursor that you move around. When you click the left button,
a robot appears there. If you hold the button down, you can even
drag the robot around. Keep in mind that the mouse is moving in
a 2D plane while the robots are being placed in 3D, so we end up
using a "getCameraToViewportRay" method to do a RaySceneQuery
similar to the one for clamping the camera to the terrain.</p>

<p><a href="http://aycu34.webshots.com/image/35953/2005137193610494140_rs.jpg">Robots and ninjas on a terrain</a><br/>
Robots versus Ninjas! This demo works the same as the previous one
if the mouse is not over a robot; however, if the mouse is over a robot,
the robot will be selected and you can drag it around again.
It's the same story with RaySceneQueries. A white box shows
which one is selected. In addition, you can toggle (with the space bar)
whether to place ninjas instead of robots, though the ninjas are scaled
wrong so they're like three times the size of the robots.</p>

<p><a href="http://aycu12.webshots.com/image/38731/2005110351072528924_rs.jpg">Robot selection by volume query</a><br/>
Unknown to the ninjas, the robots are building a <a href="http://ypnblog.com/blog/wpcontent/uploads/star_wars-clone_army.jpg">clone army</a>.
This demo shows the PlaneBoundedVolumeQuery and also how to
make a good old rubberband box used for selecting multiple objects
with a mouse. In the screenshot, I show the scene after I've already
made one selection of robots, and I'm now dragging a box around
to make another selection (but haven't let up the mouse button yet).
(Note: the implementation of the Perl binding is currently
a little sucky if you look in performSelection of examples/itute4.pl.)
</p>

<p>At this point I made <a href="http://search.cpan.org/dist/Ogre-AL/">Ogre::AL</a> (binding for OgreAL C++ library).
The following three demos are of that, though of course you won't
be able to hear the sounds.</p>

<p><a href="http://aycu29.webshots.com/image/35388/2005294364416403366_rs.jpg">OgreAL basic demo</a><br/>
Background music is playing, something by or for or from "ZeroFactor".
The ogre head, floating in mid-air as always, is "roaring".
Whereas the music stays at the same volume and appears to come
from nowhere, you'll notice the roaring comes from the ogre.
If you turn the camera to the left, the roar moves to the right.
If you move the camera back, the roar gets quieter like it's
moved off in the distance.
</p>

<p><a href="http://aycu25.webshots.com/image/35424/2005266802323469390_rs.jpg">Directional demo</a><br/>
There is a siren, which you can turn on and off. It rotates
when it's on, and the sound gets weaker when the horn points
away from you. To be honest, it doesn't seem realistic at all.
Basically it suddenly decreases in volume when the direction it's
pointing in is inside the 180 degrees half circle facing away
from the camera, then it suddenly increases again when it's within
the 180 degrees facing the camera. I don't know if the demo just
isn't finished yet, or if the <a href="http://www.openal.org/">OpenAL</a>
library sucks on Linux, or what. <b>UPDATE:</b> the author of OgreAL, Casey Borders, says that <a href="http://www.ogre3d.org/phpBB2addons/viewtopic.php?p=35322#35322">this is a Linux-specific problem</a>.
</p>

<p><a href="http://aycu20.webshots.com/image/36899/2005283207429383283_rs.jpg">Doppler demo</a><br/>
This demo is also disappointing. The car goes around in a circle,
but the sound isn't very....dopplery. When I think of a <a href="http://en.wikipedia.org/wiki/Doppler_effect">doppler effect</a>,
I think of race cars whizzing by or police sirens as the cop car
<a href="http://aycu16.webshots.com/image/36055/2005200162102095554_rs.jpg">speeds past</a>. (Again, I don't know
if it's the demo itself or the OpenAL library or my particular system. <b>UPDATE:</b> see update for previous demo.)
This demo also has a <a href="http://aycu22.webshots.com/image/38621/2005296656957323860_rs.jpg">more involved example of using Ogre::BetaGUI</a>,
which you can see in the upper-right corner. Clicking the arrow buttons
adjusts the doppler effect and speed of sound (in principle, at least...).
</p>

<p><a href="http://aycu20.webshots.com/image/38179/2005123620726207323_rs.jpg">Manually drawing shapes</a><br/>
Now back to Ogre, not Ogre::BetaGUI or Ogre::AL. I haven't even uploaded
this one to CPAN yet. It shows how you can draw shapes "by hand" rather
than creating them in Blender (not that I know how to do that). There is
a square, a line, a circle, and an annulus (disk with a hole in it).
The first three are pretty basic, you just give the positions of
the vertices and that's about it (ok, for the circle you have to give
a lot of vertices, but the idea is the same). The annulus,
on the other hand, is slightly more involved; you have to draw triangles
(in fact, quads made of two triangles each) to create the thickness.
If you <a href="http://aycu32.webshots.com/image/37151/2005215094878777960_rs.jpg">look behind the annulus</a>,
you'll see that it's only visible from the front.
That's because the "normals" to the triangles are pointing toward
the front, and the light only reflects that way. (You can easily
adjust the "circle_thick" function in examples/manualobject.pl
to also add all the triangles in reverse, then it will be visible
from both sides.)
</p>

<p>And that's all the demos for now. In the next few months
I hope to continue wrapping more of the Ogre API and clean
up that module a bit (it's starting to get out of hand, I need
to factor out some of the typemapping at least, and figure out
how to load each module separately if that's possible). I'm also
looking around at physics/collision engines, in particular ones
with Ogre bindings such as <a href="http://www.nxogre.org/">nxOgre</a> (PhysX), <a href="http://www.ogre3d.org/wiki/index.php/OgreODE">OgreODE</a>, and <a href="http://www.ogre3d.org/phpBB2addons/viewforum.php?f=12">OgreBullet</a>.
The simpler the API the better, and they have to work on Linux.</p>

<p>There was also a guy on the <a
href="http://www.ogre3d.org/index.php?option=com_content&task=view&id=16">#ogre3d
IRC channel</a> who mentioned that he was <a
href="http://perldoc.perl.org/perlembed.html">embedding perl</a>
into his (otherwise C++) game engine and then basically
wrapping <b>some</b> useful parts of Ogre in
<a href="http://perldoc.perl.org/perlxs.html">XS</a>.
It's something I've been thinking about, whether it's worth
it to continue wrapping so much in Perl when in fact I'm not
sure if I would ever use it myself if I actually made a game.
</p>
</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

