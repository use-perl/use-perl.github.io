<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of shockme: DNS Caching Woes</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>DNS Caching Woes</h1>
<h2><a href="/user/shockme/">shockme</a> on 2003-11-11T00:13:34</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>About two weeks ago, I set up a new box at work to replace our current mail gateway.  After I let it run as a failover for a few days, I updated DNS to reflect that this new box was the primary MX and configured the old one as tertiary.
<P>
Two+ weeks later, mail is still streaming through the old gateway.  Actually, at this point, I'd estimate that the load is about 50/50.
<P>
TTL (time-to-live) on the DNS records is 1 hour, and has been as long as I can recall.  When I do a dig from outside the office, everything looks fine, so I know my DNS is responding correctly.
<P>
Removing the old gateway from DNS didn't help at all.  People started moaning about not getting mail ... and tests from Yahoo confirmed that the mail was not being delivered.  As soon as I brought the old gateway back online, here comes the mail ...
<P>
I thought that once the external MTA saw that the MX was offline, it would at least try to send through the failover ...
<P>
What's really weird is places such as Hotmail ... those guys are sending through both the primary and tertiary ...
<P>
I did a TCP dump on the DNS box today, and it sure looks correct to me.
<P>
How in the hell do I get external MTAs to stop sending to the old gateway ... ?<br/><br/><br><br>Posted from <a href="http://exitwound.org">exitwound.org</a>, comment <a href="http://www.exitwound.org/shock/archives/000011.html">here</a>.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

