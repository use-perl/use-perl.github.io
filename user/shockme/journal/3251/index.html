<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of shockme: VMS, Exchange, Sendmail and Perl</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>VMS, Exchange, Sendmail and Perl</h1>
<h2><a href="/user/shockme/">shockme</a> on 2002-03-02T20:22:07</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>What a <I>busy</I> fu*king week.
<P>
Friday, March 1, 2002, at 07:00, we're scheduled to shut off the VMS email system.  This is in anticipation of throwing the power on the entire VMS set up on Sept. 1.
<P>
Naturally, our customers have known of this for <B>2 years</B>, and they've been reminded of it on an almost <B>monthly</B> basis.  "VMS is going away.  You need to request an Exchange account, and you need to request that your VMS email be forwarded to your new Exchange account."  It's been preached to them for years now.
<P>
So, <B>naturally</B>, the majority of customers <B>ignored</B> these directives.
<P>
Last week, we killed the VMS alias file, which forwarded VMS email to the exchange accounts.  Email was still received by the VMS system and was forwarded to Exchange.  Several people called and complained, and that was fairly easy to fix.  However, as the week wore on, the frequency of phone calls steadily increased.  By the end of last week, it was apparent that our <B>2 year - monthly reminder</B> program had failed.
<P>
Monday morning, boss-man calls a meeting.  People are in a panic.  We need to address it - immediately.  How do we correlate VMS accounts with Exchange accounts?  How do we ensure no mail is lost?  Everyone sits and stares.  
<P>
So I speak up.  I need a list of all VMS accounts.  Done.  I need a list of all Exchange accounts.  Done.  I need a separate list of all Exchange email addresses.  Done.
<P>
And thus began my one week period of silent and determined effort.  Long hours, continual work, ignoring the telephone.
<P>
Perl to the rescue.
<P>
Thursday, February 28, 2001.  15 hours of sleep and 13 Perl scripts later....the new virtusertable went online.  We're ready for Friday.  I'm ready for bed.  Of course, this task didn't alleviate or replace my ongoing support tasks, and to complicate my life just a little more, I'm the on-call support person this week, too.
<P>
The scripts are rushed.  The time constraints are huge.  I wouldn't post this code for nothing.  If only I'd have had another week...the code could've been beautiful.  The schedule dictates function over fashion.....it's dirty.  It's ugly.  But it looks like it's working....
<P>
Friday morning starts early.  07:00 the switch is thrown and the VMS email system is no more.  All forwards are now handled through the virtusertable  in Sendmail.
<P>
Throughout the day, a few telephone calls come in.  Not near the flood I feared.  By the end of the day, only a handful of accounts were missing.  I don't know what happened to them, how they were dropped (<B>if</B> they were dropped), etc.  They're in there now, and everything seems to working well.
<P>
A victory for Perl?  <I>Hell yes</I>.  Everyone in the department is now <B>accutely</B> aware of the fact that Perl can make seemingly impossible tasks <B>possible</B>.
<P>
A victory for me?  <I>Hell yes</I>.  My teammates now know that I won't back down from challenges and that I'll work until it's done.  Until it's <I>right</I>.  As I'm leaving the office Friday evening, boss-man shakes my hand.  Tells me I've earned my money.  Not for the week.  <I>For the month</I>.
<P>
I love this job.</p>


<hr/>



<h2>And now, some bitterness.</h2>
<h3><a href="/user/TorgoX/">TorgoX</a> on 2002-03-03T04:30:18</h3>
<i>As I'm leaving the office Friday evening, boss-man shakes my hand. Tells me I've earned my money. Not for the week. For the month.</i>
<p>So you should refuse to do any work for the rest of the month.  And by the way, you're working too hard.</p>



<blockquote>

<h2>Re:And now, some bitterness.</h2>
<h3><a href="/user/shockme/">shockme</a> on 2002-03-03T05:07:36</h3>
It ain't work when ya love it, baby.<nobr> <wbr></nobr>;)





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

