<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of Ranguard: Apache, mod_perl and a few lessons</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Apache, mod_perl and a few lessons</h1>
<h2><a href="/user/Ranguard/">Ranguard</a> on 2002-01-10T17:18:26</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>Well, I launched the site, and supprisingly
(considering the lack of testing time we had) it's all working rather well. I have had to learn some lessions very quickly though to make sure it stays working.
<p>
The site <a href="http://www.foxtons.co.uk">www.foxtons.co.uk</a>
Has front end apache servers serving images and static content which then proxy to a backend DB / CGI / Mod_perl machine.
<p>
<b>Lesson 1</b><BR>
Expect double your highest estimate of traffic (it was all running off one box previously, so I assumed not too much even though it was over loaded) and then double it and add some more. - We are getting loads more traffic than I though, there were no usable stats on the old server.
<P>
<b>Lesson 2</b><br>
Set your Apache MaxClients to the highest you can, taking in to account the memory on the machine, it was embarising to realise that the site was slow, not because of the machine load or memory but because it was being hit harder than I thought and just couldn't open enough processes.
<p>
<b>Lesson 3</b><br>
See lesson 2 and apply to back end mod_perl server.
<p>
<b>Lesson 4</b><br>
The mod_perl guide on line <a href="http://perl.apache.org/">http://perl.apache.org/</a> should be used in conjunctoin with the book "Writting Apache Modules with Perl and C". There were several thing in the online guide that I couldn't find in the book.
<p>
<b>Lesson 5</b><br>
There is NO lesson 5</b>
<P>
The main script was written for Apache::Registry, the load on the machine is between 2 and 5 so I definatly need to make it a propper mod_perl handle so it can share global variables such as a TT object. I hadn't realised until recently that this can not be done with Apache::Registry, though thinking about it it make sence.
<P>
I did find it interesting that when asking about, it turns out that most people, like my self, haven't ventured into mod_perl handles and tend to use Apache::Registry instead. I got my first mod_perl handle working today, was a lot easier than I thought it would be, still looking into some apache config options, there are just soo many.
<p>
<b>Lession 6</b><br>
PerlInitHandler, the mod_perl book says it can be put anywhere, but then it's quick reference card says it has to be in a <I>Directory</I> block in the conf. Only just remembered this lession.
<p>
Well, as usual enough rambeling...
</p>


<hr/>



<h2>Lesson 5</h2>
<h3><a href="/user/koschei/">koschei</a> on 2002-01-10T17:43:56</h3>
Hmm. I take the inverse approach. I use mod_perl handlers wherever possible  rather than Apache::Registry code.
<br>
<br>Except for actual content handlers, for which I use Mason =)



<h2>mod_perl handlers</h2>
<h3><a href="/user/geoff/">geoff</a> on 2002-01-10T18:38:16</h3>
mod_perl handlers really require a paradigm shift, which is why I personally think many programmers don't get into them - Apache::Registry speeds up their CGI scripts and they are happy.  Pulling out their authentication code and putting it into a handler just isn't intuitive at first.<br> <br>if you are really interested digging into the cooler aspects of mod_perl, well, you'll have a ready resource in only a few days<nobr> <wbr></nobr>:)



<h2>Erk</h2>
<h3><a href="/user/Matts/">Matts</a> on 2002-01-10T19:37:14</h3>
You killed my mozilla! You bastard!<nobr> <wbr></nobr>;-)
<br>
<br>Not sure what's up with that. I get total freeze up when I go there.



<blockquote>

<h2>Re:Erk</h2>
<h3><a href="/user/pudge/">pudge</a> on 2002-01-10T19:53:07</h3>
That's your lesson!



<h2>Re:Erk</h2>
<h3><a href="/user/Ranguard/">Ranguard</a> on 2002-01-17T14:06:42</h3>
Ahh, yes, umm, sorry<nobr> <wbr></nobr>:) ?<p>
Darn design agencies and their JavaScript.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

