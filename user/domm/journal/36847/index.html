<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of domm: testing fun</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>testing fun</h1>
<h2><a href="/user/domm/">domm</a> on 2008-07-03T16:03:41</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>So, I'm currently developing a single-sign-on system for <a href="http://www.revdev.at">$work</a>. Because I'm a well-behaved coder, I write tests. Which was fun today. In order to test the communication of the SSO-"Client" (i.e. the website the user actually wants to log on to) with the SSO-"Server" (the one SSO system), I had to:</p>
<ol>
<li>Generate a very small Catalyst TestApp (the "client")
<li>run the TestApp in a test (easy thanks to Catalyst::Test)
<li>write some fixures (connect to DB, generate a user to play around with, generate a login token directly in the DB)
<li>start the "server" by forking off another process and start another Catalyst app in the child
<li>Call the action in the "client" that's triggered after the user actually logged in on the SSO server.
<li>In this action, send an XMLRPC (ok, JSONRPC) request to the server running in the forked process.
<li>Take the result of the JSONRPC, store the values in the session & mark the user as authenticated
<li>Redirect to some page in the TestApp that is rigged to only display the username
<li>Check if the username matches the one generated for the testuser (see 3.)
<li>Kill the forked process
<li>Remove the fixtures
</ol>

<p>And it usernames matched! Even after setting the username to '<a href="http://en.wikipedia.org/wiki/RÃÂ¼&#351;tÃÂ¼_ReÃÂ§ber">RÃÂ¼&#351;tÃÂ¼ ReÃÂ§ber</a>' (yes, we're using the names of soccer players (especially ones with lots of non-latin1 characters) for test values
 - call it collateral damage of the EM...) (to bad that use.perl doesn't like utf8 chars in links, which means that the wikipedia link to poor old RÃÂ¼&#351;tÃÂ¼ is broken..)
</p>

<p>/me likes testing</p></p>


<hr/>



<h2>Better Link</h2>
<h3><a href="/user/Ovid/">Ovid</a> on 2008-07-03T16:14:21</h3>
<a href="http://en.wikipedia.org/wiki/R%C3%BC%C5%9Ft%C3%BC_Re%C3%A7ber" title="wikipedia.org">Try this link for him</a wikipedia.org>



<h2>Tests are great</h2>
<h3><a href="/user/ajt/">ajt</a> on 2008-07-03T19:12:32</h3>
<p>At work I mostly work with SAP which requires user testing which is hard to sensibly automate (given the small size of our system). Our test coverage is terrible and we often get problems appearing days, weeks or months after code is moved in to live that should have been picked up in testing.</p><p>At home where I mostly code in Perl and work when I can code in Perl I like the tests, it really helps improve your code and testing is a benefit not a chore in my opinion.</p><p>All I have to figure out now is why my module fails it tests for one user and not anyone else. CPAN Testers is great, but when you can't replicate the problem yourself you do feel a little stumped..!</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

