<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of coke: partcl running with tcltest.tcl</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>partcl running with tcltest.tcl</h1>
<h2><a href="/user/coke/">coke</a> on 2008-09-25T06:22:28</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>With recent updates (just in the past week), partcl (tcl on parrot) can now use the tcltest library that comes with tcl 8.5.4 [1]
<p>
For some time, we have been limping along with partcl's hand-rolled Test::More analog on a slightly processed version of tcl's *.test files.
<p>
The current version of make spectest is actually processing the raw .test files from the CVS repository.[2]
<p>
While tcltest doesn't generate TAP, being able to run the spec test using the native testing tool is a big step forward for partcl. Here's a sample:</p>
<code>
$ ./tclsh t_tcl/llength.test<br>
llength.test:   Total   6       Passed  6       Skipped 0       Failed  0
</code>
<p>
I've checked a file into  the repository to track the progress of the suite.<br>
<tt>
https://svn.perl.org/viewvc/parrot/trunk/languages/tcl/docs/spectest-progress.csv?view=markup<br>
</tt></p>
 <code>"date","revision","files","test","pass","fail","skip"<br>
 "2008-09-25 00:00",31396,38,1481,743,290,448
</code>
<p>
This is analogous to the file rakudo (Perl 6 on parrot) is using.



<p>
Hopefully a few more small tweaks will let us run more of the other 99
test files: we were passing many of those tests when they were lightly
converted, so the number of passes should hopefully go up quickly soon as more functionality required by tcltest is
implemented.
<p>

<i>[1] Not exactly a pristine copy: one of the core features of tcltest
(where should I send my output) requires some relatively advanced
functionality - tcl's tests are not designed like perl6's to allow new
implementations to ease into things. I've tacked on 2 replacement subs
in our copy of tcltest that for now always say "just print to
stdout/stderr". Still, that's a two oneline proc bodys compared to the original
3375 lines of tcltest.tcl</i>
</p>


<hr/>



<h2>Protocols trump APIs in versatility</h2>
<h3><a href="/user/Aristotle/">Aristotle</a> on 2008-09-25T15:25:12</h3>
<p>Maybe ask them if they would consider adopting TAP? That would be nice in a lot of different ways. The test suite would fit in with the rest of the Parrot languages, yet be applicable to both Tcl and partcl without conversions. They would get to use the TAP infrastructure that&#8217;s already built or just getting off the ground (Smolder, Ovid&#8217;s test history project, etc.). They could give us feedback about use cases they have that TAP does not currently cover (if any) so we would have more data for the TAP standardisation effort. They could go on to write their own TAP infrastructure and Perl stuff would then slot right into their bits (a win for them if they need to put bits of Perl into mainly-Tcl systems).</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

