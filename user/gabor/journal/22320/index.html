<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of gabor: AIX module installation problems, help anyone ?</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>AIX module installation problems, help anyone ?</h1>
<h2><a href="/user/gabor/">gabor</a> on 2004-12-15T15:03:30</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>I have been fighting with this for a whole day now and nothing positive. I have to install a bunch of modules on perl 5.6.1 on AIX. Let's pick one of them:
<p>Compress-Zlib-1.33</p>
<p>compilation seems to work but then</p>
<pre>
Running Mkbootstrap for Compress::Zlib ()^M
        chmod 644 Zlib.bs^M
        rm -f blib/arch/auto/Compress/Zlib/Zlib.so^M
        LD_RUN_PATH="" xlc  -bexpall -G -L/opt/freeware/lib -L/usr/local/lib Zlib.o  adler32.o  compress.o  crc32.o  gzio.o  uncompr.o  deflate.o  trees.o  zutil.o  inflate.o  infblock.o  inftrees.o  infcodes.o  infutil.o  inffast.o   -o blib/arch/auto/Compress/Zlib/Zlib.so     ^M
ld: 0711-317 ERROR: Undefined symbol: PL_markstack_ptr^M
ld: 0711-317 ERROR: Undefined symbol: PL_stack_base^M
ld: 0711-317 ERROR: Undefined symbol: PL_stack_sp^M
ld: 0711-317 ERROR: Undefined symbol: .Perl_sv_2pv^M
ld: 0711-317 ERROR: Undefined symbol: .Perl_form^M
ld: 0711-317 ERROR: Undefined symbol: .perl_get_sv^M
ld: 0711-317 ERROR: Undefined symbol: .Perl_croak^M
ld: 0711-317 ERROR: Undefined symbol: .Perl_newXS^M
ld: 0711-317 ERROR: Undefined symbol: .Perl_sv_setiv^M
...
</pre>
<p>and more similar lines</p>
<pre>
Summary of my perl5 (revision 5.0 version 6 subversion 1) configuration:
  Platform:
    osname=aix, osvers=4.3.3.0, archname=ppc-aix
    uname='aix emperor 3 4 000289424c00 unknown '
    config_args='-desr -Doptimize=-O2  -Dcc=xlc -Dldflags=-s -Wl,-bmaxdata:0x80000000 -Dinstallprefix=/opt/freeware -Dprefix=/opt/freeware -Darchname=ppc-aix -A define:ld=xlc -A define:ccdlflags=-brtl -bdynamic -A define:lddlflags=-bexpall -G -L/opt/freeware/lib'
    hint=recommended, useposix=true, d_sigaction=define
    usethreads=undef use5005threads=undef useithreads=undef usemultiplicity=undef
    useperlio=undef d_sfio=undef uselargefiles=define usesocks=undef
    use64bitint=undef use64bitall=undef uselongdouble=undef
  Compiler:
    cc='xlc', ccflags ='-D_ALL_SOURCE -D_ANSI_C_SOURCE -D_POSIX_SOURCE -qmaxmem=16384 -I/usr/local/include -q32 -D_LARGE_FILES -qlonglong',
    optimize='-O2 ',
    cppflags='-D_ALL_SOURCE -D_ANSI_C_SOURCE -D_POSIX_SOURCE -qmaxmem=16384 -I/usr/local/include'
    ccversion='', gccversion='', gccosandvers=''
    intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=4321
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=8
    ivtype='long', ivsize=4, nvtype='double', nvsize=8, Off_t='off_t', lseeksize=8
    alignbytes=8, usemymalloc=n, prototype=define
  Linker and Libraries:
    ld='xlc', ldflags ='-s -Wl,-bmaxdata:0x80000000 -L/usr/local/lib -b32'
    libpth=/usr/local/lib /lib /usr/lib /usr/ccs/lib
    libs=-lbind -lnsl -lgdbm -ldbm -ldb -ldl -lld -lm -lC -lc -lcrypt -lbsd -lPW -liconv
    perllibs=-lbind -lnsl -ldl -lld -lm -lC -lc -lcrypt -lbsd -lPW -liconv
    libc=, so=a, useshrplib=false, libperl=libperl.a
  Dynamic Linking:
    dlsrc=dl_aix.xs, dlext=so, d_dlsymun=undef, ccdlflags='-brtl -bdynamic -bE:/opt/freeware/lib/perl5/5.6.1/ppc-aix/CORE/perl.exp'
    cccdlflags=' ', lddlflags='-bexpall -G -L/opt/freeware/lib -L/usr/local/lib'
                                                                                                                                             
                                                                                                                                             
Characteristics of this binary (from libperl):
  Compile-time options: USE_LARGE_FILES
  Built under aix
  Compiled at Apr 25 2003 12:24:22
  @INC:
    /opt/freeware/lib/perl5/5.6.1/ppc-aix
    /opt/freeware/lib/perl5/5.6.1
    /opt/freeware/lib/perl5/site_perl/5.6.1/ppc-aix
    /opt/freeware/lib/perl5/site_perl/5.6.1
    /opt/freeware/lib/perl5/site_perl
    .
</pre></p>


<hr/>



<h2>Compiler and linker?</h2>
<h3><a href="/user/jdavidb/">jdavidb</a> on 2004-12-15T16:55:49</h3>
<p>The configuration shows it was compiled by xlc, which I presume is AIX's proprietary C compiler.  Are you using xlc to compile the modules?  (Are you intending to use it, and are you verifying that Makefile.PL is indeed picking it up?  Might need to CC=xlc Makefile.PL or modify your PATH.)</p>

<p>Forgive me if this is stuff you already know.  It might be something you've never heard of or thought of before, or it might be trivial old hat stuff to you.<nobr> <wbr></nobr>:)</p>

<p>If you try to compile modules with a compiler other than that used to compile perl, your success is not guaranteed.  I think it works sometimes on some platforms, but I would never depend on it.  I always get gcc going and make sure to <a href="http://use.perl.org/user/jdavidb/journal/6477" title="perl.org">compile my own perl</a perl.org>.  Have never used AIX; I might use the system compiler on that, if available, but I'd have more trust for gcc and definitely no trust if I was trying to mix output from the two.</p>



<blockquote>

<h2>Re:Compiler and linker?</h2>
<h3><a href="/user/bluto/">bluto</a> on 2004-12-15T17:46:50</h3>
FWIW, I've never had luck on AIX with gcc, though that was generally years ago.  Xlc or vac(?) tends to work ok, but you'll want to make sure they are reasonably up to date.  That said, I 100% agree with the idea of building your own copy of perl.  IBM's builtin perl is usually ancient and for some reason it causes me no end of grief when building/installing modules.



<blockquote>

<h2>Re:Compiler and linker?</h2>
<h3><a href="/user/jdavidb/">jdavidb</a> on 2004-12-15T18:10:50</h3>
<p>My advice is never, ever, ever, ever try to add a module to your OS vendor's version of perl.  Compiler incompatiblities is the number one reason, along with inconsistent configuration options, possible behind-the-scenes changes your vendor made, and very importantly the chance that some user-level component of the operating system (say, sysadmin tools or init scripts) depends on an installed module that has changed in an incompatible way.</p>

<p>It is near-trivial to install an independent perl for someone who is able to get perl compiled at all.  I highly recommend it.  And I tie all my programs to the specific instance of perl on the #! line, using full path and version number, to allow myself to upgrade perl by installing a new independent instance without affecting older programs.</p>



<blockquote>

<h2>Re:Compiler and linker?</h2>
<h3><a href="/user/gabor/">gabor</a> on 2004-12-16T16:12:12</h3>
Unfortunately I cannot make the people change the installed perl, I am totally dependent on some system administrators who told me to call the supplier of this module. They did not specify if I should call the maintainer of the module or CPAN...
<p>
Anyway, this is perl supplied by IBM and installed in some way by the local sysadmins. As this is a productions system they don't let me install another perl that I'd compile.
</p>
<p>
Both the compiler and the linker seem to be called
XLC on this system
</p>



<blockquote>

<h2>Re:Compiler and linker?</h2>
<h3><a href="/user/n1vux/">n1vux</a> on 2004-12-16T16:14:12</h3>
Be aware that xlC and xlc are two different compilers (or rather, sets of options) on AIX.



<blockquote>

<h2>Re:Compiler and linker?</h2>
<h3><a href="/user/gabor/">gabor</a> on 2004-12-16T16:20:05</h3>
lovely


<p>thanks for the warning, next time I am there I should look into this more closely</p>





</blockquote>

</blockquote>

</blockquote>

</blockquote>

</blockquote>


<h2>My two cents</h2>
<h3><a href="/user/runrig/">runrig</a> on 2004-12-15T17:43:28</h3>
I've built perl 5.6.1 on AIX, using xlc, though perl -V will say 'cc' since 'cc' is just a link to 'xlc'(/usr/lpp/xlC/xlC). It's interesting that your linker also says 'xlc', because mine says 'ld' (/usr/ccs/bin/ld). I haven't had trouble building most modules, the only problem I remember is with anything that needs libiconv.



<h2>^M</h2>
<h3><a href="/user/bart/">bart</a> on 2004-12-16T13:43:33</h3>
What are all those CR characters, marked by "<tt>^M</tt>" at the end of each line, in your text? That smells as if it's been poorly transported from a Windows platform, to yours.





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

