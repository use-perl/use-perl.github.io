<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of jjore: Jifty/Catalyst are too dang big</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Jifty/Catalyst are too dang big</h1>
<h2><a href="/user/jjore/">jjore</a> on 2007-04-10T08:40:18</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>I found a "nifty" bug in CPAN.pm today. If you try to install something gi-normous like Catalyst or Jifty, the CPAN.pm shell craps out halfway through because  it deleted somepart of the stuff to be installed during the build for the umpteen billion dependencies.<br/><br/>I didn't track how many modules Catalyst adds to a clean 5.8.8 but Jifty added 174 distributions and eventually failed because of something to do with XML::Parser, WWW::Mechanize, and perhaps some simple thinkos.<br/><br/>Blarg. That's a whole heap of module.</p>


<hr/>



<h2>Perl needs better packaging</h2>
<h3><a href="/user/SuperCruncher/">SuperCruncher</a> on 2007-04-10T11:05:47</h3>
This is a perfect example of why Perl needs better packaging. Something like <a href="http://par.perl.org/wiki/Main_Page" title="perl.org">PAR</a perl.org> seems to be a good idea, but people don't seem to use it. Odd given that many people are <a href="http://use.perl.org/user/AndyArmstrong/journal/32809" title="perl.org">having</a perl.org>     <a href="http://use.perl.org/user/jk2addict/journal/31372" title="perl.org">problems</a perl.org>   <a href="http://use.perl.org/comments.pl?sid=35017&amp;cid=54014" title="perl.org">with</a perl.org> installing dependency-heavy Perl modules.<p>

The value of CPAN is greatly diminished if we don't have an easy packaging mechanism. Many PHP apps are much easier to install than equivalent Perl ones, solely due to dependencies.</p>



<blockquote>

<h2>Re:Perl needs better packaging</h2>
<h3><a href="/user/Alias/">Alias</a> on 2007-04-10T15:06:59</h3>
If I wanted to release giant spaghetti-code apps that required a large standard library and reimplemented a bunch of functionality over and over again, and had no unit tests and no code reuse between applications at all, I imagine we could do installers as simple as PHP apps too.<br><br>CPAN is complicated for a reason.<br><br>The answer is not to make packages stupider, it's to make the CPAN tools smarter.



<blockquote>

<h2>Re:Perl needs better packaging</h2>
<h3><a href="/user/SuperCruncher/">SuperCruncher</a> on 2007-04-10T19:53:36</h3>
I don't like PHP and I'm not at all advocating PHP-style code and coding practices (do they have any, apart from 'hack'?). I'm just pointing out that many PHP apps, however dirty, are much easier to install.<p>

I don't see how bundling prerequisite modules with an application (e.g. Plagger) or large module does any harm. More disk space will be used, but in most cases that won't be a problem. Some may prefer to install modules separately, and I'm not seeking to stop that - I just want an easier way of distributing Perl apps.</p><p>

Making CPAN tools smarter isn't really the solution IMHO. Bundling is faster (than downloading <i>n</i> packages off CPAN), and good for packaging "traditional", desktop Perl apps (yes, there are several). The idea of downloading off CPAN, at least in the current form where the latest version of the module is always retrieved, isn't very good from a configuration management and QA perspective.</p><p>

I don't see how I was even remotely proposing to "make packages stupider". I'm talking about bundling modules together in such a way that they can be easily installed.</p>





</blockquote>

</blockquote>


<h2>Size does matter</h2>
<h3><a href="/user/sigzero/">sigzero</a> on 2007-04-10T11:56:50</h3>
I wonder if all those dependencies are really needed. I was listening to a talk by brian d foy and he made a good point. Perl modules tend to be "all inclusive" of the spec and not "just what you need". That tends to make them rather largish. Now if you are doing something specific that probably works but once you step into framework land, I am not sure if that works as well.



<blockquote>

<h2>Module::Tiny</h2>
<h3><a href="/user/Alias/">Alias</a> on 2007-04-10T13:59:48</h3>
Situations in which only a limited subset of the most basic functionality are required is why the<nobr> <wbr></nobr>::Tiny series of modules was created.



<blockquote>

<h2>Re:Module::Tiny</h2>
<h3><a href="/user/sigzero/">sigzero</a> on 2007-04-10T14:30:39</h3>
Yup, that is what bdf said as well.





</blockquote>

</blockquote>


<h2>Not really a bug</h2>
<h3><a href="/user/Limbic Region/">Limbic Region</a> on 2007-04-10T12:26:38</h3>
Well, I guess it is a matter of perspective since it is doing exactly what it says it does.<br><br>"Currently the cache manager only keeps track of the build directory ($CPAN::Config-&gt;{build_dir}). It is a simple FIFO mechanism that deletes complete directories below build_dir as soon as the size of all directories there gets bigger than $CPAN::Config-&gt;{build_cache} (in MB)."<br><br>Perhaps a better way of handling would be for it to recognize that it is removing directories that it needs for the current installation, pause and ask if you want to increase the build_cache parameter.<br><br>Presumably you accepted the defaults when initializing CPAN.pm which leaves a lot to be desired.<br><br>o conf init<br><br>Cheers,<br>L~R



<blockquote>

<h2>Re:Not really a bug</h2>
<h3><a href="/user/Alias/">Alias</a> on 2007-04-10T14:01:14</h3>
Even if it does what it says it does, if what is says it does is broken, it's still wrong.



<h2>Re:Not really a bug</h2>
<h3><a href="/user/dagolden/">dagolden</a> on 2007-04-10T15:23:21</h3>
<p>I think that CPAN.pm should only check the cache size after it finishes running the queue, not in the middle.  CPAN doesn't guarantee anything about how far over the cache limit the build cache can go and is pretty vague about how often the cache is checked.  So I think this is a bug that can be fixed pretty easily.</p>

<p>It reminds me of the Uncertainty Principle in a way -- you get to exceed the cache limit until you actually go and measure how much cache you're using.  As long as that time window is set appropriately, all is well.</p>



<blockquote>

<h2>Pretty vague...</h2>
<h3><a href="/user/LaPerla/">LaPerla</a> on 2007-04-10T22:06:04</h3>
<p>There is the config variable scan_cache that determines how often the cache is teared down to its limit. You can set this variable only to two values: "atstart" or "never". This means that (modulo bugs, of course) it is impossible that the cache manager is run in the middle of a session. The usual bug that's happening instead is that somebody (usually Module::Install) calls CPAN.pm recursively. Then "atstart" can be at any point in time.</p>

<p>I hope that I soon get evidence about what really is going on on Joshua's installation.</p>



<blockquote>

<h2>Re:Pretty vague...</h2>
<h3><a href="/user/jjore/">jjore</a> on 2007-04-11T01:04:24</h3>
Jifty::DBI uses Module::Install which is apparently what kills the Jifty install. It turns out that upgrading CPAN fixes the problem. I suppose that modules with large dependency trees ought to have the non-errant versions of the installer in their pre-req lists.<br><br>Perhaps that should be dynamic - if CPAN is asking Jifty about installing it, Jifty can tell CPAN that CPAN needs to be at least 1.90 to be able to successfully install it.



<blockquote>

<h2>Re:Pretty vague...</h2>
<h3><a href="/user/dagolden/">dagolden</a> on 2007-04-11T01:39:01</h3>
<p>Or maybe Module::Install should just die.</p>



<blockquote>

<h2>Re:Pretty vague...</h2>
<h3><a href="/user/Aristotle/">Aristotle</a> on 2007-04-11T06:30:45</h3>
<p>That&#8217;s what I&#8217;d say. I understand why people consider it necessary, but I think the effort would have been better invested in fixing Module::Build&#8217;s bootstrap problem. (Last I heard, we&#8217;re getting there, though, so hopefully Module::Install can indeed just die, soon.)</p>



<blockquote>

<h2>Re:Pretty vague...</h2>
<h3><a href="/user/drhyde/">drhyde</a> on 2007-04-22T01:37:36</h3>
That still leaves us with the problem of all those people who have bundled Module::Install with their own modules.  Perhaps the solution is for CPAN.pm to include its own Module::Install which does nothing but die, and set PERL5LIB to make sure that its Module::Install killer always loads first.

<p>Bwahahahaha</p>





</blockquote>

</blockquote>

</blockquote>

</blockquote>

</blockquote>


<h2>Re:Not really a bug</h2>
<h3><a href="/user/jjore/">jjore</a> on 2007-04-10T17:57:15</h3>
Andreas hinted the new CPAN.pm 1.90 might not have this problem. I'm testing it now.





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

