<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of Mark Leighton Fisher: The IE Web Browser Control and Applying Styles</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>The IE Web Browser Control and Applying Styles</h1>
<h2><a href="/user/Mark Leighton Fisher/">Mark Leighton Fisher</a> on 2006-02-03T17:31:43</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>Applying styles &ndash; or rather trying to apply styles &ndash; to HTML destined to live inside the IE Web Browser Control can be problematic. If you generate the HTML dynamically into a string to be displayed by the control, then you lose the capability to apply global styles (styles using CLASS or element name definitions in the HEAD section).  This is because the Microsoft HTML Object Library (mshtml.dll) used by the IE Web Browser Control only supports assigning BODY element contents as a string.  Now, the HTML string *can* have a HEAD section -- it is just ignored by the control, which (IMHO) confuses the matter.</p>
<p>The HTML-only solution is to write the HTML to a temporary file, then display that file.  Writing the string to a file to be displayed also helps you use stylesheets, as they are also specified in the HEAD section.</p>
<p>Here is an example of setting global styles in code when you load the HTML as a string:</p>
<code>
        objCSS = wb.Document.createStyleSheet<br>
        objCSS.addRule "H1", "{ font-size: 120%; line-height: 10%; }"<br>
        objCSS.addRule "BR", "{ font-size: 80%; line-height: 20%; }"<br>
        objCSS.addRule "TR", "{ font-size: 80%; line-height: 10%; }"<br>
        objCSS.addRule "TH", "{ font-size: 80%; line-height: 10%; }"<br>
        objCSS.addRule "TD", "{ font-size: 80%; line-height: 10%; }"<br>
        objCSS.addRule "DIV", "{ font-size: 80%; line-height: 10%; }"<br>
</code></p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

