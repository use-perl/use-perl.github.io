<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of Mark Leighton Fisher: Debugging COM Interop: .NET DLL With VB6 .EXE</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Debugging COM Interop: .NET DLL With VB6 .EXE</h1>
<h2><a href="/user/Mark Leighton Fisher/">Mark Leighton Fisher</a> on 2006-02-10T17:20:19</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p><i>[Yes, I know it's not Perl &ndash; but I write my tools in Perl to help with my VB.NET and VB6 development...]</i></p>
<p>There are two ways to debug a .NET COM Interop DLL
used by a VB6 EXE:</p>
<ol>
<li>Normally,
you can use <b>Project -> Properties -> Debug -> Start Action
-> Start external program</b> to start VB6.EXE automatically
when you click <b>Start Debugging</b>.<br>&nbsp;</li>
<li>In Visual Studio 2005 at least, if you have a test project for
your DLL in your solution, AND you test that DLL 
rather than including the DLL sources in the test project
(that is, the only source in the test project is for the test code),
you will need to explicitly
stop at a breakpoint in the VB6 EXE, then attach to that VB6 process
with Visual Studio 2005 <b>Tools -> Attach to process</b>.
Once you attach to the VB6 EXE, then debugging between
the VB6 code and the .NET code is seamless &ndash;
transitioning between managed and unmanaged code will
automatically switch debuggers for you.
Apparently, the presence of a test project that tests
your DLL (as opposed to a test project that includes
the source files for your DLL) confuses
Visual Studio just enough that when you
click <b>Start Debugging</b>, Visual Studio automagically
starts the test project for you instead of
the external command you specified.</li>
</ol>
<p>An example Solution where you cannot debug using <b>Start external program</b>:</p>
<pre>Project: Joe.dll
    xyz.vb
    abcd.vb
Project: TestJoe
    UnitTest.vb
    [reference: Joe.dll]
</pre></p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

