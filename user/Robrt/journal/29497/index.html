<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of Robrt: Line Noise</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Line Noise</h1>
<h2><a href="/user/Robrt/">Robrt</a> on 2006-05-03T04:37:13</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>I wrote this regular expression yesterday: <tt>/\._.*/</tt>
<p>
My thought at that moment?  Yes, perl <b>is</b> line noise.
<p>
Anyone want to guess what it's for?</p>


<hr/>



<h2>Death to .*</h2>
<h3><a href="/user/Enoch/">Enoch</a> on 2006-05-03T05:05:19</h3>
<a href="http://perlmonks.org/index.pl?node_id=24640" title="perlmonks.org">Death to Dot Star!</a perlmonks.org>



<blockquote>

<h2>Re:Death to .*</h2>
<h3><a href="/user/Aristotle/">Aristotle</a> on 2006-05-03T05:30:44</h3>
<p>How, pray tell, is this particular regex going to backtrack needlessly? Or are you just cargo culting the &#8220;death to dot star&#8221; line?</p>

<p>(That said, the<nobr> <wbr></nobr><code>.*</code> in Robrt&#8217;s pattern is superfluous, as the pattern will match the exact same things with or without it.)</p>



<blockquote>

<h2>Re:Death to .*</h2>
<h3><a href="/user/Enoch/">Enoch</a> on 2006-05-03T17:31:18</h3>
Yes, I was invoking it in the "Cargo Cult" context.  The<nobr> <wbr></nobr><code>.*</code> at the end was superfluous.  He could have put them at both ends:<nobr> <wbr></nobr><code>/.*\._.*/</code>.<br/><br/>So, yes, I was cargo culting it.  I was trying to draw attention to the fact that<nobr> <wbr></nobr><code>.*</code> is almost never what you want to use.



<blockquote>

<h2>Re:Death to .*</h2>
<h3><a href="/user/Aristotle/">Aristotle</a> on 2006-05-04T00:18:07</h3>
<p>&#8220;Death to dot star&#8221; is about backtracking. At the end of the pattern, the<nobr> <wbr></nobr><code>.*</code> won&#8217;t backtrack. If you put another one at the front, though, it will. What is your point?</p>

<p>You would have made your case much better if you just said &#8220;the<nobr> <wbr></nobr><code>.*</code> there is a noop&#8221; instead of throwing in something entirely unrelated that happens to be about dot star.</p>

<blockquote> <div><p>I was trying to draw attention to the fact that<nobr> <wbr></nobr><code>.*</code> is almost never what you want to use.</p></div> </blockquote>

<p>But you&#8217;re wrong. It is exactly what you want to use in many cases. You have to understand it, rather than using it blindly, sure, but that&#8217;s different from &#8220;it&#8217;s almost never what you want to use&#8221;. How would would you write this?</p> <blockquote> <div><tt>$filename ~= m/<nobr> <wbr></nobr>.+ \. (.*)<nobr> <wbr></nobr>/x; # get extension</tt></div> </blockquote>



<blockquote>

<h2>Re:Death to .*</h2>
<h3><a href="/user/Aristotle/">Aristotle</a> on 2006-05-04T00:18:58</h3>
<p>Err, that is supposed to be a <code>=~</code> there of course.</p>





</blockquote>

</blockquote>

</blockquote>

</blockquote>


<h2>I think I know</h2>
<h3><a href="/user/Aristotle/">Aristotle</a> on 2006-05-03T05:26:07</h3>
<p>Let me guess: it has to do with removing those resource fork files that you get on OS X in some circumstances?</p>



<blockquote>

<h2>Re:I think I know</h2>
<h3><a href="/user/Robrt/">Robrt</a> on 2006-05-03T06:20:12</h3>
Very close.



<blockquote>

<h2>Re:I think I know</h2>
<h3><a href="/user/pudge/">pudge</a> on 2006-05-18T05:46:51</h3>
So, what is it?



<blockquote>

<h2>Re:I think I know</h2>
<h3><a href="/user/Robrt/">Robrt</a> on 2006-05-22T03:36:36</h3>
It had something to do with allowing Mac OS X clients  to use a particular WebDAV service.  (OS X insists on transfering all the dot-underscore-files even to non-local filesystems.)





</blockquote>

</blockquote>

</blockquote>


<h2>Re: Line Noise</h2>
<h3><a href="/user/Aristotle/">Aristotle</a> on 2006-05-03T05:34:25</h3>
<p>It&#8217;s not Perl that&#8217;s line noise, it&#8217;s the regex syntax. Last night I wrote this: <code>s{/(?!\.\.)[^/]+/+\.\.(?=/|\z)}{}g</code> </p>



<blockquote>

<h2>Re: Line Noise</h2>
<h3><a href="/user/Dom2/">Dom2</a> on 2006-05-03T07:24:40</h3>
I love the x modifier.<nobr> <wbr></nobr>:-)<blockquote> <div><tt>s{<br>&nbsp; &nbsp;<nobr> <wbr></nobr>/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Leading slash.<br>&nbsp; &nbsp; (?!\.\.)&nbsp; &nbsp; # No parent directories of root.<br>&nbsp; &nbsp; [^/]+&nbsp; &nbsp; &nbsp; &nbsp;# Pick out the directory name in root.<br>&nbsp; &nbsp;<nobr> <wbr></nobr>/+\.\.&nbsp; &nbsp; &nbsp; # Match any number of slashes, then parent directory.<br>&nbsp; &nbsp; (?=/|\z)&nbsp; &nbsp; # Assert that there is a following slash (or end of string).<br>}{}gx</tt></div> </blockquote>So it cleans up pathnames to remove<nobr> <wbr></nobr><code>/foo/../bar/../baz</code> to be just<nobr> <wbr></nobr><code>/baz</code> if I understand that right.



<blockquote>

<h2>Re: Line Noise</h2>
<h3><a href="/user/Aristotle/">Aristotle</a> on 2006-05-03T07:48:43</h3>
<p>Even<nobr> <wbr></nobr><code>/x</code> only really helps because of your profuse comments, though.</p>

<p>You guessed correctly: I needed to normalize HTTP URIs to compare them, and <a href="http://search.cpan.org/dist/URI/" title="cpan.org">URI</a cpan.org>&#8217;s <code>canonical</code> method doesn&#8217;t finish the job. To be precise, this runs in a <code>1 while s///</code> loop, which is necessary to handle paths like <code>foo/bar/baz/quux/../../../bar</code>.</p>



<blockquote>

<h2>Re: Line Noise</h2>
<h3><a href="/user/Dom2/">Dom2</a> on 2006-05-03T08:22:31</h3>
It's not <em>just</em> the comments.  I also find that breaking the regex into its component groups makes it easier to understand.  It's what I do mentally anyway, so it just means that it's done already for me.
<p>-Dom</p>





</blockquote>


<h2>Re: Line Noise</h2>
<h3><a href="/user/Aristotle/">Aristotle</a> on 2006-05-03T08:09:36</h3>
<p>Hmm, actually, that has a bug. The negative look-ahead must contain a trailing slash, otherwise the pattern will erroneously fail to match something like <code>foo/..fooledya/../bar</code>.</p>

<p>At first I thought I needed a more complex assertion than just include a trailing slash in there, so I started rewriting the regex extensively, and after I realised that it&#8217;s not that complex, I noticed that my comments actually have a noticably different focus from yours, so I decided to keep the result for comparison:</p> <blockquote> <div><tt>s{<br>&nbsp; &nbsp;<nobr> <wbr></nobr>/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Leading dir separator<br>&nbsp; &nbsp; (?! \.\./ )&nbsp; &nbsp;# Make sure this is not an updir<br>&nbsp; &nbsp; [^/]+<nobr> <wbr></nobr>/+&nbsp; &nbsp; &nbsp; # Dir name, then any number of separators<br>&nbsp; &nbsp; \.\. (?=/|\z) # Updir, and make sure it is one<br>}{}gx</tt></div> </blockquote>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

