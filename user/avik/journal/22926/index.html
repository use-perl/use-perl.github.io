<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of avik: Cold ConFusion and SQL Butcher</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Cold ConFusion and SQL Butcher</h1>
<h2><a href="/user/avik/">avik</a> on 2005-01-28T14:49:43</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>My company uses only ColdFusion and SQL Server, so I'm learning new things, for example:</p>

<ul>

<li>
In Access I used to write 
<code>
IIf(if_condition,true_result,false_result)</code>, 
but now in SQL Server I have to write
<code>
CASE source_value WHEN target_value THEN true_result ELSE false_result END
</code>
</li>

<br><li>
Never thought that <code>select str(3.1415927) as foo</code> would return <b>3</b>
</li>

<br><li>
How awful that <code>Format(Now(),'yyyy-mm-dd')</code> must now be written as <code>left(convert(varchar(12),getdate(),120),10)</code> to get me the same output.
</li>

<br><li>
<code> String & ' ' & Number  & ' ' & String </code> works fine in Access, but in SQL Server it must be written as <code>
string + ' ' + Cast(number as varchar) + ' ' + string </code> but why the pluses if we don't even add anything, we're concatenating, right?
</li>

<br><li>
Cold Fusion's <code>cfquery</code> causes all single quoted characters to be auto-escaped, by doubling them. Good in 90% of cases, but what if you are doing dynamic SQL think with interpolation of single-quoted values? Then that becomes a mess. You must now use <code><cfset sql=...></code>tag in order to to be used in <code><cfquery>PreserveSingleQuotes(sql)</cfquery></code> manner. This is not intuitive. I spent about an hour to find an answer.
</li>

<br><li>
Documentation sucks big time for SQL server. Documentation is little better for ColdFusion, but not clear enough in many cases.
</li>

<br><li>
I deeply miss relative simplicity and friendly uglinness of Perl + DBI + DBD::ODBC + CGI.pm
</li>
</ol>
</p>


<hr/>



<h2>SQL Server docs</h2>
<h3><a href="/user/runrig/">runrig</a> on 2005-01-28T17:15:00</h3>
I find most of what I need in the 'Help' for the MS Query Analyzer. I can't stand all the proprietary built-in functions of different databases though. If I had a choice, I'd use only generic (as generic as possible) SQL, and munge the results later in the code. But that isn't always possible, and some languages don't make it as easy to munge as perl does, so in our (non-perl) code we have a home-grown 'sql_parse()' function which tries to convert these things and handles most of it, but there's still alot of "if it's SQL Server do this, if it's Oracle do that,<nobr> <wbr></nobr>..." throughout the code.



<blockquote>

<h2>Re:SQL Server docs</h2>
<h3><a href="/user/avik/">avik</a> on 2005-01-28T19:11:54</h3>
Exactly! "Cool, yet proprietary" things are one programmer's bread and butter, but another programmer's headache and tears.





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

