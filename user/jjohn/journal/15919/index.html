<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of jjohn: [MarkovBlogger]    AOL	Fighting  Spam	  berjon.com  (re)design  .</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>[MarkovBlogger]    AOL	Fighting  Spam	  berjon.com  (re)design  .</h1>
<h2><a href="/user/jjohn/">jjohn</a> on 2003-11-21T08:33:42</h2>
</div> <!-- /span4 -->


<div class="span8">
<p> I  was  at  18th  &  H,  across  Pennsylvania	Ave.)  <p> &nbsp;	<p>  [*]  Perl6  RFC  #1138:  Replace  the 
<tt>shift</tt>	builtin  with  something  clever  this 
early  in  the	lecture  area  tomorrow,  as  part  of	it 
is  $50  for  the  last  frontier  back  in  the  Dock	and
 System  Events.  It's	super  sweet!  Note  how  it  works
 on  Mac  OS  9.2.2,  apparently  over	the  last  number 
on  it,  but  it  still  didn't  get  to  have	a  list  of
 links	to  it	again  after  a  couple  of  late  night 
talking,  particularly	with  Quinn  and  Danny  from  <a
href="http://www.ntk.net/">Need to Know</a>.  <a
href="http://www.raelity.org/">Rael</a>  appeared  at  most
 of  life.  <p>Since  my  access  to  the  tops  of  both 
those  modules	and  articles  that  I	sound  like  crap, 
too.  Progress!  <p>  Just  before  2pm,  Tom  Brokaw  is 
presenting  some  images  coming  off  the  ground.   
"Tell  me  how	the  people  that  I  can  probably 
provide  some  of  the	seventies,  prevasive  sex,  drugs 
and  violence,	to  present  a	future	iPod  revision	has
 group	browsing  for  men),  gives  me  the  they  have 
to  take  over	support  of  the  RIAA	for  some  drinks 
instead  of  civil  rights.  <p>  I  think  work  here	if 
I  haven't  done  an  amazing  experience.  <p><i>(Brought 
to  you  by  jjohn's  MarkovBlogger  (&trade;):  If  it 
hits  kernel  panic  about  50%  of  the  house  is  much 
better	model  for  teenage  girls,  you'll  know  it 
fairly	well  when  I've  not  touched	them  in  March 
and  not  even	supported  until  ID3v2.4.0,  which  most 
software  will	eventually  have  an  installer  license. 
I  did	<EM>not</EM>  have  net  zero  effect  on  even 
the  military  knows  that  it's  likely  that	it  put  a 
cap  on  it,  as  compared  to	natural  light.  </p>  <p> 
  I  considered  the  dollar's	recent	pludge	against 
the  acquisition  cost.  <i>This</i>  is  the  direct 
object	of  the  same  reason  I  don't.
<p><i>(Brought to you by jjohn's MarkovBlogger (&trade;): If it makes sense, it's not MarkovBlogger (&trade;).)</i>
</p>


<hr/>



<h2>Feedback loop</h2>
<h3><a href="/user/rafael/">rafael</a> on 2003-11-21T11:54:19</h3>
As I see, MarkovBlogger reads its own entries. Bug or feature ?



<blockquote>

<h2>Re:Feedback loop</h2>
<h3><a href="/user/jjohn/">jjohn</a> on 2003-11-21T12:59:19</h3>
<p>It should not be reading its own entries.  I do filter MB entries.  However, if other blogs quote MB, there's little I can do about that.  It is very, very difficult to debug a particular entry to see what when wrong.  I will have a look.</p>



<blockquote>

<h2>The problem and solution</h2>
<h3><a href="/user/jjohn/">jjohn</a> on 2003-11-21T13:19:45</h3>
<p>I think this snake is indeed eating its own tail.
</p><p>To debug this, I first grepped through all of the source material, which is organized into a subdirectories and files.
</p><p>A typical source file looks like this:
</p><blockquote><div>
&laquo;subject:  OSCON -<nobr> <wbr></nobr>/$3(.*)$/
 <p>I write this on Saturday.  My last entry was Wednesday. Thursday is a happy blur now.  I know I went to some good talks, but
I can't remember them now, even on pain of death.  What I do have a clear
recollection of is going to the <i>Mummy Cafe</i> with Quinn, <a href="http://www.oblomovka.com/" title="oblomovka.com">Danny</a oblomovka.com>,
David Blank-Edelman, Gnat and Jenine.  Like the queen's tomb in the
Khufu's (ne&eacute; Cheop's) Pyramid, this restaurant was small,
subterranean and devoid of treasure.  However, the food was vaguely
greek/mediterranean and so was easy to consume.  Although no alcohol was
imbibed there, for some reason conversation at the table was preempted as
we all watched the ice cube that was impaled by David and hung across his
glass slowly melt away to the point of failure.
</p><p>At the time, this seemed very, very important.  Maybe the food included
some kind of "pharaoh's surprise."&raquo;</p>
</div></blockquote>
<p>I looked through all of these entries with this command:</p><blockquote><div> <tt>find . -exec 'grep' '-l' '\[MarkovBlogger\]' '{}' ';'</tt> </div></blockquote> <p>Only my own MB entries were found.  This argued strongly that the markov.pl isn't filtering the entries correctly.  Here's the relevant section of code:</p><blockquote><div> <tt>for my $file (@ARGV) {<br> <br>&nbsp; while (&lt;&gt;) {<br>&nbsp; &nbsp; if (/^subject:/) {<br>&nbsp; &nbsp; &nbsp; s/^subject://;<br>&nbsp; &nbsp; &nbsp; next if<nobr> <wbr></nobr>/^\s*\[MarkovBlogger\]/;<br>&nbsp; &nbsp; &nbsp; fill_table(table&nbsp; &nbsp;=&gt; $subject,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;state&nbsp; &nbsp;=&gt; $s_in,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line&nbsp; &nbsp; =&gt; $_,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'keys'&nbsp; =&gt; \@last_subject_keys<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );<br>&nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; fill_table(table&nbsp; &nbsp;=&gt; $body,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;state&nbsp; &nbsp;=&gt; $s_in,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line&nbsp; &nbsp; =&gt; $_,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'keys'&nbsp; =&gt; \@last_body_keys,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );<br>&nbsp; &nbsp; }<br>&nbsp; }<br>}</tt> </div></blockquote> <p>As you can see, the code appears to be looking for subject lines that contain the distinct sentential phrase.  However, a closer reveals the ugly truth: only that subject line is skipped; the rest of the file is still processed!
</p><p>With the careful application of labels, the
fix appears to be the following:</p><blockquote><div> <tt>FILE:<br>for my $file (@ARGV) {<br> <br>&nbsp; while (&lt;&gt;) {<br>&nbsp; &nbsp; if (/^subject:/) {<br>&nbsp; &nbsp; &nbsp; s/^subject://;<br>&nbsp; &nbsp; &nbsp; next FILE if<nobr> <wbr></nobr>/^\s*\[MarkovBlogger\]/;<br>&nbsp; &nbsp; &nbsp; fill_table(table&nbsp; &nbsp;=&gt; $subject,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;state&nbsp; &nbsp;=&gt; $s_in,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line&nbsp; &nbsp; =&gt; $_,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'keys'&nbsp; =&gt; \@last_subject_keys<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );<br>&nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; fill_table(table&nbsp; &nbsp;=&gt; $body,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;state&nbsp; &nbsp;=&gt; $s_in,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line&nbsp; &nbsp; =&gt; $_,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'keys'&nbsp; =&gt; \@last_body_keys,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );<br>&nbsp; &nbsp; }<br>&nbsp; }<br>}</tt> </div></blockquote> <p>This sort of bug would never have happened in Java, because I would never have tried to write this in Java.<nobr> <wbr></nobr>:-)</p>



<blockquote>

<h2>A better (working) solution</h2>
<h3><a href="/user/jjohn/">jjohn</a> on 2003-11-21T13:31:20</h3>
<blockquote><div> <tt>FILE:<br>for my $file (@ARGV) {<br> <br>&nbsp; if (open my $in, $file) {<br>&nbsp; &nbsp; while (&lt;$in&gt;) {<br>&nbsp; &nbsp; &nbsp; if (/^subject:/) {<br>&nbsp; &nbsp; &nbsp; &nbsp; s/^subject://;<br> <br>&nbsp; &nbsp; &nbsp; &nbsp; if (/^\s*\[MarkovBlogger\]/) {<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; close $in;<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; next FILE;<br>&nbsp; &nbsp; &nbsp; &nbsp; }<br> <br>&nbsp; &nbsp; &nbsp; &nbsp; fill_table(table&nbsp; &nbsp;=&gt; $subject,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;state&nbsp; &nbsp;=&gt; $s_in,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line&nbsp; &nbsp; =&gt; $_,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'keys'&nbsp; =&gt; \@last_subject_keys<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );<br>&nbsp; &nbsp; &nbsp; } else {<br>&nbsp; &nbsp; &nbsp; &nbsp; fill_table(table&nbsp; &nbsp;=&gt; $body,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;state&nbsp; &nbsp;=&gt; $s_in,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;line&nbsp; &nbsp; =&gt; $_,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;'keys'&nbsp; =&gt; \@last_body_keys,<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; );<br>&nbsp; &nbsp; &nbsp; }<br>&nbsp; &nbsp; }<br>&nbsp; &nbsp; close $in;<br>&nbsp; } else {<br>&nbsp; &nbsp; warn "can't open $file. skipping";<br>&nbsp; }<br>}</tt> </div></blockquote>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

