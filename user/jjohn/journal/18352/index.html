<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of jjohn: Linksys BEFSX41 appears to hang connections</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Linksys BEFSX41 appears to hang connections</h1>
<h2><a href="/user/jjohn/">jjohn</a> on 2004-04-16T00:43:07</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>I've been very busy.  Some of what's kept me so are incidents like the following.  I release this information,
orginally part of an email to one of my clients, 
so that others may share my pain.</p>
<blockquote>
&laquo;<p>All,
<p>This message is about the Linksys router that has been setup
for demos.  You may want to stop reading now.
<p>It appears that Windows boxes cannot connect to the services 
hosted on the linux box behind the firewall.  After sending a 
few KB of data, the connection hangs.  
<p>I confirmed this behavior on my Win2K and WinXP boxes at home 
as well as on an offsite win2K3 box. Ssh, scp and http  
all hung after more than 2-3 KB of data was exchanged.
<p>Now for the kicker.
<p>This consistently repeatable behavior on Windows does NOT 
appear on clients running on MacOS X nor Linux. Several MTU 
settings were tried on Linksys (1500 - 700).  I don't even
want to think this is related to Windows translating "\x012" 
bytes into "\012\015" or the Linksys doing the same.  That 
would be insane.  Then again, NASA lost a Mars probe due to 
poor metric/imperial measure conversion.   
<p>A quick check of the Linksys site informs us that the 
current version of the BEFSX41 firmware is 1.45.3.  Through
some miracle, our router has version 1.45.6.  Did it escape
from the lab prematurely?
<p>Without a firmware update readily available, it's time to
rethink topology of the demo system.
<p>Here's what I propose:
<p>
<ol>
  <li> We stick the linux box on directly into the switch.
  <li> We stick another NIC in the linux box.
  <li> We stick a cable into the new NIC and into the Linksys router
     or another simple switch or hub that may be lying around. 
</ol>
<p>All incoming traffic will go to the linux box.  It can forward
whatever traffic it needs to the the windows box.  This setup 
should be straight forward and no less secure that what we have 
now. 
<p>Here's a diagram:
<pre>
{ internet } -> [ s ] -> ( linux ) -> [ l ] -> ( WinXP )
                  w                     i
                  i                     n
                  t                     k
                  c                     s
                  h                     y
                                        s
</pre>
&raquo;
</blockquote>
</p>


<hr/>



<h2>MTU Settings</h2>
<h3><a href="/user/jbisbee/">jbisbee</a> on 2004-04-16T03:18:17</h3>
Google on "linksys mtu" and you'll see that both client and router need to be set to the same setting or you'll get the dreded hanging problem.  It drove me crazy for a long time.
<p>
Here is link to some more info <a href="http://www.dslreports.com/forum/remark,1700907~root=equip,16~mode=flat" title="dslreports.com">MTU, PPPoE, Servers and LinkSys Routers</a dslreports.com></p>



<blockquote>

<h2>Re:MTU Settings</h2>
<h3><a href="/user/jjohn/">jjohn</a> on 2004-04-16T12:11:56</h3>
Thanks for the tip.  I ran across that article, but thought that since linux and macos X clients could download large files (and at least the linux box was reporting eth0 was set to MTU 1500), I assumed something else was broken in the router.  Indeed, it does seem to be a problem with the router.
<p>Thanks again for responding.</p>



<blockquote>

<h2>Re:MTU Settings</h2>
<h3><a href="/user/jjohn/">jjohn</a> on 2004-04-18T02:32:10</h3>
After more testing and debugging, it looks like the 3C2000 drive may be to be blame.  I'll let you know when I swap out the NICs for new ones.





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

