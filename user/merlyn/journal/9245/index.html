<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of merlyn: Trusting cookies and shopping carts</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Trusting cookies and shopping carts</h1>
<h2><a href="/user/merlyn/">merlyn</a> on 2002-12-03T15:14:43</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>About once a week, I'm seeing a <a href="http://www.securityfocus.com/">BUGTRAQ note</a> on some exploit of a shopping cart based on manipulation of cookies.
<p>
While most of these probably aren't Perl-related, I'm just amazed at how many so-called "web programmers" don't understand that <i>trusted state should not be stored in cookies</i>.  I ranted about this in <a href="http://www.stonehenge.com/merlyn/WebTechniques/col61.html">a column of mine</a> and even provided the two-dozen lines of code required to manage cookies properly and securely.
<p>
If Netscape had only embedded a unique serial number in each browser, and not invented cookies, people would have done The Right Thing.
{sigh}</p>


<hr/>



<h2>I don't think that serial numbers would help.</h2>
<h3><a href="/user/Ovid/">Ovid</a> on 2002-12-03T16:15:42</h3>
<p>And <tt>merlyn</tt> writes:  <em>If Netscape had only embedded a unique serial number in each browser, and not invented cookies, people would have done The Right Thing. {sigh}</em> </p>

<p>While that's an interesting idea, I see a couple of problems.  The big one is obvious:  everyone is going to scream about their privacy and they would be right.  Can you imagine the field day that spammers would have once they realized they could map the serial number to a set of preferences and a name?  Our government has made it clear that they don't give a damn about our privacy when it comes to commerce (and campaign contributions), so I doubt there would be help from that quarter.</p>

<p>The other problem would be the sharing of serial numbers.  Crackers would try to break the algorithm or at least write code that creates valid serial numbers (and given Netscape's history, that wouldn't be too hard) and then the cracker would create a tool that would send whatever serial number they wanted.  You would have crackers hit site after site with another person's serial number until they hit a site that automatically logged them in.  Programmers would still be creating the same stupid security holes; we'd just have different twists on them.</p>

<p>And while we're on the subject of security, one of my favorite pet peeves:  I can't stand programmers who design shopping carts using <a href="http://www.altavista.com/cgi-bin/query?q=type%3Dhidden+name%3Dprice&amp;kl=XX&amp;pg=q&amp;Translate=on" title="altavista.com">hidden fields to hold the price</a altavista.com>.  It can be done safely if one is careful to embed some sort of anti-tampering device (like a MD5 hash), but despite having heard of that, I've never seen it actually done.</p>



<blockquote>

<h2>Re:I don't think that serial numbers would help.</h2>
<h3><a href="/user/brentdax/">brentdax</a> on 2002-12-22T19:06:02</h3>
<blockquote><div>It can be done safely if one is careful to embed some sort of anti-tampering device (like a MD5 hash), but despite having heard of that, I've never seen it actually done.</div></blockquote>

So then a clever hacker will just MD5 the new price.     That worked well.<nobr> <wbr></nobr>:^)
<p>
The bottom line is that you have to have <i>some</i> of the data be held in a trusted store, so you might as well avoid the need for checking for tampering by just using a product ID of some sort.</p>



<blockquote>

<h2>Re:I don't think that serial numbers would help.</h2>
<h3><a href="/user/Ovid/">Ovid</a> on 2002-12-22T20:58:47</h3>
<p>The MD5 hash works by having a secret key of data kept on the server.  The hidden fields are used with the secret key to ensure that creating a new MD5 hash is non-trivial.  The hacker would likely be forced to brute force the key.  This would be more difficult than a typical crack because there could be many hidden fields and the attacker would have to try different combinations of them.  That, combined with a random enough secret key would make the MD5 hash relatively secure.  I guess I should have mentioned the secret key up front<nobr> <wbr></nobr>:)</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

