<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of jplindstrom: MoronSQL</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>MoronSQL</h1>
<h2><a href="/user/jplindstrom/">jplindstrom</a> on 2007-02-28T21:34:36</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>Ok, rant on.<br/><br/>Consider this setup:<br/><br/><pre>
create table first (id int);
insert into first values (1);<br/><br/>create table second (id int, first_id int);
insert into second values (10, 1);
</pre><br/><br/>I alias the tables for easy reference in the query.<br/><br/><pre>
select
    f.*,
    s.*
from
    first f,
    second s
where f.id = s.first_id
;<br/><br/>+------+------+----------+
| id   | id   | first_id |
+------+------+----------+
|    1 |   10 |        1 |
+------+------+----------+
</pre><br/><br/>But I want to refer to the table names in the result list, not the aliases (that part is autogenerated stuff), not rocket science you'd think:<br/><br/><pre>
select
    first.*,
    second.*
from
    first f,
    second s
where f.id = s.first_id
;
</pre><br/><br/>But, wait, what happens here?<br/><br/><pre>
ERROR 1051 (42S02): Unknown table 'first'
</pre><br/><br/>The aliasing removes the original table name?!<br/><br/>What th...<br/><br/>HOW %%&*&*"ÃÂ£! STUPID IS THAT!?!?!?!<br/><br/>This goes for MySQL 4.*, it may have changed in 5 (any takers?)<br/><br/>I don't know... The more I use MySQL, the more it seems like the biggest hack wrapped around a cheap shortcut on top of a bad design decision since... I don't even know when. Again and again, it refuses to behave like what you'd expect from an actual database.<br/><br/>
<b>Post-comment update:</b><br/><br/>The fact that I may be wrong doesn't change the fact I am annoyed :)<br/><br/>I can't really see why disambiguation shouldn't be completely orthogonal to aliasing. Really, what rationale would you use to combine and confuse those two concepts?<br/><br/>The fact that I encountered this while fiddling with MySQL just made it so much easier to start fuming.</p>


<hr/>



<h2>Not moronic at all</h2>
<h3><a href="/user/Aristotle/">Aristotle</a> on 2007-03-01T01:18:21</h3>
<p><blockquote> <div><tt>SELECT<br>&nbsp; &nbsp; second.*<br>FROM<br>&nbsp; &nbsp; second p,<br>&nbsp; &nbsp; second k<br>WHERE<br>&nbsp; &nbsp; p.id = k.first_id</tt></div> </blockquote>  <p>Which row in <code>second</code> is the <code>SELECT</code> clause referring to?</p>



<blockquote>

<h2>Re:Not moronic at all</h2>
<h3><a href="/user/jplindstrom/">jplindstrom</a> on 2007-03-01T11:00:53</h3>
Yeah, when you have ambiguities, you need to disambiguate. So? That's not the case in my example.<br><br>And that's not what it complains about. It complains that it doesn't know of the table at all, not that it doesn't know which table I refer to.<br>



<blockquote>

<h2>Re:Not moronic at all</h2>
<h3><a href="/user/Aristotle/">Aristotle</a> on 2007-03-01T12:55:44</h3>
<p>Hmm, I don&#8217;t have PostgreSQL handy here to check; but I know that SQLite at least behaves just like MySQL. I&#8217;d be surprised, actually, if any RDBMS let you do what you were after.</p>

<p>We can quibble about the wording of the error message; I&#8217;ll agree that it could be more plausible.</p>

<p>I also won&#8217;t disagree at all that MySQL is a cardhouse of hack upon hack.</p>

<p>But&#8230; I dunno, that behaviour there seems sensible to me.</p>



<blockquote>

<h2>Re:Not moronic at all</h2>
<h3><a href="/user/stu42j/">stu42j</a> on 2007-03-01T23:43:54</h3>
Here's what Postgres says:<br><br><code>ERROR:  invalid reference to FROM-clause entry for table "first"<br>HINT:  Perhaps you meant to reference the table alias "f".<br></code>





</blockquote>

</blockquote>

</blockquote>


<h2>May be standard</h2>
<h3><a href="/user/VSarkiss/">VSarkiss</a> on 2007-03-01T15:03:36</h3>
<p>I know that neither SQL Server nor Oracle will support that syntax.  Once you alias a table name in a query, you must use the alias within the scope of that query.</p>
<p>It may be part of the SQL standard. I'm not sure, and the document is a bear to grep thru.</p>
<p>I agree the error message could be clearer.</p>



<blockquote>

<h2>Re:May be standard</h2>
<h3><a href="/user/avik/">avik</a> on 2007-04-06T15:38:43</h3>
I stumbled upon it too just the other day.<br>But it makes sense, doesn't it?<br><br>Imagine this<br>select F.*,  B.*<br>from SERVER1.DB1.owner1.FOOFOOFOOFOOFOO_2005 F<br>join SERVER2.DB2.owner2.BARBARBARBARBAR_2005 B<br>on  F.first_field  = B.first_field<br>and F.second_field  = B.second_field<br>and F.third_field  = B.third_field<br>and F.fourth_field  = B.fourth_field<br>and F.you_get_the_idea = 1<br>where f.something = 'something'<br>
&nbsp; &nbsp; and b.another_thing != 'something'<br>order by 1,2,3<br><br>If address for table changes for some reason (and it happens) all you need to worry about is "FROM" clause. However if we had a choice whether to use an alias or a real name of table that could be a disaster to debug, IMHO.<br>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

