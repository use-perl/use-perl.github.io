<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of jplindstrom: Refactoring tests</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Refactoring tests</h1>
<h2><a href="/user/jplindstrom/">jplindstrom</a> on 2005-01-08T20:40:08</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>The general attitude towards testing code is usually that the quality isn't as important as that of the actual production code.<br/><br/>That's how I work most of the time as well. If it involves copy-paste, so be it. It's not that big a deal.<br/><br/>But just now I created a simple module that extends Win32::GUI to provide some introspection of a created window. I put it in a module to encapsulate the poking-in-the-internals that otherwise could be sensitive to implementation changes.<br/><br/>And two set of tests in the .t file was so similar that they became data driven.<br/><br/>How do you treat testing code? Do you keep it well factored? Do you write your own Test::Builder extensions?
</p>


<hr/>



<h2>Code is Code</h2>
<h3><a href="/user/chromatic/">chromatic</a> on 2005-01-08T20:49:49</h3>
<p>The reason I use testing libraries is that I don't want to retype the same code again and again, often badly and incompletely.  Test::MockObject grew out of a pattern I noticed myself using in a particular situation, for example.</p>

<p>Every time I've neglected to treat test code as I would regular code, I've regretted it.  It's all code and the normal strategies ought to apply.</p>



<h2>Re: Refactoring Tests</h2>
<h3><a href="/user/dws/">dws</a> on 2005-01-08T21:06:41</h3>
<p>
With tests, it feels like there's two kinds of duplication: repeated test setup or utility code that's more involved with the mechanics of testing, and repeated code that involves the things under test. I usually factor the former into something like <tt>Test::Utility</tt>. The latter is more problematic. Some of it <i>may</i> be fair game to be moved off into a <tt>MyStuff::TestUtilities</tt>. The criteria for me, though, is wether the refactoring will reduce the readability of the tests.
</p>
<p>
Tests are a form of documentation. As documentation, I'll allow more redundancy. I hate encountering code that's been refactored to the point of unreadability, only to discover that the tests, which I'd hope would shed light on what's going on, have also been brutally refactored to the point of unreadability.
</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

