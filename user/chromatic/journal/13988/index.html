<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of chromatic: Fast and Good, Pick Two</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Fast and Good, Pick Two</h1>
<h2><a href="/user/chromatic/">chromatic</a> on 2003-08-08T06:47:45</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>One of my long-term goals has been to speed up <a href="http://everydevel.com/">Everything</a>, the engine that runs <a href="http://perlmonks.org/">Perl Monks</a>, <a href="http://everything2.com/">Everything 2</a>, <a href="http://animefu.com/">Animefu</a>, and the <a href="http://donate.perl-foundation.org/">Perl Foundation donation site</a>.  While half of those sites are using the 0.8 branch, the engine has improved immensely in the 0.9x track leading to the current 1.0 prerelease series.  It's also become slower.</p>

<p>When I worked for EDC, back when <em>anyone</em> still worked at EDC, my biggest coding project was working up a scheme that cached compiled code from the database.  Two years later, it's held up fairly well, in the sense that it does the job and I can still hack the code.</p>

<p>While there are lots of ways to improve performance, from improving some of the SQL queries to improving the node cache, I've focused lately on preloading code.  To do that, I had to (with no small glee) bypass some of the nastiest code in the system, a custom class inheritance scheme.  That does get rid of some run-time flexibility, but one of my roommates gave me an idea to get it back.</p>

<p>It took a few hours of spare time to get the system in order before I could start with these improvements.  Now that it's mostly in place, writing the preloading code for another nodetype (think "class") only takes a few minutes.  There are invariably a few bugs to track down, as the calling conventions tend to suck (due to early design decisions).  I can clean those up soon.</p>

<p>Most of what's left is refactoring away a lot of duplicate code added through this exercise.  The design is emerging pretty clearly now, and I'll be able to move more quickly with less code.  It's nice to be able to remove several lines of code from a method, retaining the same behavior while saying it more succinctly.</p>

<p>Backwards compatibility is a concern, so I have to tread more lightly than usual.  Still, I think the experiment is paying off.  Hopefully we'll have a lighter-weight and faster Everything soon.</p>

<p>Ideally, <a href="http://www.onyxneon.com/">we'll</a> be able to use it on customer projects.  We'll see.</p></p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

