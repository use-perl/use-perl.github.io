<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of chromatic: Mocking Parts of Objects</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Mocking Parts of Objects</h1>
<h2><a href="/user/chromatic/">chromatic</a> on 2004-03-13T05:45:52</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>The more I use <a href="http://search.cpan.org/dist/Test-MockObject/">Test::MockObject</a>,  the more I discover that I only need to mock small pieces of well-designed objects.</p>

<p>This came to a head today when I made the <tt>template()</tt> method of Jellybean::Response a little smarter.  Instead of making repeated method calls to set individual pieces of template data, you can now pass a hash reference containing multiple pieces of data.  That's less code!  You can also request the whole template data in one chunk, too, but that's a separate issue.</p>

<p>My tests use a mock object to test that containers set template data correctly in the response object.  After I improved <tt>template()</tt>, I converted one container to the new format.  Suddenly, four tests failed.  Since I'd mocked a <tt>template()</tt> method, the test code no longer matched the capabilities of the object it mocked.</p>

<p>Clearly, there was room in the world for <tt>Test::MockObject::Extends</tt>.  So I wrote 52 lines of code (with liberal spacing and brace placement) and 44 lines of tests.  More importantly, it required adding one line to the Jellybean test, changing another line, and deleting the not-so-accurate mocked <tt>template()</tt> implementation.  Presto, all tests pass again.</p>

<p>I seem to promise to add documentation and post the code quite a bit lately, so replay the last few messages.</p>

<p>Oh yeah, dissatisfaction with the state of the world is great when it motivates me to improve things that need improving, but I originally set out today to add two small features to my article managing program.  Of course, that lead me to make the templating simpler there, which lead to me refactoring and adding one nifty new feature to the Jellybean templating system....  So that's why I rarely finish anything.  I'm too productive.</p></p>


<hr/>



<h2>this sounds nifty!</h2>
<h3><a href="/user/lachoy/">lachoy</a> on 2004-03-14T14:15:40</h3>
I'll be taking advantage of it right quick.<br/><br/>BTW, I gave a <a href="http://www.cwinters.com/programming/pghpm-2004-03/" title="cwinters.com">presentation</a cwinters.com> to the Pittsburgh Perl Mongers last week about mock objects. Just for your library... (and any improvements welcome!)



<blockquote>

<h2>Re:this sounds nifty!</h2>
<h3><a href="/user/chromatic/">chromatic</a> on 2004-03-15T06:11:20</h3>
<p>Nice presentation!</p>

<p>I'm toying with another approach to making T::MO::E work well, so it could be a couple of days.  I'll likely release new versions of Mail::Action, Mail::SimpleList, and Mail::TempAddress first, however.  That might be as early as tomorrow.</p>





</blockquote>


<h2>You'll enjoy this</h2>
<h3><a href="/user/Aristotle/">Aristotle</a> on 2004-07-03T14:28:45</h3>
I know I'm a bit late to this entry, but I think you want to learn about <a href="http://www.ai.mit.edu/lab/gsb/gsb-archive/gsb2000-02-11.html" title="mit.edu">"yak shaving"</a mit.edu>.





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

