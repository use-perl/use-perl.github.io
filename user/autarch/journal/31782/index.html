<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of autarch: A rule for commenting: comment what's &quot;wrong&quot;</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>A rule for commenting: comment what's &quot;wrong&quot;</h1>
<h2><a href="/user/autarch/">autarch</a> on 2006-12-01T23:00:22</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>I was doing some work at $DAYJOB today and came across what appeared to be a bug.<br/><br/>When we generated RSS or Atom feeds, we always used the content-type "application/xml" in our HTTP headers. While this isn't necessarily strictly wrong, it's not quite as right as it could be, since we could use "application/rss+xml" and "application/atom+xml" respectively.<br/><br/>I made just such a change and asked for feedback from the original developer of this feature. He mentioned that some browsers might handle the original content-type more gracefully. Some quick testing proved him right. IE6 will display the formatted XML (with tags) for "application/xml", but for the other two content-types it just prompts the user.<br/><br/>Given the goals of our app, the prompting behavior isn't as desirable, so I reverted my change, but left in a comment about why we used this particular content-type. Of course, if that comment had been there originally it would've saved me some time.<br/><br/>This lead me to think of a general rule, which is comment your "wrong" decisions. As programmers, we often have to sacrifice technical correctness for a variety of other factors, like user experience or performance. Commenting instances of such things in the code is really valuable to the next person who comes along. That way they know that the decision to do the "wrong" thing was intentional, and why that decision was made.<br/><br/>Otherwise it's all too easy to "fix" things and cause a problem.<br/><br/>Note that this is a case where tests wouldn't necessarily help, since it's just as easy to assume the tests are testing for "wrong" output. The key here is the <i>rationale</i> for the decision.<br/><br/>I guess this is a special case of the more general comment rule I follow, which is that your comments should explain <i>why</i>, not what.</p>


<hr/>



<h2>The question is:</h2>
<h3><a href="/user/Aristotle/">Aristotle</a> on 2006-12-03T07:16:34</h3>
<p>Which end user is interested in an XML source dump?</p>



<h2>And the answer is ...</h2>
<h3><a href="/user/autarch/">autarch</a> on 2006-12-03T12:23:08</h3>
No one. However, I think a user is going to be even more confused when they're prompted to pick an app to open a file. Either they have an appropriate tool installed and associated with the mime type, or they likely have no clue what they should do with the prompt.<br><br>With the display of the XML file, they can at least read the content, and later us someone (us) what that thing is.





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

