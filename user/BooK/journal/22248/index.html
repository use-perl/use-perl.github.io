<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of BooK: Modulinos++</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Modulinos++</h1>
<h2><a href="/user/BooK/">BooK</a> on 2004-12-10T09:38:40</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>I am subscribed to both <a href="http://www.theperlreview.com/">TPR</a> and
<a href="http://www.tpj.com/">TPJ</a> and I do not
regret it*. After all, I can read brian d foy's
articles in both publications... ;-)</p>
<p>And in November's TPJ, I could read his article about
Modulinos. This is such a great idea!</p>
<p>Now that I am compulsive about tests, I'm very
disappointed with how I can test scripts. These tests are a pain to write: it's difficult to 
cover all the tests, I have to create loads of data and configuration files to check for each case, I do not get test coverage, etc. 
<a href="http://search.cpan.org/dist/Test-Cmd/">Test::Cmd</a> is a great tool (except that I can't have two instances of a Test::Cmd at the same time) but, as bdfoy notes,
when testing scripts, you only test the whole
process. Does that input produce the expected output? How many files appeared and weren't
removed? And so on.</p>
<p>Most of the time, a script is
a set of individual actions combined according
to the command-line options. Sure, but I don't want
to write a whole module and install it in <tt>@INC</tt>, just to encapsulate those
individual actions.</p>
<p>Well, now I can. I just write the module inside
the script file, add the magic one-liner** given by brian, and write tests scripts!</p>
<p>The only drawback in my opinion is that, if you want to <tt>use</tt> the "module", you'll have to name your script foo<b>.pm</b>.
If it's only for scripts, I guess you can 
simply <tt>require "foo"</tt> in the test suite. And Devel::Cover works as expected!
</p>
<p>I think I'll use^Wrequire^Wuse this technique for my future production scripts.</p>


<p><small>(*) Except for the fact that TPJ is online <i>only</i>... Did you also notice that,
contrary to almost every magazine, a particular
month's issue is available at the <i>end</i> of the month?
I suppose they were late at some point, and never
catched up.</small></p>
<p><small>(**) You noticed I did not write the one-liner here. It's on purpose. Either 1) brian will write it somewhere for all to see, or 2) you'll subscribe to TPJ. Or both.</small></p> </p>


<hr/>



<h2>Re: Modulinos++</h2>
<h3><a href="/user/brian_d_foy/">brian_d_foy</a> on 2004-12-10T20:42:31</h3>
I first talked about the idea of modulinos on Perlmonks: <a href="http://www.perlmonks.org/index.pl?node_id=396759" title="perlmonks.org">How a script becomes a module</a perlmonks.org>.  It's a much longer version of what appears in TPJ, although the TPJ version is much more polished and developed.<br> <br>As for the drawback about naming the script, I thought I had talked about that in the article (although I haven't read what they published.  I can't read my own stuff once someone else publishes it).  The trick is to create the module and install it in the usual place, then create a symlink (or link) to it for the script.  That way it works both ways.  diagnostics.pm does this, for instance.





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

