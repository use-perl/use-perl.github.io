<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of barbie: Mail::Outlook 3 and other stories</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Mail::Outlook 3 and other stories</h1>
<h2><a href="/user/barbie/">barbie</a> on 2003-10-03T15:37:22</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>So I've managed to get a beta version of <A HREF="http://birmingham.pm.org/modules/Mail-Outlook-0.02.tar.gz">Mail::Outlook</A> module working and have intergrated it into <A HREF="http://search.cpan.org/dist/Test-Reporter/">Test::Reporter</A> with a <A HREF="http://birmingham.pm.org/modules/Mail-Outlook-Test-Reporter-patch-0.01.zip">patch</A> [1]. So I'm now sending automated testing reports. However, it has highlighted a few problems. 
<P>
Firstly I can't automate the batch process that I run behind the scenes. I originally tried to do a system() call, but I kept getting odd CPANPLUS errors that don't appear when you run 'cpansmoke -apisu $path' by hand on the command line. I suspect this is a M$ thing rather than anything else. Also as part of the security patches that M$ have implemented recently I have to agree to every mail that's sent. That does seem a bit of an overkill, and it makes me wonder why M$ haven't thought of the firewall trick of allowing trusted scripts/apps to automatically send mail. If they DO allow it, I haven't found it, so if anyone out there knows of a solution, I'd be happy to hear from you.
<P>
CPANPLUS seems to occasionally do one of two things on error. It goes round in circles trying to install the same distribution repeatedly or dies horribly if it can't find pre-requisites. Mostly though it does the right thing. I can imagine this is all scary stuff, so I am not sure whether this is a M$ problem (more than likely) or whether the DOS shell causes CPANPLUS to lose itself.
<P>
I've automated it all by checking the mailbox folder 'CPAN Testers' in my Outlook and picking all the mail with a subject of 'CPAN Upload:'. I then see whether it's a distribution I'm going to allow to be tested. I had to but a block on some types of distributions (notably DBD, POE, XML and Net) as I was getting some odd breakages within them. Once this script has bedded in and I've sussed out some of the general problems, I'll go back and revisit these other modules and see if I can get them retested.
<P>
I have been meaning to set this up at home too, but as yet I've been far too busy downloading all the Pearl Jam live shows from their latest tour and loads of old AC/DC and Johnny Cash concert videos. Someone has also uploaded videos of the JJ72 and Neil Finn sets from the V2001 festivals. I'm looking forward to watching them this weekend.
<P>
In other news, I've uploaded a couple of distributions to the Birmingham Perl Mongers <A HREF="http://birmingham.pm.org/modules/index.html">modules page</A>. These extra modules are far from finished, but they are at a convienent point to store them somewhere publically accessible. I'm looking at tarting up my WWW::Auction::eBay distribution over the coming weeks. This time around I'm going to learn how to use WWW::Mechanize to do the grunt work.
<P>
After that I'm going to start looking at adding Extended Headers to Mail::Outlook. It can be done in VB, so there should be a way of doing it in Perl. I found an <A HREF="http://www.outlookexchange.com/articles/home/files/addheader.oft">addheader.oft</A> file <A HREF="http://www.outlookexchange.com/articles/home/vivanidze.asp">someone had written</A> while googling for more info. Unfortunately I don't have a converter that can help me decrypt what it actually does to add the X-Header text entry box. I will be writing to the author, to see if he is willing to let me see how he does it, though I'm not sure yet whether to tell him I'm rewriting it in Perl ;)
<P>
[1] I'll probably include this in the next release, which will probably be to CPAN too.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

