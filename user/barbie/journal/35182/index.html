<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of barbie: Moving Stats</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Moving Stats</h1>
<h2><a href="/user/barbie/">barbie</a> on 2007-12-21T14:58:15</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>
I was watching 'top' last night while the cpanstats scripts were running. The main stats collection scripts take just under 30 minutes, but the checking script took nearly 7 hours! (I wasn't watching for 7 hours I might add ;)) It was useful watching 'top' as I noted that the checking script was using 80-90% of CPU and lots of swap, hence why it takes so long to run. The machine is my old server, now used as my mail server and backup server, which only has 192MB RAM and 500MB swap, so all things considered it wasn't doing too badly. Although I've refactored the scripts a little, there is still going to be a large amount of data resident in memory.
<p>
Seeing as the Birmingham.pm server isn't getting swamped, I've taken the decision to move the stats computation closer to the website. The server has 289MB RAM and 255MB swap, so although my old server has more available overall, I'm hoping the extra RAM may be enough to avoid hitting swap so often. I now have the weekend to watch what happens and make sure the DB doesn't get corrupted. My old server is now on standby, so if the move doesn't work I only need to restart cron :)
<p>There is still more refactoring to be done, but hopefully the current changes will get me closer to updating daily. The parsing scripts are a lot stricter now and anything that fails any part of the parsing now gets dropped and must be reviewed manually. So far only two items have required my help in the last month, which when compared to the 10000s being posted each month is a small price.
<p>
I'm hoping to get some more time to work on CPAN::YACSmoke over Christmas, as I want to refactor it and bring in more of the report metrics that CPAN::Reporter uses. However, the main aim is to refactor the code so that CPANPLUS <b>or</b> CPAN/CPAN::Reporter can be used under the hood. I also want to make it a simple process to plugin the future releases of CPAN::Testers modules that are planned. If it becomes a fairly painless process to change the transport mechanism, then we're more likely to get more weight behind moving, plus the testers themselves are likely to move over fairly quickly. Expect more news in the coming year.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

