<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of gnat: iTunes</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>iTunes</h1>
<h2><a href="/user/gnat/">gnat</a> on 2003-05-08T21:56:04</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>I spent a fun day yesterday with <a href="http://molelog.molehill.org/blox/Computers/">this gentleman</a>, pulling the iTunes sharing protocol to pieces.  Todd did all the hard work and I wrote some Perl code to implement it.<p>

It turns out that iTunes sharing is just HTTP, as pudge observed.  The problem is that you can't just make a single GET to download a file.  You need to get a session ID, figure out which database you're accessing, and learn the unique ID of the song you want to download.  And the responses from all these requests are DMAP files, a hideous binary pseudo-XML-with-types that's a turd to parse (I know because I've written three turds of parsers so far).  The only thing I don't have sussed is authentication, but I believe that's easy to add.<p>

I've got <a href="http://nathan.torkington.com/mac/itshell.mov">Quicktime</a> and <a href="http://nathan.torkington.com/mac/itshell.mp4">mpeg4</a> demoing the command-line shell for connecting, searching, and downloading files from someone else's iTunes.  I'm not releasing the source, though, until I talk with Tim O'Reilly and Apple and figure out whether I'll be getting my arse sued off ...<p>

<i>--Nat</i></p>


<hr/>



<h2>nicely done</h2>
<h3><a href="/user/garron/">garron</a> on 2003-05-09T04:31:49</h3>
<p>I will never question your priorities Nat. A hacker to the end.</p>

<p>Looking forward to a cookbook chapter on iTunes.<nobr> <wbr></nobr>;)</p>



<h2>Bravo!</h2>
<h3><a href="/user/wickline/">wickline</a> on 2003-05-09T11:26:46</h3>
You da man!<br> <br>Good luck with the legal schtuff<nobr> <wbr></nobr>:)<br> <br>-matt



<h2>Server</h2>
<h3><a href="/user/pudge/">pudge</a> on 2003-05-09T12:09:03</h3>
Don't forget the server code, so we can play via iTunes MP3s sitting on a server without iTunes on it.<nobr> <wbr></nobr>:-)<br> <br>I've wanted to work on this, I wish I had time to help out, but we are moving in about a month and I am doing my darndest to get Mac::Glue out.  It is almost ready, too!  Wooo!<br> <br>Have you seen <a href="http://www.etek.chalmers.se/user/lernvall/itdlgui2.tgz" title="chalmers.se">iTunesdl</a chalmers.se>?  It's a Cocoa app that shows you a library and lets you download MP3s.  No docs or source.<br> <br>Anyway, thanks for moving forward on this, we need it.  If you decide you can't release it, maybe you can launder the source to someone else who can.<nobr> <wbr></nobr>:-)



<blockquote>

<h2>Re:Server</h2>
<h3><a href="/user/gnat/">gnat</a> on 2003-05-09T16:35:06</h3>
Todd's got his eye on the server side of things.  My thought is that it should be possible to have an Apache::MP3 type module that pretends to be an iTunes server.  I already checked and you can pass a port argument when you connect (my.hostname.com:3690 makes iTunes connect to port 3690).<p>

iTunesdl is cute.  But with my code, you could mirror a remote iTunes database, write a gnutella-to-iTunes gateway (Rael suggested making gnutella look like an iTunes server), aggregate multiple iTunes servers through a proxy, etc.</p><p>

Also, Todd's now looking to find other dmap files on the system.  For instance, the iTunes database and the databases on your iPod all seem to be some variant of dmap format.  I'd love to be able to copy specific songs and albums back off my iPod without having to id3info every damn mp3 file.  And of course, making your iPod available as an iTunes server is a very real possibility<nobr> <wbr></nobr>...</p><p>

<i>--Nat</i></p>



<blockquote>

<h2>Re:Server</h2>
<h3><a href="/user/ryaker/">ryaker</a> on 2003-05-10T00:35:49</h3>
I just want to get the playlist data so that I can manipulate it and show my library through a web browser.  Present different views of my iTunes library.  SO I am looking forward to your release of the perl code because I want to do this in PHP.<br/><br/>Thanks for the efforts.



<h2>Re:Server</h2>
<h3><a href="/user/oberd/">oberd</a> on 2003-05-10T13:35:46</h3>
<p>I'm working on a standalone daap server (daapd). An Apache module is a nice idea, though, and I just happened to think about proxies this morning, too<nobr> <wbr></nobr>:)</p>

<p>I hope that I have something to release at the end of the weekend. Let me know how the legal issues turn out. Apropos O'Reilly: Rob Flickenger has done some work on the <a href="http://www.oreillynet.com/pub/wlg/3175" title="oreillynet.com">Rendezvous side</a oreillynet.com> of things.</p>

<p>I'm the guy with the <a href="http://www.deleet.de/projekte/daap" title="deleet.de">daap wiki</a deleet.de>.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

