<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of drhyde: Preventing modules from loading</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Preventing modules from loading</h1>
<h2><a href="/user/drhyde/">drhyde</a> on 2007-04-25T14:41:03</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p><code>$ perl -Ilib -MNo=Data::Dumper -e 'use Data::Dumper'<br>Data::Dumper isn't allowed to load.<br>Compilation failed in require.<br>BEGIN failed--compilation aborted.
</code>

<p>This is actually useful.  Imagine you've written some code which, if some optional module is present, will do different stuff.  You need to test both with and without the optional module before releasing your code.  The usual way to do that is to monkey around in your perl libs and temporarily rename the appropriate .pm file or something like that so that perl can't "see" it.  That sucks.

<p>With this cunning trick, simply <code>use&nbsp;No&nbsp;qw(Some::Random::Module)</code> in a test file and the effect will be as if it wasn't there.</p>


<hr/>



<h2>Test::Without::Module</h2>
<h3><a href="/user/rjbs/">rjbs</a> on 2007-04-25T15:21:14</h3>
<a href="http://search.cpan.org/dist/Test-Without-Module/" title="cpan.org">http://search.cpan.org/dist/Test-Without-Module/</a cpan.org>



<blockquote>

<h2>Re:Test::Without::Module</h2>
<h3><a href="/user/drhyde/">drhyde</a> on 2007-04-26T13:18:37</h3>
I did consider playing games with subroutines in @INC like that module does, but my version will also "infect" child processes, by creating dummy modules and fiddling with PERL5LIB.



<blockquote>

<h2>Re:Test::Without::Module</h2>
<h3><a href="/user/rjbs/">rjbs</a> on 2007-04-26T14:19:31</h3>
I have a branch of TWM, which I keep meaning to release (I have comaint, I believe) that lets you fiddle with INC in a less annoying way, by creating temp dirs with unloadable versions in it.  That's needed to support old perls anyway, before coderefs in INC.<br><br>Anyway, I look forward to seeing your solution, too.



<blockquote>

<h2>Re:Test::Without::Module</h2>
<h3><a href="/user/drhyde/">drhyde</a> on 2007-05-02T14:07:06</h3>
<a href="http://drhyde.cvs.sourceforge.net/drhyde/perlmodules/No/lib/No.pm?revision=1.2&amp;view=markup" title="sourceforge.net">It's here</a sourceforge.net>.  Mostly untested.



<blockquote>

<h2>Re:Test::Without::Module</h2>
<h3><a href="/user/drhyde/">drhyde</a> on 2007-10-01T09:29:42</h3>
And it's also now in <a href="http://search.cpan.org/user/ferreira/Devel-Hide-0.0006_01/" title="cpan.org">the latest dev release of Devel::Hide</a cpan.org>.





</blockquote>

</blockquote>

</blockquote>

</blockquote>


<h2>Also, for testing without XS</h2>
<h3><a href="/user/dagolden/">dagolden</a> on 2007-04-25T18:03:39</h3>
<a href="http://search.cpan.org/dist/Test-NoXS/" title="cpan.org">Test::NoXS</a cpan.org>  -- for testing with modules that fall-back to pure perl if XS isn't available.





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

