<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of pjf: On the first day of financial year, my server gave to me....</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>On the first day of financial year, my server gave to me....</h1>
<h2><a href="/user/pjf/">pjf</a> on 2004-07-01T09:47:35</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><P>
<B>Financial Year</B><BR>
2003-04 finished very quietly.  Did a bunch of paperwork, fielded a
few questions from clients.  Nobody called with $20,000 they needed
to lose urgently.  Quite dissapointing, really.
</P>
<p>
<B>Hardware</B><BR>
It appears that our main server rebooted this morning, at about 6am,
for no apparent reason.  It then proceeded to do so around noon,
and later on at about 3pm.  It reported seeing some strange activity
on the serial line during this period, and the serial line is hooked
up to the UPS, so we suspect it's having problems.  Always bad when
the piece of equipment that's supposed to keep your power running
smoothly is doing the opposite, but this wouldn't be the first time
I've seen a UPS ruin an otherwise good mains supply.
</p><p>
Had a number of telephone conversations with <a href="/user/jarich/">jarich</a>,
as she had access to the console, the hardare, and the suspected UPS.  A
couple of reboots later and the machine was running straight from the mains.
During one reboot the IDE controller decided to flake out entirely and
lose interrupts.  That's not good, but the machine correctly restarted itself
and everything come up fine.
</p><p>
I'd never thought I'd be grumpy about losing months and months of uptime,
but I am.
</p><p>
<B>Painting Programs Red</B><BR>
When I wasn't fretting about sick machines, I was working on a particularly
knotty problem for one of my clients.  One of the difficulties with it
was taxonomy -- each of the three pieces of data that the algorithm processed
didn't have good names, and <i>they</i> all used the word <tt>NULL</tt>
to mean different things.
</p><p>
After spending more time than I would have liked to mentally map the
problem, I finally got a working solution involving turning the bits
of data into bit-strings, and performing operations on them.  This is
about twice as fast as the previous system which used regular expressions.
The major slow-down at the moment appears to be that the bit-strings
are being stored in a hash, and the cost of the hash-lookup is significantly
more than the cost of the operation on the bit-string.  Luckily,
the whole thing can be converted very easily to have everything indexed
into arrays, which should give us another big speed-boost.
</p><p>
If I had more time, I would broach the idea of putting the whole knot
of code into XS.  This really is a problem which would fly in C.  We're
building up some bit-strings (each only a single byte long), and then
munging them together with a static table to produce some boolean
output.  We can pack everything into some very short arrays, and
as we're on a 32-bit architecture we should be able to munge four
maps at a time.  I believe we can even construct a three-dimensional karnaugh map of the main problem, optimise it, and end up with some very fast code indeed.  It'll scream along, I tell you.
</p><p>
Unfortunately my four-day contract finishes tomorrow.  That doesn't leave
enough time to comfortably test and review the code once it's finished screaming.
</p><p>
<B>P5P</B><BR>
P5P is having some very interesting discussions right now on truncated sorts -- when you wish to sort a list, but only want back the first M of N elements.  Some people seem to think that I'm really strange for staying up late chatting about the merits of different sorts and how they can be optimised when you only want a subset of the original.
</p><p>
It's a shame that I'm no longer teaching computer science at a University, this is the sort of problem that would make a perfect second-year assignment.
</p></p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

