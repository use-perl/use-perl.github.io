<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of jdavidb: obstacks</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>obstacks</h1>
<h2><a href="/user/jdavidb/">jdavidb</a> on 2004-10-20T23:55:11</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>I'm using C in school again.  Lots to relearn ... I was under the impression you can't truly return a struct or any complicated data structure that didn't boil down to a basic data type or pointer, but apparently I was wrong.</p>

<p>And suddenly I'm learning more about malloc() than ever before.  There are things I'd heard about but never investigated in detail, because I always knew I could look them up if I needed to.  Tonight I had to look up the <a href="http://www.gnu.org/software/libc/manual/html_node/Statistics-of-Malloc.html">mallinfo() </a>function (which I presume is a GNU extension) in order to report on how much memory malloc was using.</p>

<p>Anyway, I saw something in the <a href="http://www.gnu.org/software/libc/manual/">GNU libc manual</a> that mentioned sbrk, which if I understand correctly is the assembly instruction (or very low level C function) used in some way to implement malloc(), and I decided that while my long program was running its next trial, I could look through and learn how that works.  But I got distracted along the way when I saw <a href="http://www.gnu.org/software/libc/manual/html_node/Obstacks.html">obstacks</a>, which I'd never heard of before, and sounded interesting because they appear to represent an alternative to malloc().</p>

<p>I haven't actually read much about them, yet, but I'm curious: has anyone here ever used these before?  For that matter, has anyone here ever even heard of them before?  Are they a GNU extension to libc, or something standard?</p></p>


<hr/>



<h2>history</h2>
<h3><a href="/user/jmm/">jmm</a> on 2004-10-21T13:38:25</h3>
<i>I'm using C in school again. Lots to relearn<nobr> <wbr></nobr>... I was under the impression you can't truly return a struct or any complicated data structure that didn't boil down to a basic data type or pointer, but apparently I was wrong.</i> <p>

Passing and returning structs has been around since the ANSI C standardization in the 80's, I think.  The GNU compiler of the day was one of the first to provide that extension but it was fairly common.  I can recall one compiler, perhaps it was pcc, allowing only structs that were small enough to fit in a long to be passed around.  (So, a struct with one short and two chars could be passed as a unit.)</p><p>

<i>And suddenly I'm learning more about malloc() than ever before. There are things I'd heard about but never investigated in detail, because I always knew I could look them up if I needed to. Tonight I had to look up the mallinfo() function (which I presume is a GNU extension) in order to report on how much memory malloc was using.</i> </p><p>

I guess mallinfo is a GNU and/or Linux extension, I've never heard of it.</p><p>

<i>Anyway, I saw something in the GNU libc manual that mentioned sbrk, which if I understand correctly is the assembly instruction (or very low level C function) used in some way to implement malloc(), and I decided that while my long program was running its next trial, I could look through and learn how that works. But I got distracted along the way when I saw obstacks, which I'd never heard of before, and sounded interesting because they appear to represent an alternative to malloc().</i> </p><p>

sbrk is a Unix system call.  It extends the upper limit of the memory image so that your data segment has more space.  It gets called(under the hood) by malloc when there isn't enough memory already available in the data image to fulfill the requested allocation.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

