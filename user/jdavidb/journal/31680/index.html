<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of jdavidb: How to get the shell you want</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>How to get the shell you want</h1>
<h2><a href="/user/jdavidb/">jdavidb</a> on 2006-11-21T20:31:22</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>Despite my best efforts, most people around here still don't know that they prefer bash.  Which is odd, since this is where I learned to prefer bash.</p>

<p>I have my Cygwin .Xinitrc menus and ssh keys set up to give me instant right-click-and-select-a-host access to just about everything I need.  Except that for most of the servers I've added recently, that takes me somewhere where the shell is not bash, and where I'm not the account owner and/or don't have what I need to get bash set up as the default shell.</p>

<p>For awhile I've been considering putting something in the login files to examine the SSH_CLIENT variable and exec bash when the IP address looks like mine.  But that sounds a little fragile and therefore scary: what if somebody else using one of these accounts gets my bash config and doesn't want it?  What if it breaks completely, when someone else is accessing the account, and they can't even get a regular shell and have no idea what happened?</p>

<p>I'd previous tried ssh user@host bash, but that didn't seem to work.  For some reason, it seemed to take forever, even though executing other arbitrary commands through ssh worked just fine.</p>

<p>So today I tried it again, and then I typed something and hit enter while ssh was "taking forever."  And I discovered ssh wasn't taking forever -- it had logged in and started a bash for me, which was executing in batch mode or something, with no prompt.  I got the same result trying to run other shells, actually.</p>

<p>So I dug through the ssh manpage and found out that if I pass the -t option, ssh will allocate a tty for the connection, which causes bash to realize it is supposed to be running interactively, and everything works fine!  .XWinrc updated!</p>

<p>While writing this entry, I decided to check to see if there were an option I could pass to bash to just tell it to be an interactive shell.  I had previously tried bash --login, and that didn't work.  Turns out you can specify an interactive shell with the -i option, but that won't do you a lot of good if you aren't using a tty, because the input and output will be in raw mode instead of cooked.  You'll get a lot of junk echoed.</p>

<p>Now I just need to figure out why I can't sudo - user bash on some hosts.</p></p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

