<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of xsawyerx: Autocreation of Nagios Configurations</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Autocreation of Nagios Configurations</h1>
<h2><a href="/user/xsawyerx/">xsawyerx</a> on 2009-06-08T10:53:07</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>Nagios is a great monitoring tool. It has a long history and learned a whole lot since it was created. It's being developed at a good pace but doesn't get ahead of itself (e.g., version 3 was only released recently). It is a (very) stable monitoring solution that has tight integration with Perl (there's a build-in Perl interpreter) and with the Perl Community (there are Perl modules to help write Nagios plugins, which are available on CPAN.</p>
<p>Now, giving the previous introduction (which Nagios deserves at least three times as much), I had the problem of needing to monitor a massive amount of servers using Nagios. Sitting down and writing the configuration files is out of the question, so instead I just wrote a system that inspects our database and creates the configuration files for it.</p>
<p>It's working and it has a lot of options, including configuration files support, Moose-based, command line arguments utility, tests, etc.</p>
<p>However, one feature I had a difficult time adding was the need to allow a different type of dependency that Nagios (and other monitoring applications) are not used to, and probably haven't even though of.</p>
<p>Nagios uses NRPE to run tests on remote servers. It supports SSL and ACL. Now, there are some firewall problems on some of the servers, in which I'm unable to run tests through the NRPE service. I want to add a group called "has_nrpe" or "nrpe_working" or whatever, and then only test a server that is both that group and another one with a certain test. That is, Server1 will be tested for Test1 only if it's in the group "has_nrpe" AND "needs_to_be_tested_for_test1".</p>
<p>Unfortunately I'm unable to do that, so I will have the code allow certain configuration options to fetch the servers that are in both groups manually and provide them individually as hosts for the test.</p>

<p>If anyone could advise otherwise, I'd love to know better.</p></p>


<hr/>



<h2>check out opsview</h2>
<h3><a href="/user/oliver/">oliver</a> on 2009-06-09T18:29:20</h3>
...at www.opsview.org (a Nagios based system), they have a basic provisioning API and are planning to extend it or will accept patches no doubt.



<blockquote>

<h2>Re:check out opsview</h2>
<h3><a href="/user/xsawyerx/">xsawyerx</a> on 2009-06-10T08:08:34</h3>
<p>First of all, thanks for showing me this! I came across Opsview a long time ago but didn't give it too much thought. It seems very very nicely done.</p><p>Secondly, I don't know if you're the person to ask, but I noticed they have a good sense of inheritance and multi-inheritance, but that's something I would rather avoid. Do they have a concept of flat groups, as in roles?</p><p>I assume they do. The biggest question is if I could add tests that apply only to combined hostgroups.</p>



<blockquote>

<h2>Re:check out opsview</h2>
<h3><a href="/user/oliver/">oliver</a> on 2009-06-10T08:26:46</h3>
Sorry I'm not an expert by any means. Best thing is to try the opsview users mail list, or #opsview on freenode IRC (I think).





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

