<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of nicholas: rooted? no, routed.</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>rooted? no, routed.</h1>
<h2><a href="/user/nicholas/">nicholas</a> on 2005-01-15T01:35:51</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>We've just had an entertaining few hours on a wild goose chase...</p>
<p>I was the only one home, and noticed network slowdowns. We've had 3 second ping times over ADSL during file transfers, but this was up to 6 seconds, so I checked on the house IRC channel. "No, it's not me", said doop, and as neither of the others were around we assumed it wasn't them (manually at least). doop investigated on the gateway, and it seemed to be a lot of traffic over the wireless. So I ran <code>tcpdump</code>, and sure enough there was a lot of wireless traffic.</p>
<p>Erk. Why is my machine generating lots of wireless traffic. And why can't <code>netstat</code> see it? And how come the traffic survives a reboot? Which process is it, or has <code>ps</code> been compromised too? And so the chase began. And how had I been compromised? How do you compromise a Mac that lives a sheltered life behind NAT?</p>

<p>When I dropped the network, the traffic stopped. Good. So it seemed safe enough leaving it like that, but after a while I turned the machine off. However, the network was still slow at times, so it seemed that a second machine was compromised.</p>

<p>doop returned home, and we investigated the (headless) gateway machine. All seemed fine. Then we started various games to try to get the gateway to log traffic, and after fighting <code>ssh</code> X forwarding (or lack of it) got <code>tethereal</code> capturing and logging on the gateway machine, and <code>ethereal</code> running on his workstation to analyse the traffic.</p>

<p><code>ethereal</code> reckoned that it was seeing a lot of the eDonkey protocol. And every so often a mass of DNS traffic. But why had someone gone to the trouble of compromising my machine to install eDonkey, and then doing a good job of concealing themselves with hacked tools?</p>

<p>And then doop asked "is your web browser set up to report itself as 'Windows NT 5.1'?". And the penny dropped. I checked my IP address. And the IP address <code>tcpdump</code> was showing. 236 != 221. Just because I'm the only one in the house, doesn't mean that I'm the only person on the wireless network. It seems that next door's network is down (something I noticed about an hour ago), so at least one of  their machines is now happily talking over our network.</p>

<p>One moral of this story - when debugging, check your assumptions. Which is one of the <a href="http://www.debuggingrules.com/Get_the_book.html">9 rules of debugging</a></p></p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

