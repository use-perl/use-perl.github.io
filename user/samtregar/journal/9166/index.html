<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of samtregar: The Cold and The Code</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>The Cold and The Code</h1>
<h2><a href="/user/samtregar/">samtregar</a> on 2002-11-27T05:31:31</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>I woke up with my first cold of the season.  Hair down the back of my throat, no nostrils, pounding headache, swollen eye sockets, etc.  Dosed myself with Advil, Pseudoephedrine, Caffeine and Ginseng, to little effect.  Eventually, things got better.
<p>
While waiting to feel better, I got to work on <a href="http://www.cpan.org/authors/id/S/SA/SAMTREGAR/Config-ApacheFormat-1.1.tar.gz">Config::ApacheFormat 1.1</a>.  A coworker of mine had suggested a couple good ideas for new features.  Also, I realized while spell-checking an email that I spelled "inheritance" wrong, both in the docs and in the API.  So, I've deprecated my wrong spelling on the off-chance that someone dove on the code and started using it the day after it came out.  I'll remove support in the next version and hopefully forget the shame of it all by this time next year.
<p>
Once those important issues were out of the way, I got down to my favorite part, optimization.  First I removed the recursion from the get() method, which was satisfying.  Then I got a hold of the largest Apache conf I could find and ran it through the parser.  After some time with Devel::DProf I had the parser running in half the time.
<p>
The huge config had some constructs I didn't realize were possible, and I fixed my parser to handle them.
<p>
And to top it all off, I removed the need to load the entire file before parsing AND added support for tracking the filename and line number inside included files for use in error messages.  The two were related because I'd taken the easy way out by using a single <code>@lines</code> array and just doing an <code>unshift(@line, &lt;$include_fh&gt;)</code> when I came across an include directive.  Simple to code, but abusive of both time and memory.
<p>
A pretty good day, all things considered.
<p>
-sam
</p>


<hr/>



<h2>Profiling</h2>
<h3><a href="/user/Dom2/">Dom2</a> on 2002-11-27T10:04:59</h3>
I love profiling.  It's so cool.  When Devel::DProfd doesn't core dump, that is.<nobr> <wbr></nobr><tt>:-)</tt>

<p>-Dom</p>



<h2>Faster without the recursion?</h2>
<h3><a href="/user/grantm/">grantm</a> on 2002-11-27T12:11:10</h3>
<blockquote><div> <i>First I removed the recursion from the get() method</i> </div></blockquote>

<p>Did that actually make it faster.  I expended some effort doing exactly that to XML::Filter::Sort and it ended up slower - I never worked out why.</p>



<h2>Devel::Profiler</h2>
<h3><a href="/user/samtregar/">samtregar</a> on 2002-11-27T17:58:21</h3>
When Devel::DProf dumps core, give <a href="http://search.cpan.org/author/SAMTREGAR/Devel-Profiler-0.04/lib/Devel/Profiler.pm" title="cpan.org">Devel::Profiler</a cpan.org> a try!
<p>
-sam</p>



<h2>Devel::Profiler</h2>
<h3><a href="/user/samtregar/">samtregar</a> on 2002-11-27T17:59:41</h3>
When Devel::DProf dumps core, give <a href="http://search.cpan.org/author/SAMTREGAR/Devel-Profiler-0.04/lib/Devel/Profiler.pm" title="cpan.org">Devel::Profiler</a cpan.org> a try!
<p>
-sam</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

