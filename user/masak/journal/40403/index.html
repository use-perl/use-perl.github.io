<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of masak: It isn't quite TDD, but I like it</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>It isn't quite TDD, but I like it</h1>
<h2><a href="/user/masak/">masak</a> on 2010-06-17T13:04:32</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>In several tightly controlled projects over the past few years, I seem to either follow or approximate this sequence of steps:</p>

<ol>
  <li>Write a test suite <strong>skeleton</strong>.</li>
  <li>Flesh it out into a <strong>test suite</strong>. (Make the tests run with a minimal implementation skeleton.)</li>
  <li>Make the tests pass by fleshing out the <strong>implementation</strong>.</li>
</ol>

<p>I haven't seen such a way of working mentioned elsewhere, so I thought I'd make note of it here.</p>

<p>The idea with the first step is to separate most of the thinking from the automatic task of writing the tests. I find if I do this, I get better test coverage, because separation allows me to <strong>retain an eagle-eye view</strong> of the model, whereas if I were to switch back and forth between thinking about the whole and writing about the parts, I'd lose sight of the whole. To some degree. Also, having something to flesh out <strong>cancels out the impulse to cheat</strong> and skip writing tests.</p>

<p>Step two ignores the mandate of TDD to write only one failing test at a time. I still prefer to <strong>have the whole test suite done</strong> before starting the implementation, again because I get rid of some context-switching. Usually I treat the implementation process in much the same way as if I had written the tests on-demand. It occasionally happens that a test already passes as soon as I write the minimal scaffold needed to run the tests. As I currently understand TDD, this is also "frowned upon". I leave them in there, because they're still part of the specification, and might even catch regressions in the future.</p>

<p>I tried this out last weekend, and it was a really nice match with the problem domain &#8212; an I/O-free core of a package installer:</p>

<ol>
  <li>Write a test suite skeleton: <a href='http://github.com/masak/proto/commit/d1123666b0c1954105a6b511166d21f2a2fd8d7c'>Just a bunch of prose comments</a>.</li>
  <li>Flesh it out into a test suite: <a href='http://github.com/masak/proto/commit/61dc53918176998b25234ecc89af28d736ac46a6'>one</a> <a href='http://github.com/masak/proto/commit/3612ad05e818e524487657cbd3099b77ec2d988f'>commit</a> <a href='http://github.com/masak/proto/commit/1c8c201495a162a330b1ad0a19ae28bce657c920'>per</a> <a href='http://github.com/masak/proto/commit/c7b2b6723d22e8a9a702ce0b7301af7a029f923a'>skeleton</a> <a href='http://github.com/masak/proto/commit/649a7102c53347c4a54edc7d8f030efe62fcae32'>test</a> <a href='http://github.com/masak/proto/commit/11d92fa95fc1c4bcd8cf91d6834258b072655ef9'>file</a>.</li>
  <li>Make the tests pass: <a href='http://github.com/masak/proto/commit/44c586b6807480d27e90cd5b138fd8f1aeb60339'>one</a> <a href='http://github.com/masak/proto/commit/d952250d9a34d966426cb870a53812629b111885'>commit</a> <a href='http://github.com/masak/proto/commit/07dcc69a90f61c5e2cac005e74721c07a86d81c1'>per</a> <a href='http://github.com/masak/proto/commit/0358c5ba39a822f93da16904773f8ef96be20b92'>subpart</a>.</li>
</ol>

<p>And presto, a complete (core) implementation with great test coverage.</p>

<p>Those who follow the links to actual commits will note that mistakes are corrected during the implementation phase. That's a symptom of the haltingproblem-esque feature of code in general; you don't know its true quality until you've run it in all possible ways.</p></p>


<hr/>



<h2>Inspiring....</h2>
<h3><a href="/user/larard/">larard</a> on 2010-06-17T15:44:45</h3>
<p>I always find you stories of TDD inspiring, almost to the point that I begin to write tests<nobr> <wbr></nobr>;)</p><p>But what I'm waiting for is tote! Or tote for perl 5 perhaps;)  <a href="http://use.perl.org/user/masak/journal/39639" title="perl.org">http://use.perl.org/user/masak/journal/39639</a perl.org></p>



<blockquote>

<h2>Re:Inspiring....</h2>
<h3><a href="/user/masak/">masak</a> on 2010-06-17T15:54:04</h3>
<p>Oh, nice, someone who is actually waiting for tote.<nobr> <wbr></nobr>:)</p><p>Now that I know that's the case, I will re-prioritize it to arrive sooner. The short story of my discoveries after the original post is that one shouldn't over-design tote; it mostly needs to be a loop that runs the tests on any changes, and has sensible rules for what constitutes "regression" and "progress". Having it do more (for example the double loop suggested in the original post) tends to be more of an obstacle than an actual help.</p><p>Using tote works very well with the workflow outlined in this post.</p><p>I use a "fake" variant of tote quite a lot locally. I should get my act together and publish it as a real project. Thanks for reminding me.<nobr> <wbr></nobr>:)</p>



<blockquote>

<h2>Re:Inspiring....</h2>
<h3><a href="/user/Aristotle/">Aristotle</a> on 2010-06-18T00:00:59</h3>
<p>Count me among those who&#8217;d like to see tote exist as a project.</p><p>(Btw: elsewhere, someone I mentioned tote to suggested adding to it something like <a href="http://exogen.github.com/nose-achievements/" title="github.com">unit testing achievements</a github.com>, for unparalleled addictiveness.)</p>



<blockquote>

<h2>Unit testing achievements</h2>
<h3><a href="/user/masak/">masak</a> on 2010-06-18T00:16:41</h3>
<p>Ooh! Yes, that's certainly worth remembering. Many of these can probably be added quite easily.</p><p>(I let out an involuntary snort when reading the first one: "A suite of at least 50 tests takes less than a second to run." I wish. On my laptop, a 2.4 GHz Intel Core 2 Duo, it never takes less that 1.1 seconds to run a program consisting purely of an <em>empty</em> <code>for</code> statement doing 50 iterations. There are still improvements to be made on the speed front.)</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

