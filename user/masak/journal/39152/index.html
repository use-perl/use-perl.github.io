<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of masak: 3D, baby!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>3D, baby!</h1>
<h2><a href="/user/masak/">masak</a> on 2009-06-19T21:20:13</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>Last night I had one of those rapid prototyping sprints where everything goes just right. I wanted to scout the terrain for drawing a 3D Druid board using SVG.</p>

<p>The result is <a href='http://masak.org/carl/druid/board.png'>this</a>. Yup, Perl 6 did that, with a little help from me.</p>

<p>It was very pleasing to see this image grow step by step. I literally started with a grey rectangle. Then I programmatically massaged the coordinates, adding projections, translations, scalings and rotations until I had what I wanted. <a href='http://github.com/masak/druid/blob/d309b630710f9dc8d1bca00b995519b188ba9bfd/bin/generate-board'>Here's the code.</a></p>

<p>I still feel two things are missing.</p>

<ul>
 <li><strong>Real perspective.</strong> Because I currently project the 3D coordinates flatly onto the canvas, the result is isometric perspective. For some reason I don't like that &#8212; to me, the furthermost corner looks like it's sloping upwards from the plane of the board. I think I'd be happy with <a href='http://en.wikipedia.org/wiki/3D_projection#Diagram'>this kind of perspective</a>, so I'll try that next. I was offline today, and had a couple of minutes to sit down and do the (really simple) math. I'm glad to see Wikipedia agrees with what I got. &#21704;&#21704; [<b>Update</b>: Fixed, see comment.]</li>

 <li><strong>Non-cheating with the piece order.</strong> I cheat right now in the sense that I placed the pieces in an order which looks good when drawn. The moves in a real game will not abide by such a restriction. I've already realized that I can draw all the horizontal surfaces in a separate pass, and don't need to sort those. I keep wondering whether I need to sort all the vertical surfaces separately, or whether it's enough to sort the pieces. Also, I'm thinking there might be nice, fast ways to determine that a surface will be completely covered by other surfaces, and can be thrown away. (Apart from the very simple case with the three surfaces on the back of each piece. I know about that one already.) [<b>Update</b>: Fixed, see comment.]</li>
</ul>

<p>Anyway, I've been wanting to do this for a long time, and I'm glad that when I finally sat down to do it, not only was the result quite satisfactory, but also the process of getting there. It's 2009, and I'm using Perl 6 to rapid-prototype 3D board games. Cool!</p></p>


<hr/>



<h2>Now, with real perspective.</h2>
<h3><a href="/user/masak/">masak</a> on 2009-06-20T12:34:07</h3>
<p>I added <a href="http://masak.org/carl/druid/board-with-perspective.png" title="masak.org">real perspective</a masak.org>, too. The small patch required for that is <a href="http://github.com/masak/druid/commit/f13c30872e2a0ff8563fdabb56d6c22eca208d4b" title="github.com">here</a github.com>.</p>



<h2>The pieces have been sorted.</h2>
<h3><a href="/user/masak/">masak</a> on 2009-06-20T13:54:48</h3>
<p>Sorting of pieces is now in, too. The algorithm randomly places a few pieces on the board and then <a href="http://masak.org/carl/druid/board-with-sorted-pieces.png" title="masak.org">draws them correctly</a masak.org>. The <a href="http://github.com/masak/druid/commit/e2a61927e79da8ced86113a35be8c8a6a55fc699" title="github.com">patch</a github.com> this time is perhaps not the height of legibility, but it gets the job done with surprisingly little code.</p><p>As for hiding surfaces, I'm not really sure at present if it's worth the trouble. But if it turns out to be, I now think I have a pretty good grasp on what can be done. There's a well-defined "directly behind" relation between pieces that can be used to weed out vertical surfaces. But this relation is a function of the viewing angle, becuase it's the rotation through the board's height axis that determines what's behind what.</p>



<h2>Awesome!</h2>
<h3><a href="/user/Ovid/">Ovid</a> on 2009-06-21T10:50:13</h3>
<p>The little kid in me is always appreciative of the shiny.  Nice seeing this<nobr> <wbr></nobr>:)</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

