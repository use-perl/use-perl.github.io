<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of ChrisDolan: [non-perl] mdfind vs. locate</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>[non-perl] mdfind vs. locate</h1>
<h2><a href="/user/ChrisDolan/">ChrisDolan</a> on 2009-07-26T19:08:54</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>I've used the "locate" command for many, many years on various POSIX systems.  It's a very fast search for filenames containing the specified string on your machine.<br/><br/>Here's a Mac command that simulates "locate" using the Spotlight database:
<pre>
#!/bin/sh
mdfind "kMDItemFSName == '*$1*'"
</pre><br/><br/>It's not as fast as locate, but it is always up to date (as opposed to locate, which relies on cron to reindex the disk periodically).  As anyone can guess from the syntax, it's also very flexible.  To find all files that originated as email attachments from my friend Glenn, for example, I can do:
<pre>
mdfind "kMDItemWhereFroms == '*medianinja.com*'"
</pre>
Or to find all files bigger than about a gigabyte:
<pre>
mdfind "kMDItemFSSize > 1000000000"
</pre>
(the WhereFroms search is fast and the size search is dramatically slower, maybe because all files have sizes but not many have kMDItemWhereFroms metadata)<br/><br/>To get a list of the supported keywords, type "mdimport -A"<br/><br/>Update: I found the <a href="http://developer.apple.com/documentation/Carbon/Conceptual/SpotlightQuery/Concepts/QueryFormat.html">Spotlight query syntax</a> to be useful
</p>


<hr/>



<h2>more on mdfind</h2>
<h3><a href="/user/petdance/">petdance</a> on 2009-07-26T22:01:29</h3>
Here's an article about mdfind I wrote three years ago: <a href="http://www.oreillynet.com/pub/a/mac/2006/01/04/mdfind.html" title="oreillynet.com">http://www.oreillynet.com/pub/a/mac/2006/01/04/mdfind.html</a oreillynet.com>.
<p>
There's actual Perl code at the end to find the longest songs in my iTunes collection:
</p><blockquote><div><p> <tt>$ perl longsongs 9<br>20:34 "2112" by Rush from "2112"<br>18:36 "Alice's Restaurant Massacree" by Arlo<br>&nbsp; &nbsp; Guthrie from "The Best Of Arlo Guthrie"<br>...<br>9:16 "Between I And Thou" by The Mermen from<br>&nbsp; &nbsp; "A Glorious Lethal Euphoria"<br>9:05 "Watermelon In Easter Hay" by Frank Zappa<br>&nbsp; &nbsp; from "Joe's Garage"<br>9:03 "Slow Burn" by Silkworm from "Even A Blind<br>&nbsp; &nbsp; Chicken Finds A Kernel Of Corn Now And Then"<br>9:00 "The Load-Out / Stay" by Jackson Browne from<br>&nbsp; &nbsp; "Running On Empty"</tt></p></div> </blockquote>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

