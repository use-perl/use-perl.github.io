<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of pudge: Stupid Mac::Glue Tricks: UI Scripting</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Stupid Mac::Glue Tricks: UI Scripting</h1>
<h2><a href="/user/pudge/">pudge</a> on 2004-05-17T04:42:14</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>You can use <a href="http://www.apple.com/applescript/uiscripting/">Apple's UI scripting</a> with Mac::Glue.<br/><br/>Experienced users might notice that you need to set the target app to be frontmost, and the method used here is to use Mac::Glue, which you can't do with non-scriptable apps.  This should be coming in a future version of Mac::Glue, but until then, you can use various other methods to set the frontmost app.  And of course, this is still quite useful for many scriptable apps, since many scriptable apps don't have full scripting support.<br/><br/><ECODE>#!/usr/bin/perl
use Mac::Glue;<br/><br/>my $app = new Mac::Glue 'System Events';
my $safari = new Mac::Glue 'Safari';
$safari->activate;<br/><br/>$app->obj(
	menu_item       => 'Close Tab',
	menu            => 'File',
	menu_bar_item   => 'File',
	menu_bar        => 1,
	process         => 'Safari'
)->click;</ECODE><br/><br/>Also, you really should have the UI Element Inspector for this.  I think it is included with Panther's dev tools, but I am not sure.  Regardless, this is the important portion of its output, to create the above script:<br/><br/><ECODE><AXApplication: "Safari">
 <AXMenuBar: "">
  <AXMenuBarItem: "File">
   <AXMenu: "File">
    <AXMenuItem: "Close Tab"></ECODE></p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

