<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of cosimo: Windows Vista compile of Win32::API with MinGW &amp;amp; MSVC++</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Windows Vista compile of Win32::API with MinGW &amp;amp; MSVC++</h1>
<h2><a href="/user/cosimo/">cosimo</a> on 2007-12-28T22:49:23</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>On my main PC used to develop CPAN work on Windows I had installed MSVC6, cygwin and strawberry/vanilla Perl.</p>

<p>At the start of November I had to switch to a new laptop with (arghh...) Vista. Then I installed MSVC++ 2005 and 2008, the free editions. And I installed also the Windows Server 2003 Platform SDK, which I thought was the SDK to go with.</p>

<p>Last week Vista ended up filling all its allocated disk space, and I decided to dump all MSVC & SDK installations plus other stuff to DVDs.</p>

<p>Then I reinstalled the compilers and the Microsoft Windows Vista SDK but since then I never got to compile anything again. The error messages are like the following:</p>

<pre><code>
gcc -c -I"\Program files\Microsoft SDKs\Windows\V6.0\Include" -I"\Program files\
Microsoft SDKs\Windows\V6.0\VC\include"         -s -O2 -DWIN32 -DHAVE_DES_FCRYPT
 -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -fno-strict-aliasing -DPERL_MSVCRT_
READFIX -s -O2    -DVERSION=\"0.47\"    -DXS_VERSION=\"0.47\"  "-IC:\strawberry\
perl\lib\CORE"   Callback.c<br>
In file included from /Program files/Microsoft SDKs/Windows/V6.0/Include/winnt.h
:105,<br>
                 from /Program files/Microsoft SDKs/Windows/V6.0/Include/windef.
h:177,<br>
                 from /Program files/Microsoft SDKs/Windows/V6.0/Include/windows
.h:155,<br>
                 from Callback.xs:17:
/Program files/Microsoft SDKs/Windows/V6.0/Include/basetsd.h:81: error: syntax e
rror before "INT64"<br>
/Program files/Microsoft SDKs/Windows/V6.0/Include/basetsd.h:81: warning: data d
efinition has no type or storage class<br>
/Program files/Microsoft SDKs/Windows/V6.0/Include/basetsd.h:85: error: syntax e
rror before "UINT64"<br>
/Program files/Microsoft SDKs/Windows/V6.0/Include/basetsd.h:85: warning: data d
efinition has no type or storage class<br>
/Program files/Microsoft SDKs/Windows/V6.0/Include/basetsd.h: In function `PtrTo
Ptr64':<br>
/Program files/Microsoft SDKs/Windows/V6.0/Include/basetsd.h:363: error: syntax
error before "__int64"<br>
...
</code></pre>

<p>
They seem to be related to this <code>basetsd.h</code> header file and the <code>INT64</code> typedefs.
</p>

<p>
Now I don't know if the Vista SDK is screwed up, and I'd better revert to the <b>Win 2003 Server SDK</b>, or I did something else which screwed up everything...
</p>

<p>
What the _______ is going on here? Anyone has experiences with Perl gcc/MSVC compiles on Vista?
</p>

<p>Anyway, I remember having correctly compiled <code>perl-5.10</code>, <code>parrot</code> and <code>Win32::API</code> with MSVC2005 and 2008 with W2003 Platform SDK. I will try to revert back to that and retry everything from scratch.
</p>

<p>
I promise I will write a step-by-step walk-through if everything works in the end.<br>
BTW, I'm also working on patching <code>ExtUtils::MakeMaker</code> to correctly detect the <code>PASTHRU_INC</code> Makefile variable (there's already a ticket on RT about that).
</p>
</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

