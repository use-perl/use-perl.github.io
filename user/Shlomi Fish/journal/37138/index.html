<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of Shlomi Fish: make test in maintperl-5.8.x Fails on Linux</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>make test in maintperl-5.8.x Fails on Linux</h1>
<h2><a href="/user/Shlomi Fish/">Shlomi Fish</a> on 2008-08-09T11:25:44</h2>
</div> <!-- /span4 -->


<div class="span8">
<p><p>
Due to the fact that my email to perl5-porters bounced for some reason, and
because the email I filed using perlbug was not registered 
<a href="http://rt.perl.org/rt3/">in the bugtracker</a> for some reason,
I'm posting it here:
</p>

<pre>
It seems that on Mandriva Linux Cooker (the Mandriva bleeding edge
distribution) on maint-perl IPC::SysV fails "make test":

{{{{{{{{{{{{
Failed 4 tests out of 1095, 99.63% okay.                                        
        ../ext/IPC/SysV/t/ipcsysv.t                                             
        ../ext/IPC/SysV/t/msg.t                                                 
        ../ext/IPC/SysV/t/sem.t                                                 
        ../ext/IPC/SysV/t/shm.t
### Since not all tests were successful, you may want to run some of
### them individually and examine any diagnostic messages they produce.
### See the INSTALL document's section on "make test".
### You have a good chance to get more information by running
###   ./perl harness
### in the 't' directory since most (>=80%) of the tests succeeded.
### You may have to set your dynamic library search path,
### LD_LIBRARY_PATH, to point to the build directory:
###   setenv LD_LIBRARY_PATH `pwd`:$LD_LIBRARY_PATH; cd t; ./perl harness
###   LD_LIBRARY_PATH=`pwd`:$LD_LIBRARY_PATH; export LD_LIBRARY_PATH; cd 
t; ./perl harness
###   export LD_LIBRARY_PATH=`pwd`:$LD_LIBRARY_PATH; cd t; ./perl harness
### for csh-style shells, like tcsh; or for traditional/modern
### Bourne-style shells, like bash, ksh, and zsh, respectively.
u=5.17  s=1.62  cu=359.73  cs=35.41  scripts=1095  tests=132095
make[2]: *** [_test_tty] Error 1
make[2]: Leaving directory 
`/home/shlomi/Download/unpack/perl/perl5/maint-perl/perl-5.8.x-1218190282'
make[1]: *** [_test] Error 2
make[1]: Leaving directory 
`/home/shlomi/Download/unpack/perl/perl5/maint-perl/perl-5.8.x-1218190282'
make: *** [test] Error 2
}}}}}}}}}}}}

I noticed it was the only upgrade since I updated perl-5.8.x-latest. I'll try 
to investigate further.

Regards,

        Shlomi Fish

[Please do not change anything below this line]
-----------------------------------------------------------------
---
Flags:
    category=library
    severity=medium
---
Site configuration information for perl v5.8.8:

Configured by shlomi at Fri Aug  8 13:14:33 IDT 2008.

Summary of my perl5 (revision 5 version 8 subversion 8 patch 34096) configuration:
  Platform:
    osname=linux, osvers=2.6.26-desktop-2mnb, archname=i686-linux
    uname='linux telaviv1.shlomifish.org 2.6.26-desktop-2mnb #1 smp wed jul 23 11:32:46 brt 2008 i686 intel(r) pentium(r) 4 cpu 2.40ghz gnulinux '
    config_args='-de -Dprefix=/home/shlomi/apps/perl/perl-5.8.x-latest -Doptimize=-g'
    hint=recommended, useposix=true, d_sigaction=define
    usethreads=undef use5005threads=undef useithreads=undef usemultiplicity=undef
    useperlio=define d_sfio=undef uselargefiles=define usesocks=undef
    use64bitint=undef use64bitall=undef uselongdouble=undef
    usemymalloc=n, bincompat5005=undef
  Compiler:
    cc='cc', ccflags ='-DDEBUGGING -fno-strict-aliasing -pipe -I/usr/local/include -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -I/usr/include/gdbm',
    optimize='-g',
    cppflags='-DDEBUGGING -fno-strict-aliasing -pipe -I/usr/local/include -I/usr/include/gdbm'
    ccversion='', gccversion='4.3.1 20080626 (prerelease)', gccosandvers=''
    intsize=4, longsize=4, ptrsize=4, doublesize=8, byteorder=1234
    d_longlong=define, longlongsize=8, d_longdbl=define, longdblsize=12
    ivtype='long', ivsize=4, nvtype='double', nvsize=8, Off_t='off_t', lseeksize=8
    alignbytes=4, prototype=define
  Linker and Libraries:
    ld='cc', ldflags =' -L/usr/local/lib'
    libpth=/usr/local/lib /lib /usr/lib /usr/lib64
    libs=-lnsl -lndbm -lgdbm -ldl -lm -lcrypt -lutil -lc
    perllibs=-lnsl -ldl -lm -lcrypt -lutil -lc
    libc=/lib/libc-2.8.so, so=so, useshrplib=false, libperl=libperl.a
    gnulibc_version='2.8'
  Dynamic Linking:
    dlsrc=dl_dlopen.xs, dlext=so, d_dlsymun=undef, ccdlflags='-Wl,-E'
    cccdlflags='-fPIC', lddlflags='-shared -g -L/usr/local/lib'

Locally applied patches:
    MAINT33934

---
@INC for perl v5.8.8:
    /home/shlomi/apps/perl/modules/lib/perl5/site_perl/5.10.0
    /home/shlomi/apps/perl/modules/lib/perl5/site_perl/5.8.8
    /home/shlomi/apps/perl/modules/lib/site_perl/5.10.0
    /home/shlomi/apps/perl/modules/lib/site_perl/5.8.8/i686-linux
    /home/shlomi/apps/perl/modules/lib/site_perl/5.8.8
    /home/shlomi/apps/perl/modules/lib/perl5/5.10.0
    /home/shlomi/apps/perl/modules/lib/perl5/5.8.8
    /home/shlomi/apps/perl/perl-5.8.x-latest/lib/5.8.8/i686-linux
    /home/shlomi/apps/perl/perl-5.8.x-latest/lib/5.8.8
    /home/shlomi/apps/perl/perl-5.8.x-latest/lib/site_perl/5.8.8/i686-linux
    /home/shlomi/apps/perl/perl-5.8.x-latest/lib/site_perl/5.8.8
    .

---
Environment for perl v5.8.8:
    HOME=/home/shlomi
    LANG=en_GB.UTF-8
    LANGUAGE=en_US
    LC_ADDRESS=en_US.UTF-8
    LC_COLLATE=en_US.UTF-8
    LC_CTYPE=en_US.UTF-8
    LC_IDENTIFICATION=en_GB.UTF-8
    LC_MEASUREMENT=en_GB.UTF-8
    LC_MESSAGES=en_US.UTF-8
    LC_MONETARY=en_US.UTF-8
    LC_NAME=en_GB.UTF-8
    LC_NUMERIC=en_GB.UTF-8
    LC_PAPER=en_US.UTF-8
    LC_SOURCED=1
    LC_TELEPHONE=en_US.UTF-8
    LC_TIME=en_GB.UTF-8
    LD_LIBRARY_PATH=/home/shlomi/Download/unpack/gui/X/nouveau/mesa/mesa/lib
    LOGDIR (unset)
    PATH=/usr/java/jdk1.5.0_09/bin:/home/shlomi/Download/unpack/graphics/fop/fop-0.93:/home/shlomi/apps/perl/modules/local/bin:/home/shlomi/apps/latemp/bin:/home/shlomi/apps/file/gringotts/bin:/home/shlomi/apps/gimageview/bin:/home/shlomi/apps/test/quadpres/bin:/home/shlomi/apps/docbook-builder/local/bin:/home/shlomi/bin:/usr/local/bin:/bin:/usr/bin:/usr/games:/usr/lib/qt4/bin:/usr/bin:/opt/kde3/bin:/usr/lib/ssh:/usr/lib/qt4/bin:/usr/bin:/opt/kde3/bin
    PERL5LIB=/home/shlomi/apps/perl/modules/lib/perl5/site_perl/5.10.0:/home/shlomi/apps/perl/modules/lib/perl5/site_perl/5.8.8:/home/shlomi/apps/perl/modules/lib/site_perl/5.10.0:/home/shlomi/apps/perl/modules/lib/site_perl/5.8.8:/home/shlomi/apps/perl/modules/lib/perl5/5.10.0:/home/shlomi/apps/perl/modules/lib/perl5/5.8.8
    PERL_BADLANG (unset)
    SHELL=/bin/bash        
</pre>

<p>
Can anyone reproduce it as well? Just do: 
<tt>rsync -auvz rsync://ftp.linux.activestate.com/perl-5.8.x/ perl-5.8.x-latest</tt>
and then build perl and run "make test"?
</p>

<p>
I could not reproduce this problem by running "perl Makefile.PL" ; "make" ;
"make test" in the latest IPC::SysV. For all the failed tests, the problem
seems to be:
</p>

<pre>
shlomi:~/Download/unpack/perl/perl5/maint-perl/perl-5.8.x-1218190282/t$ ./perl -MTestInit ../ext/IPC/SysV/t/msg.t
IPC::SysV object version 1.99_07 does not match bootstrap parameter 1.05 at ../lib/DynaLoader.pm line 250.
Compilation failed in require at ../ext/IPC/SysV/t/msg.t line 37.
BEGIN failed--compilation aborted at ../ext/IPC/SysV/t/msg.t line 37.
# Looks like your test died before it could output anything.
</pre>
</p>


<hr/>



<h2>Followup with resolution.</h2>
<h3><a href="/user/Shlomi Fish/">Shlomi Fish</a> on 2008-09-04T12:13:09</h3>
<p>
<a href="http://use.perl.org/user/Shlomi+Fish/journal/37346" title="perl.org">Here's the followup with the resolution</a perl.org>.
</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

