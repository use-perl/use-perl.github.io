<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of osfameron: How not to do a mail-merge</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>How not to do a mail-merge</h1>
<h2><a href="/user/osfameron/">osfameron</a> on 2002-06-17T10:39:15</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>I've recently had to pick up a mail-merge for
my colleague who has gone off sick.  I've learnt
an important rule: if you are ever asked to do
a mail-merge in 1 day on data that you don't
know, <b>don't do it</b>.  <p>
Doing a mail merge
on data that you know well, that you know is
complete, and correct is usually quite trivial.
That's what I assumed this time, foolishly.
<p>
Then I got back 800 "Message Undeliverable" errors.  And then I got another 20 emails asking "Why did
I get duplicate emails?  Which version should
I use?".
<p>
If this had been 'my' data, I would have checked
for duplicates, but up until now, I would have
had no tools to actually validate the email
address against.
<p>
But I finally got access to our LDAP server and have
been running queries (command line tool only,
but I will try to install <code>Net::LDAP</code>
when I get the chance) to get the *actual* email
address, rather than the ones on the list we
were provided with, which appear to have been 
based on guesswork...  This helped me work out
which 800 had failed... 
<p>
Then it's just a case
of going through the list manually trying to work
out what the correct email address is.  In fact,
in about 75% of the cases, the name is 
completely wrong.  The person has either left the
company or changed their name...
<p>
I must check out the CPAN module <code>Lingue::EN::MatchNames</code>, but I don't
have time to code it for now.  Hopefully next
week, because this kind of situation is just
going to crop up more and more often...
Since then, I've had daily complaints
from our internal customer that not all of their 
users have received their personalised mail... so
lots of manual munging to do.  Can't wait to get
the time to write a tool to automate this.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

