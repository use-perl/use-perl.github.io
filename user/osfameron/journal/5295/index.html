<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of osfameron: VBA ne Perl</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>VBA ne Perl</h1>
<h2><a href="/user/osfameron/">osfameron</a> on 2002-05-30T10:22:09</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>Continuing on my Off-Topic rant: I hate VBA.
<p>
On the other hand, I've managed to get a
reasonably complex parser written in it.
<br>
Taking a name - Osfameron.Adon@mycompany.com -
it will split it into First, Mid, and Last names.
Trivial?  But our email address books have
oddities like Dutch names having the prefix
added to the first name - Wijnand-van-der.Valk@mycompany.com...  And of course these
prefixes should be part of the Middle name
(to make alphabetising surnames less 'V' heavy...)
whereas French prefixes shouldn't ("Le Brun")
<p>
With the various rules that we need to follow
for this, it's a tricky but fundamentally doable task for Perl and Regular Expressions, but a horrible tarpit for VBA.
<p>
<b>On topic?:</b> Perl helped me write this
application:
<ul>
<li>
First I wrote helper functions to
recreate some of the functionality of Perl lists,
and to avoid having to manually parse everything
in every sub.  
<li>I've learned how to manipulate lists in Perl,
and you can play with lists the Perl way in VBA
too, which is invaluable.
<li>Perl coding practise encouraged
me to split things into subroutines.  This is
painful in VBA - my colleague who I thought of
as a VB guru actually advised me to use Cut
and Paste instead in some cases... and I will
admit that one Function is about 150 lines long
because I just couldn't bear to refactor it.  But
I tried...
</ul>
But no matter how you apply the Perlish way to
VBA, it is not Perl...  Some of the things I missed
from Perl were:
<ul>
<li> <pre>use strict;</pre> (I don't think
that <pre>Option Explicit</pre> is the
same)
<li> Exception handling a little more sophisticated than <pre>On Error Goto</pre>
<li> warnings, diagnostics, helpful error
messages.
<li> Not having to use the default IDE.  (Tasty
Vim goodness).
</ul>
Programmers are always encouraged to learn other
languages to get to grips with their features
and constructs.  I'm wondering whether I could recommend learning VB as a counter-example...?</p>


<hr/>



<h2>Prefix parsing</h2>
<h3><a href="/user/vsergu/">vsergu</a> on 2002-05-30T11:52:53</h3>
Isn't there some overlap between Dutch and French surname prefixes?  At least <i>de</i>, as in <i>de Klerk</i> and <i>de Gaulle</i>?



<blockquote>

<h2>Re:Prefix parsing</h2>
<h3><a href="/user/osfameron/">osfameron</a> on 2002-05-30T13:18:30</h3>
Yes, I thought of that only an hour ago...
I guess I need a flag for "Dutch style" or
"French style" parsing of 'de' prefixes, phew!



<blockquote>

<h2>French/Dutch Prefix parsing</h2>
<h3><a href="/user/osfameron/">osfameron</a> on 2002-05-30T15:12:44</h3>
Hmmm, in our email address-list most of the names are set up so that<blockquote><div> <tt>French:&nbsp; &nbsp;Charles.De-Gaulle<br>Dutch:&nbsp; &nbsp; Wijnand-de.Witte</tt> </div></blockquote>e.g. there are 2 differences:
<ol>
<li>
French 'De' is
<i>usually</i> Title Case, while Dutch 'de' is
usually lower case.</li>
<li>
More consistently, the Dutch name is coded
Firstname-de, and the French De-Lastname</li>
</ol>
I've made use of the 1st fact to make all "De"
part of the last name.  However I can't use
the 2nd fact without a rewrite because of the
(rather crufty) procedure I used to parse the
names...<p>
It'll do for now (the name coding isn't mission
critical though I'd like it to be
&gt;99% accurate),
and I'll have to spend some time looking at
my algorithm.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

