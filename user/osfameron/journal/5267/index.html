<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of osfameron: The joys of VBA</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>The joys of VBA</h1>
<h2><a href="/user/osfameron/">osfameron</a> on 2002-05-29T10:48:08</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>I suppose it is bad form to write an off-topic
post on my first use.perl journal entry.
Well, not quite off topic, as it's about me
struggling to use VBA in Excel to do things the
Perlish way.

<p>
First off, there are no Regular Expressions (you can import
them from WSH version 2, but that's not installed
on our corporate build, so no joy).  
<p>Also, I'm
having fun implementing basic functionality...
Here are some list munging functions.  Actually,
they don't use VB's braindead arrays, but the
"Collection" object, which is slightly less 
braindead, and more like a Perl list.
<pre>
Function split(split_string As String, orig_string As String) As Collection
  'OK not really like Perl split, 
  'e.g. only split on literals
  Dim coll As New Collection
  Dim pos
  pos = 1
  Dim my_string As String
  my_string = orig_string
  While my_string <> "" And pos <> 0
    pos = InStr(1, my_string, split_string)
    If pos > 0 Then
        coll.Add Left(my_string, pos - 1)
        my_string = mid(my_string, pos + Len(split_string))
    End If
  Wend
        coll.Add my_string
  Set split = coll
End Function
</pre>

And the positively minimalist 'join' function.
<pre>
Function join(jstring As String, coll As Collection) As String
    Dim token As Variant
        For Each token In coll
        If join <> "" Then join = join & jstring
        join = join & token
    Next
End Function
</pre>

To compare with Perl ("Make easy things easy, and hard things possible"), VBA
is very good for manipulating the Excel object
model and can clearly do many very difficult
things easily.  It just falls down in some simple
things, which appear to be impossible or at least
pointlessly difficult.</p>


<hr/>



<h2>Not bad form</h2>
<h3><a href="/user/jdavidb/">jdavidb</a> on 2002-05-29T14:36:45</h3>
<p>In fact, it's par for the course.  I can say that, because I did it, too.<nobr> <wbr></nobr>:)</p>

<p>Welcome.</p>



<h2>VBA library of Perlish functions (list utilities)</h2>
<h3><a href="/user/osfameron/">osfameron</a> on 2002-05-30T08:46:32</h3>
At this rate, I might make VBA almost usable,
though I doubt it as there are so many
deficiencies in this braindead language, so many
things that it's designed not to be able to do...<p>
I've created a VBA module with a number of Perllike list utilities - makeList, makeHash, split,
join, push, pop, shift etc..
I was going to post the module for your interest,
(if you're using VBA, or just want to laugh at
the tortuous syntax) but I got this use.perl
error:

</p><blockquote><div>
<b>Lameness filter encountered. </b> <br>

Your comment violated the "postercomment" compression filter. Try less whitespace and/or less repetition. Comment aborted.
</div></blockquote>
How appropriate.  If you want a copy of this,
give me a shout
(/msg me on perlmonks for example).



<h2>language mottoes...</h2>
<h3><a href="/user/jweveland/">jweveland</a> on 2002-05-30T14:53:02</h3>
Your closing got me to thinking... so far we have:
<ul>
<li>perl - Makes easy things easy and hard things possible</li>
<li>VBA - Makes hard things easy and easy things hard to impossible</li>
</ul>
And the following, avaliable for assignment:
<ul>
<li>Makes easy things hard, and hard things impossible</li>
<li>Makes easy things impossible, and hard things unthinkable</li>
<li>Makes easy things require 367<nobr> <wbr></nobr>.dll files, 6 reboots, and a bluescreen every 5 minutes thereafter</li>
<li>Makes "Hello, world" into a 40 line program</li>
<li>Makes strings into integers, four per byte (five on DEC-10s/20s)</li>
</ul>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

