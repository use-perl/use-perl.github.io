<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of bart: Building Win32::API with MinGW</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>Building Win32::API with MinGW</h1>
<h2><a href="/user/bart/">bart</a> on 2006-12-07T19:34:41</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>Earlier today we were chatting about <a href="http://search.cpan.org/perldoc?Win32::API">Win32::API</a> on Perlmonks, about building it with other compilers than the standard Microsoft Visual C, and one user claimed that he had succesfully built Win32::API using Cygwin. Later he sent me a msg saying he had made a mistake and it wasn't Win32::API at all, but anyway my curiousity had been woken. I saw that <a href="http://use.perl.org/user/cosimo">Cosimo</a>, who already had <a href="http://use.perl.org/user/cosimo/journal/31613">"threatened"</a> taken over mainainance for the module, had already been active, and it <a href="http://search.cpan.org/src/COSIMO/Win32-API-0.45/API.xs">looked</a> to me like it might just work &mdash; it used to be written so it could <em>only</em> compile on Microsoft's compiler, thanks to some nonporatble embedded assembler routines &mdash; and it has been like this for years. So I just had to try it.

I've tried to build it both with ActivePerl+MinGW, and with PXPerl, which is a (now abandoned) standalone perl port to Win32, which also uses MinGW. The good news: it builds on both. It's also supposed to build with Borland, judging by the <a href="http://search.cpan.org/src/COSIMO/Win32-API-0.45/API.xs">source code</a>. But still, <code>make test</code> barfs with a mysterious error message, that it can't find <tt>cl.exe</tt> &mdash; the command line compiler from MS Visual C. WTF...?

The solution to this little mystery is in the test  subproject <a href="http://search.cpan.org/src/COSIMO/Win32-API-0.45/API_test_dll/">API_test_dll</a>, that contains a prebuild Makefile that explicitely and <em>only</em> works with <tt>cl.exe</tt>. Dammit.

If any of you C bufs, who may be inclined to help Cosimo out, could port this so it builds with other compilers too, I'm sure it would be greatly appreciated. I'm going to try my hand at it, for MinGW, sometime later today or this week, if none of you people beat me to it.

<p><b>update:</b> I had just finished and posted this journal entry when I noticed that Cosimo <a href="http://use.perl.org/user/cosimo/journal/31829">had written one himself</a> about this subject, earlier today. Whoops.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

