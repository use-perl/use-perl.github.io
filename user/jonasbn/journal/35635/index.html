<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>use.perl.org journal of jonasbn: 3 Packages 1 Uniform $VERSION #Perlmonks++</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="/static/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the
bottom of the topbar */
      }
    </style>
    <link href="/static/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script
src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="/static/ico/favicon.ico">
  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse"
data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/"><img src="/static/img/slashhead.png"/></a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="/">Home</a></li>
              <li><a href="/about/">About</a></li>
              <li><a href="/authors/">Authors</a></li>
              <li><a href="/journals/">Journals</a></li>
              <li><a href="/stories/">Stories</a></li>
            </ul>
            <p class="navbar-text">All the Perl that's Practical to Extract and Report</p>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>



<div class="container">

<div class="row">

<div class="span4">
<h1>3 Packages 1 Uniform $VERSION #Perlmonks++</h1>
<h2><a href="/user/jonasbn/">jonasbn</a> on 2008-02-11T23:11:55</h2>
</div> <!-- /span4 -->


<div class="span8">
<p>I have had a problem for quite sometime with some code. We refer to the code as the poor mans configuration management system. (the code snippets below have been shortened to not reflect the name space of the client in question).<br/><br/>All in all it is a CPAN like distribution of files.<br/><br/><code> 
Configuration_DEV.pm 
Configuration_TEST.pm 
Configuration_PROD.pm 
</code><br/><br/>The 3 files contain several package definitions, one per application and so forth.<br/><br/>The configurations then vary according to their environments. DEV, TEST and PROD.<br/><br/>So I have subclassed Module::Build and implemented my own install action.<br/><br/>This action reacts to a mandatory commandline argument, so the user has to decide on what environment he/she wants to install.<br/><br/>So if the user specifies test, the installation creates a symlink called <code>Configuration.pm</code> in the install directory pointing to the designated environment specific file.<br/><br/>And everybody is happy.<br/><br/>Or?<br/><br/>My problem is that we constantly add a lot of configurable parameters in these files and new package definitions.<br/><br/>So in order to control this I normally specify what version my new or improved application requires as a minimum in my application's <code>Build.PL</code>.<br/><br/>But the <code>$VERSION</code> has to be defined in all 3 files and even the distributions <code>Build.PL</code> wants it. So I added a <code>VERSION.pm</code> file, which only contained the version.<br/><br/>This works ok, apart from the fact that Module::Build would not recognize and parse the line where I included it in the <code>$VERSION = $VERSION:VERSION;</code><br/><br/>I have adressed this problem of mine with many fellow Perl mongers, but without any resolution.<br/><br/>I have never been really active on Perlmonks, but yesterday I thought, hey why don't I ask there?<br/><br/>The next day I had two responses to <a href="http://www.perlmonks.org/?node_id=667080">my inquiry</a><br/><br/>None of these was quite what I was looking for at first, but one of them got me thinking.<br/><br/>So I added yet another action to my Module::Build subclass, so now the version of the distribution is controlled in the Build.PL and the <code>./Build dist</code> action puts the proper version into all of the environment files in the distribution.<br/><br/>The solution has some minor cosmetic problems, such as the code is changed prior to shipping and does therefor not reflect the code in CVS completely.<br/><br/>But my problem went away and to quote, or I cannot remember the exact quote, but Damian Conway once said that the Perl community was a... lucky/rich something community to have something like Perlmonks.<br/><br/>I can only agree.<br/><br/>Perhaps I should boil my whole poor mans configuration management system down to a writeup on Perlmonks, perhaps somebody else can use it.</p>





</div> <!-- /span8 -->

</div> <!-- row -->
</div> <!-- /container -->



    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

  </body>
</html>

